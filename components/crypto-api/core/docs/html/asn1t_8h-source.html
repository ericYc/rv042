<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>asn1t.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>asn1t.h</h1><a href="asn1t_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* asn1t.h */</span>
00002 <span class="comment">/* Written by Dr Stephen N Henson (shenson@bigfoot.com) for the OpenSSL</span>
00003 <span class="comment"> * project 2000.</span>
00004 <span class="comment"> */</span>
00005 <span class="comment">/* ====================================================================</span>
00006 <span class="comment"> * Copyright (c) 2000 The OpenSSL Project.  All rights reserved.</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
00009 <span class="comment"> * modification, are permitted provided that the following conditions</span>
00010 <span class="comment"> * are met:</span>
00011 <span class="comment"> *</span>
00012 <span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
00013 <span class="comment"> *    notice, this list of conditions and the following disclaimer. </span>
00014 <span class="comment"> *</span>
00015 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
00016 <span class="comment"> *    notice, this list of conditions and the following disclaimer in</span>
00017 <span class="comment"> *    the documentation and/or other materials provided with the</span>
00018 <span class="comment"> *    distribution.</span>
00019 <span class="comment"> *</span>
00020 <span class="comment"> * 3. All advertising materials mentioning features or use of this</span>
00021 <span class="comment"> *    software must display the following acknowledgment:</span>
00022 <span class="comment"> *    "This product includes software developed by the OpenSSL Project</span>
00023 <span class="comment"> *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"</span>
00024 <span class="comment"> *</span>
00025 <span class="comment"> * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to</span>
00026 <span class="comment"> *    endorse or promote products derived from this software without</span>
00027 <span class="comment"> *    prior written permission. For written permission, please contact</span>
00028 <span class="comment"> *    licensing@OpenSSL.org.</span>
00029 <span class="comment"> *</span>
00030 <span class="comment"> * 5. Products derived from this software may not be called "OpenSSL"</span>
00031 <span class="comment"> *    nor may "OpenSSL" appear in their names without prior written</span>
00032 <span class="comment"> *    permission of the OpenSSL Project.</span>
00033 <span class="comment"> *</span>
00034 <span class="comment"> * 6. Redistributions of any form whatsoever must retain the following</span>
00035 <span class="comment"> *    acknowledgment:</span>
00036 <span class="comment"> *    "This product includes software developed by the OpenSSL Project</span>
00037 <span class="comment"> *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"</span>
00038 <span class="comment"> *</span>
00039 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY</span>
00040 <span class="comment"> * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00041 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR</span>
00042 <span class="comment"> * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR</span>
00043 <span class="comment"> * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
00044 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</span>
00045 <span class="comment"> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
00046 <span class="comment"> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
00047 <span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span>
00048 <span class="comment"> * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
00049 <span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED</span>
00050 <span class="comment"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00051 <span class="comment"> * ====================================================================</span>
00052 <span class="comment"> *</span>
00053 <span class="comment"> * This product includes cryptographic software written by Eric Young</span>
00054 <span class="comment"> * (eay@cryptsoft.com).  This product includes software written by Tim</span>
00055 <span class="comment"> * Hudson (tjh@cryptsoft.com).</span>
00056 <span class="comment"> *</span>
00057 <span class="comment"> */</span>
00058 <span class="preprocessor">#ifndef HEADER_ASN1T_H</span>
00059 <span class="preprocessor"></span><span class="preprocessor">#define HEADER_ASN1T_H</span>
00060 <span class="preprocessor"></span>
00061 <span class="preprocessor">#include &lt;stddef.h&gt;</span>
00062 <span class="preprocessor">#include &lt;<a class="code" href="e__os2_8h.html">openssl/e_os2.h</a>&gt;</span>
00063 <span class="preprocessor">#include &lt;<a class="code" href="asn1_8h.html">openssl/asn1.h</a>&gt;</span>
00064 
00065 <span class="preprocessor">#ifdef OPENSSL_BUILD_SHLIBCRYPTO</span>
00066 <span class="preprocessor"></span><span class="preprocessor"># undef OPENSSL_EXTERN</span>
00067 <span class="preprocessor"></span><span class="preprocessor"># define OPENSSL_EXTERN OPENSSL_EXPORT</span>
00068 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00069 <span class="preprocessor"></span>
00070 <span class="comment">/* ASN1 template defines, structures and functions */</span>
00071 
00072 <span class="preprocessor">#ifdef  __cplusplus</span>
00073 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00074 <span class="preprocessor">#endif</span>
00075 <span class="preprocessor"></span>
00076 
00077 <span class="preprocessor">#ifndef OPENSSL_EXPORT_VAR_AS_FUNCTION</span>
00078 <span class="preprocessor"></span>
00079 <span class="comment">/* Macro to obtain ASN1_ADB pointer from a type (only used internally) */</span>
<a name="l00080"></a><a class="code" href="asn1t_8h.html#a0">00080</a> <span class="preprocessor">#define ASN1_ADB_ptr(iptr) ((const ASN1_ADB *)(iptr))</span>
00081 <span class="preprocessor"></span>
00082 
00083 <span class="comment">/* Macros for start and end of ASN1_ITEM definition */</span>
00084 
<a name="l00085"></a><a class="code" href="asn1t_8h.html#a1">00085</a> <span class="preprocessor">#define ASN1_ITEM_start(itname) \</span>
00086 <span class="preprocessor">    OPENSSL_GLOBAL const ASN1_ITEM itname##_it = {</span>
00087 <span class="preprocessor"></span>
<a name="l00088"></a><a class="code" href="asn1t_8h.html#a2">00088</a> <span class="preprocessor">#define ASN1_ITEM_end(itname) \</span>
00089 <span class="preprocessor">        };</span>
00090 <span class="preprocessor"></span>
00091 <span class="preprocessor">#else</span>
00092 <span class="preprocessor"></span>
00093 <span class="comment">/* Macro to obtain ASN1_ADB pointer from a type (only used internally) */</span>
00094 <span class="preprocessor">#define ASN1_ADB_ptr(iptr) ((const ASN1_ADB *)(iptr()))</span>
00095 <span class="preprocessor"></span>
00096 
00097 <span class="comment">/* Macros for start and end of ASN1_ITEM definition */</span>
00098 
00099 <span class="preprocessor">#define ASN1_ITEM_start(itname) \</span>
00100 <span class="preprocessor">    const ASN1_ITEM * itname##_it(void) \</span>
00101 <span class="preprocessor">    { \</span>
00102 <span class="preprocessor">        static const ASN1_ITEM local_it = { \</span>
00103 <span class="preprocessor"></span>
00104 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_ITEM_end(itname) \</span>
00105 <span class="preprocessor">        }; \</span>
00106 <span class="preprocessor">    return &amp;local_it; \</span>
00107 <span class="preprocessor">    }</span>
00108 <span class="preprocessor"></span>
00109 <span class="preprocessor">#endif</span>
00110 <span class="preprocessor"></span>
00111 
00112 <span class="comment">/* Macros to aid ASN1 template writing */</span>
00113 
<a name="l00114"></a><a class="code" href="asn1t_8h.html#a3">00114</a> <span class="preprocessor">#define ASN1_ITEM_TEMPLATE(tname) \</span>
00115 <span class="preprocessor">    static const ASN1_TEMPLATE tname##_item_tt </span>
00116 <span class="preprocessor"></span>
<a name="l00117"></a><a class="code" href="asn1t_8h.html#a4">00117</a> <span class="preprocessor">#define ASN1_ITEM_TEMPLATE_END(tname) \</span>
00118 <span class="preprocessor">    ;\</span>
00119 <span class="preprocessor">    ASN1_ITEM_start(tname) \</span>
00120 <span class="preprocessor">        ASN1_ITYPE_PRIMITIVE,\</span>
00121 <span class="preprocessor">        -1,\</span>
00122 <span class="preprocessor">        &amp;tname##_item_tt,\</span>
00123 <span class="preprocessor">        0,\</span>
00124 <span class="preprocessor">        NULL,\</span>
00125 <span class="preprocessor">        0,\</span>
00126 <span class="preprocessor">        #tname \</span>
00127 <span class="preprocessor">    ASN1_ITEM_end(tname)</span>
00128 <span class="preprocessor"></span>
00129 
00130 <span class="comment">/* This is a ASN1 type which just embeds a template */</span>
00131  
00132 <span class="comment">/* This pair helps declare a SEQUENCE. We can do:</span>
00133 <span class="comment"> *</span>
00134 <span class="comment"> *  ASN1_SEQUENCE(stname) = {</span>
00135 <span class="comment"> *      ... SEQUENCE components ...</span>
00136 <span class="comment"> *  } ASN1_SEQUENCE_END(stname)</span>
00137 <span class="comment"> *</span>
00138 <span class="comment"> *  This will produce an ASN1_ITEM called stname_it</span>
00139 <span class="comment"> *  for a structure called stname.</span>
00140 <span class="comment"> *</span>
00141 <span class="comment"> *  If you want the same structure but a different</span>
00142 <span class="comment"> *  name then use:</span>
00143 <span class="comment"> *</span>
00144 <span class="comment"> *  ASN1_SEQUENCE(itname) = {</span>
00145 <span class="comment"> *      ... SEQUENCE components ...</span>
00146 <span class="comment"> *  } ASN1_SEQUENCE_END_name(stname, itname)</span>
00147 <span class="comment"> *</span>
00148 <span class="comment"> *  This will create an item called itname_it using</span>
00149 <span class="comment"> *  a structure called stname.</span>
00150 <span class="comment"> */</span>
00151 
<a name="l00152"></a><a class="code" href="asn1t_8h.html#a5">00152</a> <span class="preprocessor">#define ASN1_SEQUENCE(tname) \</span>
00153 <span class="preprocessor">    static const ASN1_TEMPLATE tname##_seq_tt[] </span>
00154 <span class="preprocessor"></span>
<a name="l00155"></a><a class="code" href="asn1t_8h.html#a6">00155</a> <span class="preprocessor">#define ASN1_SEQUENCE_END(stname) ASN1_SEQUENCE_END_name(stname, stname)</span>
00156 <span class="preprocessor"></span>
<a name="l00157"></a><a class="code" href="asn1t_8h.html#a7">00157</a> <span class="preprocessor">#define ASN1_SEQUENCE_END_name(stname, tname) \</span>
00158 <span class="preprocessor">    ;\</span>
00159 <span class="preprocessor">    ASN1_ITEM_start(tname) \</span>
00160 <span class="preprocessor">        ASN1_ITYPE_SEQUENCE,\</span>
00161 <span class="preprocessor">        V_ASN1_SEQUENCE,\</span>
00162 <span class="preprocessor">        tname##_seq_tt,\</span>
00163 <span class="preprocessor">        sizeof(tname##_seq_tt) / sizeof(ASN1_TEMPLATE),\</span>
00164 <span class="preprocessor">        NULL,\</span>
00165 <span class="preprocessor">        sizeof(stname),\</span>
00166 <span class="preprocessor">        #stname \</span>
00167 <span class="preprocessor">    ASN1_ITEM_end(tname)</span>
00168 <span class="preprocessor"></span>
<a name="l00169"></a><a class="code" href="asn1t_8h.html#a8">00169</a> <span class="preprocessor">#define ASN1_SEQUENCE_cb(tname, cb) \</span>
00170 <span class="preprocessor">    static const ASN1_AUX tname##_aux = {NULL, 0, 0, 0, cb, 0}; \</span>
00171 <span class="preprocessor">    ASN1_SEQUENCE(tname)</span>
00172 <span class="preprocessor"></span>
<a name="l00173"></a><a class="code" href="asn1t_8h.html#a9">00173</a> <span class="preprocessor">#define ASN1_BROKEN_SEQUENCE(tname) \</span>
00174 <span class="preprocessor">    static const ASN1_AUX tname##_aux = {NULL, ASN1_AFLG_BROKEN, 0, 0, 0, 0}; \</span>
00175 <span class="preprocessor">    ASN1_SEQUENCE(tname)</span>
00176 <span class="preprocessor"></span>
<a name="l00177"></a><a class="code" href="asn1t_8h.html#a10">00177</a> <span class="preprocessor">#define ASN1_SEQUENCE_ref(tname, cb, lck) \</span>
00178 <span class="preprocessor">    static const ASN1_AUX tname##_aux = {NULL, ASN1_AFLG_REFCOUNT, offsetof(tname, references), lck, cb, 0}; \</span>
00179 <span class="preprocessor">    ASN1_SEQUENCE(tname)</span>
00180 <span class="preprocessor"></span>
<a name="l00181"></a><a class="code" href="asn1t_8h.html#a11">00181</a> <span class="preprocessor">#define ASN1_SEQUENCE_enc(tname, enc, cb) \</span>
00182 <span class="preprocessor">    static const ASN1_AUX tname##_aux = {NULL, ASN1_AFLG_ENCODING, 0, 0, cb, offsetof(tname, enc)}; \</span>
00183 <span class="preprocessor">    ASN1_SEQUENCE(tname)</span>
00184 <span class="preprocessor"></span>
<a name="l00185"></a><a class="code" href="asn1t_8h.html#a12">00185</a> <span class="preprocessor">#define ASN1_BROKEN_SEQUENCE_END(stname) ASN1_SEQUENCE_END_ref(stname, stname)</span>
00186 <span class="preprocessor"></span>
<a name="l00187"></a><a class="code" href="asn1t_8h.html#a13">00187</a> <span class="preprocessor">#define ASN1_SEQUENCE_END_enc(stname, tname) ASN1_SEQUENCE_END_ref(stname, tname)</span>
00188 <span class="preprocessor"></span>
<a name="l00189"></a><a class="code" href="asn1t_8h.html#a14">00189</a> <span class="preprocessor">#define ASN1_SEQUENCE_END_cb(stname, tname) ASN1_SEQUENCE_END_ref(stname, tname)</span>
00190 <span class="preprocessor"></span>
<a name="l00191"></a><a class="code" href="asn1t_8h.html#a15">00191</a> <span class="preprocessor">#define ASN1_SEQUENCE_END_ref(stname, tname) \</span>
00192 <span class="preprocessor">    ;\</span>
00193 <span class="preprocessor">    ASN1_ITEM_start(tname) \</span>
00194 <span class="preprocessor">        ASN1_ITYPE_SEQUENCE,\</span>
00195 <span class="preprocessor">        V_ASN1_SEQUENCE,\</span>
00196 <span class="preprocessor">        tname##_seq_tt,\</span>
00197 <span class="preprocessor">        sizeof(tname##_seq_tt) / sizeof(ASN1_TEMPLATE),\</span>
00198 <span class="preprocessor">        &amp;tname##_aux,\</span>
00199 <span class="preprocessor">        sizeof(stname),\</span>
00200 <span class="preprocessor">        #stname \</span>
00201 <span class="preprocessor">    ASN1_ITEM_end(tname)</span>
00202 <span class="preprocessor"></span>
00203 
00204 <span class="comment">/* This pair helps declare a CHOICE type. We can do:</span>
00205 <span class="comment"> *</span>
00206 <span class="comment"> *  ASN1_CHOICE(chname) = {</span>
00207 <span class="comment"> *      ... CHOICE options ...</span>
00208 <span class="comment"> *  ASN1_CHOICE_END(chname)</span>
00209 <span class="comment"> *</span>
00210 <span class="comment"> *  This will produce an ASN1_ITEM called chname_it</span>
00211 <span class="comment"> *  for a structure called chname. The structure</span>
00212 <span class="comment"> *  definition must look like this:</span>
00213 <span class="comment"> *  typedef struct {</span>
00214 <span class="comment"> *      int type;</span>
00215 <span class="comment"> *      union {</span>
00216 <span class="comment"> *          ASN1_SOMETHING *opt1;</span>
00217 <span class="comment"> *          ASN1_SOMEOTHER *opt2;</span>
00218 <span class="comment"> *      } value;</span>
00219 <span class="comment"> *  } chname;</span>
00220 <span class="comment"> *  </span>
00221 <span class="comment"> *  the name of the selector must be 'type'.</span>
00222 <span class="comment"> *  to use an alternative selector name use the</span>
00223 <span class="comment"> *      ASN1_CHOICE_END_selector() version.</span>
00224 <span class="comment"> */</span>
00225 
<a name="l00226"></a><a class="code" href="asn1t_8h.html#a16">00226</a> <span class="preprocessor">#define ASN1_CHOICE(tname) \</span>
00227 <span class="preprocessor">    static const ASN1_TEMPLATE tname##_ch_tt[] </span>
00228 <span class="preprocessor"></span>
<a name="l00229"></a><a class="code" href="asn1t_8h.html#a17">00229</a> <span class="preprocessor">#define ASN1_CHOICE_cb(tname, cb) \</span>
00230 <span class="preprocessor">    static const ASN1_AUX tname##_aux = {NULL, 0, 0, 0, cb, 0}; \</span>
00231 <span class="preprocessor">    ASN1_CHOICE(tname)</span>
00232 <span class="preprocessor"></span>
<a name="l00233"></a><a class="code" href="asn1t_8h.html#a18">00233</a> <span class="preprocessor">#define ASN1_CHOICE_END(stname) ASN1_CHOICE_END_name(stname, stname)</span>
00234 <span class="preprocessor"></span>
<a name="l00235"></a><a class="code" href="asn1t_8h.html#a19">00235</a> <span class="preprocessor">#define ASN1_CHOICE_END_name(stname, tname) ASN1_CHOICE_END_selector(stname, tname, type)</span>
00236 <span class="preprocessor"></span>
<a name="l00237"></a><a class="code" href="asn1t_8h.html#a20">00237</a> <span class="preprocessor">#define ASN1_CHOICE_END_selector(stname, tname, selname) \</span>
00238 <span class="preprocessor">    ;\</span>
00239 <span class="preprocessor">    ASN1_ITEM_start(tname) \</span>
00240 <span class="preprocessor">        ASN1_ITYPE_CHOICE,\</span>
00241 <span class="preprocessor">        offsetof(stname,selname) ,\</span>
00242 <span class="preprocessor">        tname##_ch_tt,\</span>
00243 <span class="preprocessor">        sizeof(tname##_ch_tt) / sizeof(ASN1_TEMPLATE),\</span>
00244 <span class="preprocessor">        NULL,\</span>
00245 <span class="preprocessor">        sizeof(stname),\</span>
00246 <span class="preprocessor">        #stname \</span>
00247 <span class="preprocessor">    ASN1_ITEM_end(tname)</span>
00248 <span class="preprocessor"></span>
<a name="l00249"></a><a class="code" href="asn1t_8h.html#a21">00249</a> <span class="preprocessor">#define ASN1_CHOICE_END_cb(stname, tname, selname) \</span>
00250 <span class="preprocessor">    ;\</span>
00251 <span class="preprocessor">    ASN1_ITEM_start(tname) \</span>
00252 <span class="preprocessor">        ASN1_ITYPE_CHOICE,\</span>
00253 <span class="preprocessor">        offsetof(stname,selname) ,\</span>
00254 <span class="preprocessor">        tname##_ch_tt,\</span>
00255 <span class="preprocessor">        sizeof(tname##_ch_tt) / sizeof(ASN1_TEMPLATE),\</span>
00256 <span class="preprocessor">        &amp;tname##_aux,\</span>
00257 <span class="preprocessor">        sizeof(stname),\</span>
00258 <span class="preprocessor">        #stname \</span>
00259 <span class="preprocessor">    ASN1_ITEM_end(tname)</span>
00260 <span class="preprocessor"></span>
00261 <span class="comment">/* This helps with the template wrapper form of ASN1_ITEM */</span>
00262 
<a name="l00263"></a><a class="code" href="asn1t_8h.html#a22">00263</a> <span class="preprocessor">#define ASN1_EX_TEMPLATE_TYPE(flags, tag, name, type) { \</span>
00264 <span class="preprocessor">    (flags), (tag), 0,\</span>
00265 <span class="preprocessor">    #name, ASN1_ITEM_ref(type) }</span>
00266 <span class="preprocessor"></span>
00267 <span class="comment">/* These help with SEQUENCE or CHOICE components */</span>
00268 
00269 <span class="comment">/* used to declare other types */</span>
00270 
<a name="l00271"></a><a class="code" href="asn1t_8h.html#a23">00271</a> <span class="preprocessor">#define ASN1_EX_TYPE(flags, tag, stname, field, type) { \</span>
00272 <span class="preprocessor">    (flags), (tag), offsetof(stname, field),\</span>
00273 <span class="preprocessor">    #field, ASN1_ITEM_ref(type) }</span>
00274 <span class="preprocessor"></span>
00275 <span class="comment">/* used when the structure is combined with the parent */</span>
00276 
<a name="l00277"></a><a class="code" href="asn1t_8h.html#a24">00277</a> <span class="preprocessor">#define ASN1_EX_COMBINE(flags, tag, type) { \</span>
00278 <span class="preprocessor">    (flags)|ASN1_TFLG_COMBINE, (tag), 0, NULL, ASN1_ITEM_ref(type) }</span>
00279 <span class="preprocessor"></span>
00280 <span class="comment">/* implicit and explicit helper macros */</span>
00281 
<a name="l00282"></a><a class="code" href="asn1t_8h.html#a25">00282</a> <span class="preprocessor">#define ASN1_IMP_EX(stname, field, type, tag, ex) \</span>
00283 <span class="preprocessor">        ASN1_EX_TYPE(ASN1_TFLG_IMPLICIT | ex, tag, stname, field, type)</span>
00284 <span class="preprocessor"></span>
<a name="l00285"></a><a class="code" href="asn1t_8h.html#a26">00285</a> <span class="preprocessor">#define ASN1_EXP_EX(stname, field, type, tag, ex) \</span>
00286 <span class="preprocessor">        ASN1_EX_TYPE(ASN1_TFLG_EXPLICIT | ex, tag, stname, field, type)</span>
00287 <span class="preprocessor"></span>
00288 <span class="comment">/* Any defined by macros: the field used is in the table itself */</span>
00289 
00290 <span class="preprocessor">#ifndef OPENSSL_EXPORT_VAR_AS_FUNCTION</span>
<a name="l00291"></a><a class="code" href="asn1t_8h.html#a27">00291</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_ADB_OBJECT(tblname) { ASN1_TFLG_ADB_OID, -1, 0, #tblname, (const ASN1_ITEM *)&amp;(tblname##_adb) }</span>
<a name="l00292"></a><a class="code" href="asn1t_8h.html#a28">00292</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_ADB_INTEGER(tblname) { ASN1_TFLG_ADB_INT, -1, 0, #tblname, (const ASN1_ITEM *)&amp;(tblname##_adb) }</span>
00293 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00294 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_ADB_OBJECT(tblname) { ASN1_TFLG_ADB_OID, -1, 0, #tblname, tblname##_adb }</span>
00295 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_ADB_INTEGER(tblname) { ASN1_TFLG_ADB_INT, -1, 0, #tblname, tblname##_adb }</span>
00296 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00297 <span class="preprocessor"></span><span class="comment">/* Plain simple type */</span>
<a name="l00298"></a><a class="code" href="asn1t_8h.html#a29">00298</a> <span class="preprocessor">#define ASN1_SIMPLE(stname, field, type) ASN1_EX_TYPE(0,0, stname, field, type)</span>
00299 <span class="preprocessor"></span>
00300 <span class="comment">/* OPTIONAL simple type */</span>
<a name="l00301"></a><a class="code" href="asn1t_8h.html#a30">00301</a> <span class="preprocessor">#define ASN1_OPT(stname, field, type) ASN1_EX_TYPE(ASN1_TFLG_OPTIONAL, 0, stname, field, type)</span>
00302 <span class="preprocessor"></span>
00303 <span class="comment">/* IMPLICIT tagged simple type */</span>
<a name="l00304"></a><a class="code" href="asn1t_8h.html#a31">00304</a> <span class="preprocessor">#define ASN1_IMP(stname, field, type, tag) ASN1_IMP_EX(stname, field, type, tag, 0)</span>
00305 <span class="preprocessor"></span>
00306 <span class="comment">/* IMPLICIT tagged OPTIONAL simple type */</span>
<a name="l00307"></a><a class="code" href="asn1t_8h.html#a32">00307</a> <span class="preprocessor">#define ASN1_IMP_OPT(stname, field, type, tag) ASN1_IMP_EX(stname, field, type, tag, ASN1_TFLG_OPTIONAL)</span>
00308 <span class="preprocessor"></span>
00309 <span class="comment">/* Same as above but EXPLICIT */</span>
00310 
<a name="l00311"></a><a class="code" href="asn1t_8h.html#a33">00311</a> <span class="preprocessor">#define ASN1_EXP(stname, field, type, tag) ASN1_EXP_EX(stname, field, type, tag, 0)</span>
<a name="l00312"></a><a class="code" href="asn1t_8h.html#a34">00312</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_EXP_OPT(stname, field, type, tag) ASN1_EXP_EX(stname, field, type, tag, ASN1_TFLG_OPTIONAL)</span>
00313 <span class="preprocessor"></span>
00314 <span class="comment">/* SEQUENCE OF type */</span>
<a name="l00315"></a><a class="code" href="asn1t_8h.html#a35">00315</a> <span class="preprocessor">#define ASN1_SEQUENCE_OF(stname, field, type) \</span>
00316 <span class="preprocessor">        ASN1_EX_TYPE(ASN1_TFLG_SEQUENCE_OF, 0, stname, field, type)</span>
00317 <span class="preprocessor"></span>
00318 <span class="comment">/* OPTIONAL SEQUENCE OF */</span>
<a name="l00319"></a><a class="code" href="asn1t_8h.html#a36">00319</a> <span class="preprocessor">#define ASN1_SEQUENCE_OF_OPT(stname, field, type) \</span>
00320 <span class="preprocessor">        ASN1_EX_TYPE(ASN1_TFLG_SEQUENCE_OF|ASN1_TFLG_OPTIONAL, 0, stname, field, type)</span>
00321 <span class="preprocessor"></span>
00322 <span class="comment">/* Same as above but for SET OF */</span>
00323 
<a name="l00324"></a><a class="code" href="asn1t_8h.html#a37">00324</a> <span class="preprocessor">#define ASN1_SET_OF(stname, field, type) \</span>
00325 <span class="preprocessor">        ASN1_EX_TYPE(ASN1_TFLG_SET_OF, 0, stname, field, type)</span>
00326 <span class="preprocessor"></span>
<a name="l00327"></a><a class="code" href="asn1t_8h.html#a38">00327</a> <span class="preprocessor">#define ASN1_SET_OF_OPT(stname, field, type) \</span>
00328 <span class="preprocessor">        ASN1_EX_TYPE(ASN1_TFLG_SET_OF|ASN1_TFLG_OPTIONAL, 0, stname, field, type)</span>
00329 <span class="preprocessor"></span>
00330 <span class="comment">/* Finally compound types of SEQUENCE, SET, IMPLICIT, EXPLICIT and OPTIONAL */</span>
00331 
<a name="l00332"></a><a class="code" href="asn1t_8h.html#a39">00332</a> <span class="preprocessor">#define ASN1_IMP_SET_OF(stname, field, type, tag) \</span>
00333 <span class="preprocessor">            ASN1_IMP_EX(stname, field, type, tag, ASN1_TFLG_SET_OF)</span>
00334 <span class="preprocessor"></span>
<a name="l00335"></a><a class="code" href="asn1t_8h.html#a40">00335</a> <span class="preprocessor">#define ASN1_EXP_SET_OF(stname, field, type, tag) \</span>
00336 <span class="preprocessor">            ASN1_EXP_EX(stname, field, type, tag, ASN1_TFLG_SET_OF)</span>
00337 <span class="preprocessor"></span>
<a name="l00338"></a><a class="code" href="asn1t_8h.html#a41">00338</a> <span class="preprocessor">#define ASN1_IMP_SET_OF_OPT(stname, field, type, tag) \</span>
00339 <span class="preprocessor">            ASN1_IMP_EX(stname, field, type, tag, ASN1_TFLG_SET_OF|ASN1_TFLG_OPTIONAL)</span>
00340 <span class="preprocessor"></span>
<a name="l00341"></a><a class="code" href="asn1t_8h.html#a42">00341</a> <span class="preprocessor">#define ASN1_EXP_SET_OF_OPT(stname, field, type, tag) \</span>
00342 <span class="preprocessor">            ASN1_EXP_EX(stname, field, type, tag, ASN1_TFLG_SET_OF|ASN1_TFLG_OPTIONAL)</span>
00343 <span class="preprocessor"></span>
<a name="l00344"></a><a class="code" href="asn1t_8h.html#a43">00344</a> <span class="preprocessor">#define ASN1_IMP_SEQUENCE_OF(stname, field, type, tag) \</span>
00345 <span class="preprocessor">            ASN1_IMP_EX(stname, field, type, tag, ASN1_TFLG_SEQUENCE_OF)</span>
00346 <span class="preprocessor"></span>
<a name="l00347"></a><a class="code" href="asn1t_8h.html#a44">00347</a> <span class="preprocessor">#define ASN1_IMP_SEQUENCE_OF_OPT(stname, field, type, tag) \</span>
00348 <span class="preprocessor">            ASN1_IMP_EX(stname, field, type, tag, ASN1_TFLG_SEQUENCE_OF|ASN1_TFLG_OPTIONAL)</span>
00349 <span class="preprocessor"></span>
<a name="l00350"></a><a class="code" href="asn1t_8h.html#a45">00350</a> <span class="preprocessor">#define ASN1_EXP_SEQUENCE_OF(stname, field, type, tag) \</span>
00351 <span class="preprocessor">            ASN1_EXP_EX(stname, field, type, tag, ASN1_TFLG_SEQUENCE_OF)</span>
00352 <span class="preprocessor"></span>
<a name="l00353"></a><a class="code" href="asn1t_8h.html#a46">00353</a> <span class="preprocessor">#define ASN1_EXP_SEQUENCE_OF_OPT(stname, field, type, tag) \</span>
00354 <span class="preprocessor">            ASN1_EXP_EX(stname, field, type, tag, ASN1_TFLG_SEQUENCE_OF|ASN1_TFLG_OPTIONAL)</span>
00355 <span class="preprocessor"></span>
00356 <span class="comment">/* Macros for the ASN1_ADB structure */</span>
00357 
<a name="l00358"></a><a class="code" href="asn1t_8h.html#a47">00358</a> <span class="preprocessor">#define ASN1_ADB(name) \</span>
00359 <span class="preprocessor">    static const ASN1_ADB_TABLE name##_adbtbl[] </span>
00360 <span class="preprocessor"></span>
00361 <span class="preprocessor">#ifndef OPENSSL_EXPORT_VAR_AS_FUNCTION</span>
00362 <span class="preprocessor"></span>
<a name="l00363"></a><a class="code" href="asn1t_8h.html#a48">00363</a> <span class="preprocessor">#define ASN1_ADB_END(name, flags, field, app_table, def, none) \</span>
00364 <span class="preprocessor">    ;\</span>
00365 <span class="preprocessor">    static const ASN1_ADB name##_adb = {\</span>
00366 <span class="preprocessor">        flags,\</span>
00367 <span class="preprocessor">        offsetof(name, field),\</span>
00368 <span class="preprocessor">        app_table,\</span>
00369 <span class="preprocessor">        name##_adbtbl,\</span>
00370 <span class="preprocessor">        sizeof(name##_adbtbl) / sizeof(ASN1_ADB_TABLE),\</span>
00371 <span class="preprocessor">        def,\</span>
00372 <span class="preprocessor">        none\</span>
00373 <span class="preprocessor">    }</span>
00374 <span class="preprocessor"></span>
00375 <span class="preprocessor">#else</span>
00376 <span class="preprocessor"></span>
00377 <span class="preprocessor">#define ASN1_ADB_END(name, flags, field, app_table, def, none) \</span>
00378 <span class="preprocessor">    ;\</span>
00379 <span class="preprocessor">    static const ASN1_ITEM *name##_adb(void) \</span>
00380 <span class="preprocessor">    { \</span>
00381 <span class="preprocessor">    static const ASN1_ADB internal_adb = \</span>
00382 <span class="preprocessor">        {\</span>
00383 <span class="preprocessor">        flags,\</span>
00384 <span class="preprocessor">        offsetof(name, field),\</span>
00385 <span class="preprocessor">        app_table,\</span>
00386 <span class="preprocessor">        name##_adbtbl,\</span>
00387 <span class="preprocessor">        sizeof(name##_adbtbl) / sizeof(ASN1_ADB_TABLE),\</span>
00388 <span class="preprocessor">        def,\</span>
00389 <span class="preprocessor">        none\</span>
00390 <span class="preprocessor">        }; \</span>
00391 <span class="preprocessor">        return (const ASN1_ITEM *) &amp;internal_adb; \</span>
00392 <span class="preprocessor">    } \</span>
00393 <span class="preprocessor">    void dummy_function(void)</span>
00394 <span class="preprocessor"></span>
00395 <span class="preprocessor">#endif</span>
00396 <span class="preprocessor"></span>
<a name="l00397"></a><a class="code" href="asn1t_8h.html#a49">00397</a> <span class="preprocessor">#define ADB_ENTRY(val, template) {val, template}</span>
00398 <span class="preprocessor"></span>
<a name="l00399"></a><a class="code" href="asn1t_8h.html#a50">00399</a> <span class="preprocessor">#define ASN1_ADB_TEMPLATE(name) \</span>
00400 <span class="preprocessor">    static const ASN1_TEMPLATE name##_tt </span>
00401 <span class="preprocessor"></span>
00402 <span class="comment">/* This is the ASN1 template structure that defines</span>
00403 <span class="comment"> * a wrapper round the actual type. It determines the</span>
00404 <span class="comment"> * actual position of the field in the value structure,</span>
00405 <span class="comment"> * various flags such as OPTIONAL and the field name.</span>
00406 <span class="comment"> */</span>
00407 
<a name="l00408"></a><a class="code" href="structASN1__TEMPLATE__st.html">00408</a> <span class="keyword">struct </span><a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE_st</a> {
<a name="l00409"></a><a class="code" href="structASN1__TEMPLATE__st.html#m0">00409</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structASN1__TEMPLATE__st.html#m0">flags</a>;        <span class="comment">/* Various flags */</span>
<a name="l00410"></a><a class="code" href="structASN1__TEMPLATE__st.html#m1">00410</a> <span class="keywordtype">long</span> <a class="code" href="structASN1__TEMPLATE__st.html#m1">tag</a>;           <span class="comment">/* tag, not used if no tagging */</span>
<a name="l00411"></a><a class="code" href="structASN1__TEMPLATE__st.html#m2">00411</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structASN1__TEMPLATE__st.html#m2">offset</a>;       <span class="comment">/* Offset of this field in structure */</span>
00412 <span class="preprocessor">#ifndef NO_ASN1_FIELD_NAMES</span>
<a name="l00413"></a><a class="code" href="structASN1__TEMPLATE__st.html#m3">00413</a> <span class="preprocessor"></span><span class="keywordtype">char</span> *<a class="code" href="structASN1__TEMPLATE__st.html#m3">field_name</a>;       <span class="comment">/* Field name */</span>
00414 <span class="preprocessor">#endif</span>
<a name="l00415"></a><a class="code" href="structASN1__TEMPLATE__st.html#m4">00415</a> <span class="preprocessor"></span><a class="code" href="asn1_8h.html#a352">ASN1_ITEM_EXP</a> *<a class="code" href="structASN1__TEMPLATE__st.html#m4">item</a>;        <span class="comment">/* Relevant ASN1_ITEM or ASN1_ADB */</span>
00416 };
00417 
00418 <span class="comment">/* Macro to extract ASN1_ITEM and ASN1_ADB pointer from ASN1_TEMPLATE */</span>
00419 
<a name="l00420"></a><a class="code" href="asn1t_8h.html#a51">00420</a> <span class="preprocessor">#define ASN1_TEMPLATE_item(t) (t-&gt;item_ptr)</span>
<a name="l00421"></a><a class="code" href="asn1t_8h.html#a52">00421</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_TEMPLATE_adb(t) (t-&gt;item_ptr)</span>
00422 <span class="preprocessor"></span>
<a name="l00423"></a><a class="code" href="asn1t_8h.html#a105">00423</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structASN1__ADB__TABLE__st.html">ASN1_ADB_TABLE_st</a> ASN1_ADB_TABLE;
<a name="l00424"></a><a class="code" href="asn1t_8h.html#a106">00424</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structASN1__ADB__st.html">ASN1_ADB_st</a> ASN1_ADB;
00425 
<a name="l00426"></a><a class="code" href="structASN1__ADB__st.html">00426</a> <span class="keyword">struct </span><a class="code" href="structASN1__ADB__st.html">ASN1_ADB_st</a> {
<a name="l00427"></a><a class="code" href="structASN1__ADB__st.html#m0">00427</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structASN1__ADB__st.html#m0">flags</a>;    <span class="comment">/* Various flags */</span>
<a name="l00428"></a><a class="code" href="structASN1__ADB__st.html#m1">00428</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structASN1__ADB__st.html#m1">offset</a>;   <span class="comment">/* Offset of selector field */</span>
00429     <a class="code" href="structASN1__ADB__st.html#a0">STACK_OF</a>(ASN1_ADB_TABLE) **app_items; <span class="comment">/* Application defined items */</span>
<a name="l00430"></a><a class="code" href="structASN1__ADB__st.html#m2">00430</a>     <span class="keyword">const</span> ASN1_ADB_TABLE *<a class="code" href="structASN1__ADB__st.html#m2">tbl</a>;  <span class="comment">/* Table of possible types */</span>
<a name="l00431"></a><a class="code" href="structASN1__ADB__st.html#m3">00431</a>     <span class="keywordtype">long</span> <a class="code" href="structASN1__ADB__st.html#m3">tblcount</a>;      <span class="comment">/* Number of entries in tbl */</span>
<a name="l00432"></a><a class="code" href="structASN1__ADB__st.html#m4">00432</a>     <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *<a class="code" href="structASN1__ADB__st.html#m4">default_tt</a>;  <span class="comment">/* Type to use if no match */</span>
<a name="l00433"></a><a class="code" href="structASN1__ADB__st.html#m5">00433</a>     <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *<a class="code" href="structASN1__ADB__st.html#m5">null_tt</a>;  <span class="comment">/* Type to use if selector is NULL */</span>
00434 };
00435 
<a name="l00436"></a><a class="code" href="structASN1__ADB__TABLE__st.html">00436</a> <span class="keyword">struct </span><a class="code" href="structASN1__ADB__TABLE__st.html">ASN1_ADB_TABLE_st</a> {
<a name="l00437"></a><a class="code" href="structASN1__ADB__TABLE__st.html#m0">00437</a>     <span class="keywordtype">long</span> <a class="code" href="structASN1__ADB__TABLE__st.html#m0">value</a>;     <span class="comment">/* NID for an object or value for an int */</span>
<a name="l00438"></a><a class="code" href="structASN1__ADB__TABLE__st.html#m1">00438</a>     <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> <a class="code" href="structASN1__ADB__TABLE__st.html#m1">tt</a>;     <span class="comment">/* item for this value */</span>
00439 };
00440 
00441 <span class="comment">/* template flags */</span>
00442 
00443 <span class="comment">/* Field is optional */</span>
<a name="l00444"></a><a class="code" href="asn1t_8h.html#a53">00444</a> <span class="preprocessor">#define ASN1_TFLG_OPTIONAL  (0x1)</span>
00445 <span class="preprocessor"></span>
00446 <span class="comment">/* Field is a SET OF */</span>
<a name="l00447"></a><a class="code" href="asn1t_8h.html#a54">00447</a> <span class="preprocessor">#define ASN1_TFLG_SET_OF    (0x1 &lt;&lt; 1)</span>
00448 <span class="preprocessor"></span>
00449 <span class="comment">/* Field is a SEQUENCE OF */</span>
<a name="l00450"></a><a class="code" href="asn1t_8h.html#a55">00450</a> <span class="preprocessor">#define ASN1_TFLG_SEQUENCE_OF   (0x2 &lt;&lt; 1)</span>
00451 <span class="preprocessor"></span>
00452 <span class="comment">/* Special case: this refers to a SET OF that</span>
00453 <span class="comment"> * will be sorted into DER order when encoded *and*</span>
00454 <span class="comment"> * the corresponding STACK will be modified to match</span>
00455 <span class="comment"> * the new order.</span>
00456 <span class="comment"> */</span>
<a name="l00457"></a><a class="code" href="asn1t_8h.html#a56">00457</a> <span class="preprocessor">#define ASN1_TFLG_SET_ORDER (0x3 &lt;&lt; 1)</span>
00458 <span class="preprocessor"></span>
00459 <span class="comment">/* Mask for SET OF or SEQUENCE OF */</span>
<a name="l00460"></a><a class="code" href="asn1t_8h.html#a57">00460</a> <span class="preprocessor">#define ASN1_TFLG_SK_MASK   (0x3 &lt;&lt; 1)</span>
00461 <span class="preprocessor"></span>
00462 <span class="comment">/* These flags mean the tag should be taken from the</span>
00463 <span class="comment"> * tag field. If EXPLICIT then the underlying type</span>
00464 <span class="comment"> * is used for the inner tag.</span>
00465 <span class="comment"> */</span>
00466 
00467 <span class="comment">/* IMPLICIT tagging */</span>
<a name="l00468"></a><a class="code" href="asn1t_8h.html#a58">00468</a> <span class="preprocessor">#define ASN1_TFLG_IMPTAG    (0x1 &lt;&lt; 3)</span>
00469 <span class="preprocessor"></span>
00470 
00471 <span class="comment">/* EXPLICIT tagging, inner tag from underlying type */</span>
<a name="l00472"></a><a class="code" href="asn1t_8h.html#a59">00472</a> <span class="preprocessor">#define ASN1_TFLG_EXPTAG    (0x2 &lt;&lt; 3)</span>
00473 <span class="preprocessor"></span>
<a name="l00474"></a><a class="code" href="asn1t_8h.html#a60">00474</a> <span class="preprocessor">#define ASN1_TFLG_TAG_MASK  (0x3 &lt;&lt; 3)</span>
00475 <span class="preprocessor"></span>
00476 <span class="comment">/* context specific IMPLICIT */</span>
<a name="l00477"></a><a class="code" href="asn1t_8h.html#a61">00477</a> <span class="preprocessor">#define ASN1_TFLG_IMPLICIT  ASN1_TFLG_IMPTAG|ASN1_TFLG_CONTEXT</span>
00478 <span class="preprocessor"></span>
00479 <span class="comment">/* context specific EXPLICIT */</span>
<a name="l00480"></a><a class="code" href="asn1t_8h.html#a62">00480</a> <span class="preprocessor">#define ASN1_TFLG_EXPLICIT  ASN1_TFLG_EXPTAG|ASN1_TFLG_CONTEXT</span>
00481 <span class="preprocessor"></span>
00482 <span class="comment">/* If tagging is in force these determine the</span>
00483 <span class="comment"> * type of tag to use. Otherwise the tag is</span>
00484 <span class="comment"> * determined by the underlying type. These </span>
00485 <span class="comment"> * values reflect the actual octet format.</span>
00486 <span class="comment"> */</span>
00487 
00488 <span class="comment">/* Universal tag */</span> 
<a name="l00489"></a><a class="code" href="asn1t_8h.html#a63">00489</a> <span class="preprocessor">#define ASN1_TFLG_UNIVERSAL (0x0&lt;&lt;6)</span>
00490 <span class="preprocessor"></span><span class="comment">/* Application tag */</span> 
<a name="l00491"></a><a class="code" href="asn1t_8h.html#a64">00491</a> <span class="preprocessor">#define ASN1_TFLG_APPLICATION   (0x1&lt;&lt;6)</span>
00492 <span class="preprocessor"></span><span class="comment">/* Context specific tag */</span> 
<a name="l00493"></a><a class="code" href="asn1t_8h.html#a65">00493</a> <span class="preprocessor">#define ASN1_TFLG_CONTEXT   (0x2&lt;&lt;6)</span>
00494 <span class="preprocessor"></span><span class="comment">/* Private tag */</span> 
<a name="l00495"></a><a class="code" href="asn1t_8h.html#a66">00495</a> <span class="preprocessor">#define ASN1_TFLG_PRIVATE   (0x3&lt;&lt;6)</span>
00496 <span class="preprocessor"></span>
<a name="l00497"></a><a class="code" href="asn1t_8h.html#a67">00497</a> <span class="preprocessor">#define ASN1_TFLG_TAG_CLASS (0x3&lt;&lt;6)</span>
00498 <span class="preprocessor"></span>
00499 <span class="comment">/* These are for ANY DEFINED BY type. In this case</span>
00500 <span class="comment"> * the 'item' field points to an ASN1_ADB structure</span>
00501 <span class="comment"> * which contains a table of values to decode the</span>
00502 <span class="comment"> * relevant type</span>
00503 <span class="comment"> */</span>
00504 
<a name="l00505"></a><a class="code" href="asn1t_8h.html#a68">00505</a> <span class="preprocessor">#define ASN1_TFLG_ADB_MASK  (0x3&lt;&lt;8)</span>
00506 <span class="preprocessor"></span>
<a name="l00507"></a><a class="code" href="asn1t_8h.html#a69">00507</a> <span class="preprocessor">#define ASN1_TFLG_ADB_OID   (0x1&lt;&lt;8)</span>
00508 <span class="preprocessor"></span>
<a name="l00509"></a><a class="code" href="asn1t_8h.html#a70">00509</a> <span class="preprocessor">#define ASN1_TFLG_ADB_INT   (0x1&lt;&lt;9)</span>
00510 <span class="preprocessor"></span>
00511 <span class="comment">/* This flag means a parent structure is passed</span>
00512 <span class="comment"> * instead of the field: this is useful is a</span>
00513 <span class="comment"> * SEQUENCE is being combined with a CHOICE for</span>
00514 <span class="comment"> * example. Since this means the structure and</span>
00515 <span class="comment"> * item name will differ we need to use the</span>
00516 <span class="comment"> * ASN1_CHOICE_END_name() macro for example.</span>
00517 <span class="comment"> */</span>
00518 
<a name="l00519"></a><a class="code" href="asn1t_8h.html#a71">00519</a> <span class="preprocessor">#define ASN1_TFLG_COMBINE   (0x1&lt;&lt;10)</span>
00520 <span class="preprocessor"></span>
00521 <span class="comment">/* This is the actual ASN1 item itself */</span>
00522 
<a name="l00523"></a><a class="code" href="structASN1__ITEM__st.html">00523</a> <span class="keyword">struct </span><a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM_st</a> {
<a name="l00524"></a><a class="code" href="structASN1__ITEM__st.html#m0">00524</a> <span class="keywordtype">char</span> <a class="code" href="structASN1__ITEM__st.html#m0">itype</a>;         <span class="comment">/* The item type, primitive, SEQUENCE, CHOICE or extern */</span>
<a name="l00525"></a><a class="code" href="structASN1__ITEM__st.html#m1">00525</a> <span class="keywordtype">long</span> <a class="code" href="structASN1__ITEM__st.html#m1">utype</a>;         <span class="comment">/* underlying type */</span>
<a name="l00526"></a><a class="code" href="structASN1__ITEM__st.html#m2">00526</a> <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *<a class="code" href="structASN1__ITEM__st.html#m2">templates</a>; <span class="comment">/* If SEQUENCE or CHOICE this contains the contents */</span>
<a name="l00527"></a><a class="code" href="structASN1__ITEM__st.html#m3">00527</a> <span class="keywordtype">long</span> <a class="code" href="structASN1__ITEM__st.html#m3">tcount</a>;            <span class="comment">/* Number of templates if SEQUENCE or CHOICE */</span>
<a name="l00528"></a><a class="code" href="structASN1__ITEM__st.html#m4">00528</a> <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="structASN1__ITEM__st.html#m4">funcs</a>;      <span class="comment">/* functions that handle this type */</span>
<a name="l00529"></a><a class="code" href="structASN1__ITEM__st.html#m5">00529</a> <span class="keywordtype">long</span> <a class="code" href="structASN1__ITEM__st.html#m5">size</a>;          <span class="comment">/* Structure size (usually)*/</span>
00530 <span class="preprocessor">#ifndef NO_ASN1_FIELD_NAMES</span>
<a name="l00531"></a><a class="code" href="structASN1__ITEM__st.html#m6">00531</a> <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structASN1__ITEM__st.html#m6">sname</a>;      <span class="comment">/* Structure name */</span>
00532 <span class="preprocessor">#endif</span>
00533 <span class="preprocessor"></span>};
00534 
00535 <span class="comment">/* These are values for the itype field and</span>
00536 <span class="comment"> * determine how the type is interpreted.</span>
00537 <span class="comment"> *</span>
00538 <span class="comment"> * For PRIMITIVE types the underlying type</span>
00539 <span class="comment"> * determines the behaviour if items is NULL.</span>
00540 <span class="comment"> *</span>
00541 <span class="comment"> * Otherwise templates must contain a single </span>
00542 <span class="comment"> * template and the type is treated in the</span>
00543 <span class="comment"> * same way as the type specified in the template.</span>
00544 <span class="comment"> *</span>
00545 <span class="comment"> * For SEQUENCE types the templates field points</span>
00546 <span class="comment"> * to the members, the size field is the</span>
00547 <span class="comment"> * structure size.</span>
00548 <span class="comment"> *</span>
00549 <span class="comment"> * For CHOICE types the templates field points</span>
00550 <span class="comment"> * to each possible member (typically a union)</span>
00551 <span class="comment"> * and the 'size' field is the offset of the</span>
00552 <span class="comment"> * selector.</span>
00553 <span class="comment"> *</span>
00554 <span class="comment"> * The 'funcs' field is used for application</span>
00555 <span class="comment"> * specific functions. </span>
00556 <span class="comment"> *</span>
00557 <span class="comment"> * For COMPAT types the funcs field gives a</span>
00558 <span class="comment"> * set of functions that handle this type, this</span>
00559 <span class="comment"> * supports the old d2i, i2d convention.</span>
00560 <span class="comment"> *</span>
00561 <span class="comment"> * The EXTERN type uses a new style d2i/i2d.</span>
00562 <span class="comment"> * The new style should be used where possible</span>
00563 <span class="comment"> * because it avoids things like the d2i IMPLICIT</span>
00564 <span class="comment"> * hack.</span>
00565 <span class="comment"> *</span>
00566 <span class="comment"> * MSTRING is a multiple string type, it is used</span>
00567 <span class="comment"> * for a CHOICE of character strings where the</span>
00568 <span class="comment"> * actual strings all occupy an ASN1_STRING</span>
00569 <span class="comment"> * structure. In this case the 'utype' field</span>
00570 <span class="comment"> * has a special meaning, it is used as a mask</span>
00571 <span class="comment"> * of acceptable types using the B_ASN1 constants.</span>
00572 <span class="comment"> *</span>
00573 <span class="comment"> */</span>
00574 
<a name="l00575"></a><a class="code" href="asn1t_8h.html#a72">00575</a> <span class="preprocessor">#define ASN1_ITYPE_PRIMITIVE    0x0</span>
00576 <span class="preprocessor"></span>
<a name="l00577"></a><a class="code" href="asn1t_8h.html#a73">00577</a> <span class="preprocessor">#define ASN1_ITYPE_SEQUENCE 0x1</span>
00578 <span class="preprocessor"></span>
<a name="l00579"></a><a class="code" href="asn1t_8h.html#a74">00579</a> <span class="preprocessor">#define ASN1_ITYPE_CHOICE   0x2</span>
00580 <span class="preprocessor"></span>
<a name="l00581"></a><a class="code" href="asn1t_8h.html#a75">00581</a> <span class="preprocessor">#define ASN1_ITYPE_COMPAT   0x3</span>
00582 <span class="preprocessor"></span>
<a name="l00583"></a><a class="code" href="asn1t_8h.html#a76">00583</a> <span class="preprocessor">#define ASN1_ITYPE_EXTERN   0x4</span>
00584 <span class="preprocessor"></span>
<a name="l00585"></a><a class="code" href="asn1t_8h.html#a77">00585</a> <span class="preprocessor">#define ASN1_ITYPE_MSTRING  0x5</span>
00586 <span class="preprocessor"></span>
00587 <span class="comment">/* Cache for ASN1 tag and length, so we</span>
00588 <span class="comment"> * don't keep re-reading it for things</span>
00589 <span class="comment"> * like CHOICE</span>
00590 <span class="comment"> */</span>
00591 
<a name="l00592"></a><a class="code" href="structASN1__TLC__st.html">00592</a> <span class="keyword">struct </span><a class="code" href="structASN1__TLC__st.html">ASN1_TLC_st</a>{
<a name="l00593"></a><a class="code" href="structASN1__TLC__st.html#m0">00593</a>     <span class="keywordtype">char</span> <a class="code" href="structASN1__TLC__st.html#m0">valid</a>; <span class="comment">/* Values below are valid */</span>
<a name="l00594"></a><a class="code" href="structASN1__TLC__st.html#m1">00594</a>     <span class="keywordtype">int</span> <a class="code" href="structASN1__TLC__st.html#m1">ret</a>;    <span class="comment">/* return value */</span>
<a name="l00595"></a><a class="code" href="structASN1__TLC__st.html#m2">00595</a>     <span class="keywordtype">long</span> <a class="code" href="structASN1__TLC__st.html#m2">plen</a>;  <span class="comment">/* length */</span>
<a name="l00596"></a><a class="code" href="structASN1__TLC__st.html#m3">00596</a>     <span class="keywordtype">int</span> <a class="code" href="structASN1__TLC__st.html#m3">ptag</a>;   <span class="comment">/* class value */</span>
<a name="l00597"></a><a class="code" href="structASN1__TLC__st.html#m4">00597</a>     <span class="keywordtype">int</span> <a class="code" href="structASN1__TLC__st.html#m4">pclass</a>; <span class="comment">/* class value */</span>
<a name="l00598"></a><a class="code" href="structASN1__TLC__st.html#m5">00598</a>     <span class="keywordtype">int</span> <a class="code" href="structASN1__TLC__st.html#m5">hdrlen</a>; <span class="comment">/* header length */</span>
00599 };
00600 
00601 <span class="comment">/* Typedefs for ASN1 function pointers */</span>
00602 
<a name="l00603"></a><a class="code" href="asn1t_8h.html#a107">00603</a> <span class="keyword">typedef</span> <a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> * <a class="code" href="asn1t_8h.html#a107">ASN1_new_func</a>(<span class="keywordtype">void</span>);
<a name="l00604"></a><a class="code" href="asn1t_8h.html#a108">00604</a> <span class="keyword">typedef</span> <span class="keywordtype">void</span> <a class="code" href="asn1t_8h.html#a108">ASN1_free_func</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> *<a class="code" href="v3__extku_8c.html#a3">a</a>);
<a name="l00605"></a><a class="code" href="asn1t_8h.html#a109">00605</a> <span class="keyword">typedef</span> <a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> * <a class="code" href="asn1t_8h.html#a109">ASN1_d2i_func</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **<a class="code" href="v3__extku_8c.html#a3">a</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ** in, <span class="keywordtype">long</span> length);
<a name="l00606"></a><a class="code" href="asn1t_8h.html#a110">00606</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="asn1t_8h.html#a110">ASN1_i2d_func</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> * <a class="code" href="v3__extku_8c.html#a3">a</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **in);
00607 
<a name="l00608"></a><a class="code" href="asn1t_8h.html#a111">00608</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="asn1t_8h.html#a111">ASN1_ex_d2i</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **in, <span class="keywordtype">long</span> <a class="code" href="x509_8h.html#a176">len</a>, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it,
00609                     <span class="keywordtype">int</span> tag, <span class="keywordtype">int</span> aclass, <span class="keywordtype">char</span> opt, <a class="code" href="structASN1__TLC__st.html">ASN1_TLC</a> *ctx);
00610 
<a name="l00611"></a><a class="code" href="asn1t_8h.html#a112">00611</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="asn1t_8h.html#a112">ASN1_ex_i2d</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **out, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it, <span class="keywordtype">int</span> tag, <span class="keywordtype">int</span> aclass);
<a name="l00612"></a><a class="code" href="asn1t_8h.html#a113">00612</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="asn1t_8h.html#a113">ASN1_ex_new_func</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
<a name="l00613"></a><a class="code" href="asn1t_8h.html#a114">00613</a> <span class="keyword">typedef</span> <span class="keywordtype">void</span> <a class="code" href="asn1t_8h.html#a114">ASN1_ex_free_func</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00614 
<a name="l00615"></a><a class="code" href="asn1t_8h.html#a115">00615</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="asn1t_8h.html#a115">ASN1_primitive_i2c</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cont, <span class="keywordtype">int</span> *putype, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
<a name="l00616"></a><a class="code" href="asn1t_8h.html#a116">00616</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="asn1t_8h.html#a116">ASN1_primitive_c2i</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cont, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>, <span class="keywordtype">int</span> utype, <span class="keywordtype">char</span> *free_cont, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00617 
<a name="l00618"></a><a class="code" href="structASN1__COMPAT__FUNCS__st.html">00618</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structASN1__COMPAT__FUNCS__st.html">ASN1_COMPAT_FUNCS_st</a> {
<a name="l00619"></a><a class="code" href="structASN1__COMPAT__FUNCS__st.html#m0">00619</a>     <a class="code" href="asn1t_8h.html#a107">ASN1_new_func</a> *<a class="code" href="structASN1__COMPAT__FUNCS__st.html#m0">asn1_new</a>;
<a name="l00620"></a><a class="code" href="structASN1__COMPAT__FUNCS__st.html#m1">00620</a>     <a class="code" href="asn1t_8h.html#a108">ASN1_free_func</a> *<a class="code" href="structASN1__COMPAT__FUNCS__st.html#m1">asn1_free</a>;
<a name="l00621"></a><a class="code" href="structASN1__COMPAT__FUNCS__st.html#m2">00621</a>     <a class="code" href="asn1t_8h.html#a109">ASN1_d2i_func</a> *<a class="code" href="structASN1__COMPAT__FUNCS__st.html#m2">asn1_d2i</a>;
<a name="l00622"></a><a class="code" href="structASN1__COMPAT__FUNCS__st.html#m3">00622</a>     <a class="code" href="asn1t_8h.html#a110">ASN1_i2d_func</a> *<a class="code" href="structASN1__COMPAT__FUNCS__st.html#m3">asn1_i2d</a>;
00623 } <a class="code" href="structASN1__COMPAT__FUNCS__st.html">ASN1_COMPAT_FUNCS</a>;
00624 
<a name="l00625"></a><a class="code" href="structASN1__EXTERN__FUNCS__st.html">00625</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structASN1__EXTERN__FUNCS__st.html">ASN1_EXTERN_FUNCS_st</a> {
<a name="l00626"></a><a class="code" href="structASN1__EXTERN__FUNCS__st.html#m0">00626</a>     <span class="keywordtype">void</span> *<a class="code" href="structASN1__EXTERN__FUNCS__st.html#m0">app_data</a>;
<a name="l00627"></a><a class="code" href="structASN1__EXTERN__FUNCS__st.html#m1">00627</a>     <a class="code" href="asn1t_8h.html#a113">ASN1_ex_new_func</a> *<a class="code" href="structASN1__EXTERN__FUNCS__st.html#m1">asn1_ex_new</a>;
<a name="l00628"></a><a class="code" href="structASN1__EXTERN__FUNCS__st.html#m2">00628</a>     <a class="code" href="asn1t_8h.html#a114">ASN1_ex_free_func</a> *<a class="code" href="structASN1__EXTERN__FUNCS__st.html#m2">asn1_ex_free</a>;
<a name="l00629"></a><a class="code" href="structASN1__EXTERN__FUNCS__st.html#m3">00629</a>     <a class="code" href="asn1t_8h.html#a114">ASN1_ex_free_func</a> *<a class="code" href="structASN1__EXTERN__FUNCS__st.html#m3">asn1_ex_clear</a>;
<a name="l00630"></a><a class="code" href="structASN1__EXTERN__FUNCS__st.html#m4">00630</a>     <a class="code" href="asn1t_8h.html#a111">ASN1_ex_d2i</a> *<a class="code" href="structASN1__EXTERN__FUNCS__st.html#m4">asn1_ex_d2i</a>;
<a name="l00631"></a><a class="code" href="structASN1__EXTERN__FUNCS__st.html#m5">00631</a>     <a class="code" href="asn1t_8h.html#a112">ASN1_ex_i2d</a> *<a class="code" href="structASN1__EXTERN__FUNCS__st.html#m5">asn1_ex_i2d</a>;
00632 } <a class="code" href="structASN1__EXTERN__FUNCS__st.html">ASN1_EXTERN_FUNCS</a>;
00633 
<a name="l00634"></a><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html">00634</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html">ASN1_PRIMITIVE_FUNCS_st</a> {
<a name="l00635"></a><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m0">00635</a>     <span class="keywordtype">void</span> *<a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m0">app_data</a>;
<a name="l00636"></a><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m1">00636</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m1">flags</a>;
<a name="l00637"></a><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m2">00637</a>     <a class="code" href="asn1t_8h.html#a113">ASN1_ex_new_func</a> *<a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m2">prim_new</a>;
<a name="l00638"></a><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m3">00638</a>     <a class="code" href="asn1t_8h.html#a114">ASN1_ex_free_func</a> *<a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m3">prim_free</a>;
<a name="l00639"></a><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m4">00639</a>     <a class="code" href="asn1t_8h.html#a114">ASN1_ex_free_func</a> *<a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m4">prim_clear</a>;
<a name="l00640"></a><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m5">00640</a>     <a class="code" href="asn1t_8h.html#a116">ASN1_primitive_c2i</a> *<a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m5">prim_c2i</a>;
<a name="l00641"></a><a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m6">00641</a>     <a class="code" href="asn1t_8h.html#a115">ASN1_primitive_i2c</a> *<a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html#m6">prim_i2c</a>;
00642 } <a class="code" href="structASN1__PRIMITIVE__FUNCS__st.html">ASN1_PRIMITIVE_FUNCS</a>;
00643 
00644 <span class="comment">/* This is the ASN1_AUX structure: it handles various</span>
00645 <span class="comment"> * miscellaneous requirements. For example the use of</span>
00646 <span class="comment"> * reference counts and an informational callback.</span>
00647 <span class="comment"> *</span>
00648 <span class="comment"> * The "informational callback" is called at various</span>
00649 <span class="comment"> * points during the ASN1 encoding and decoding. It can</span>
00650 <span class="comment"> * be used to provide minor customisation of the structures</span>
00651 <span class="comment"> * used. This is most useful where the supplied routines</span>
00652 <span class="comment"> * *almost* do the right thing but need some extra help</span>
00653 <span class="comment"> * at a few points. If the callback returns zero then</span>
00654 <span class="comment"> * it is assumed a fatal error has occurred and the </span>
00655 <span class="comment"> * main operation should be abandoned.</span>
00656 <span class="comment"> *</span>
00657 <span class="comment"> * If major changes in the default behaviour are required</span>
00658 <span class="comment"> * then an external type is more appropriate.</span>
00659 <span class="comment"> */</span>
00660 
<a name="l00661"></a><a class="code" href="asn1t_8h.html#a120">00661</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="asn1t_8h.html#a120">ASN1_aux_cb</a>(<span class="keywordtype">int</span> operation, <a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **in, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00662 
<a name="l00663"></a><a class="code" href="structASN1__AUX__st.html">00663</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structASN1__AUX__st.html">ASN1_AUX_st</a> {
<a name="l00664"></a><a class="code" href="structASN1__AUX__st.html#m0">00664</a>     <span class="keywordtype">void</span> *<a class="code" href="structASN1__AUX__st.html#m0">app_data</a>;
<a name="l00665"></a><a class="code" href="structASN1__AUX__st.html#m1">00665</a>     <span class="keywordtype">int</span> <a class="code" href="structASN1__AUX__st.html#m1">flags</a>;
<a name="l00666"></a><a class="code" href="structASN1__AUX__st.html#m2">00666</a>     <span class="keywordtype">int</span> <a class="code" href="structASN1__AUX__st.html#m2">ref_offset</a>;     <span class="comment">/* Offset of reference value */</span>
<a name="l00667"></a><a class="code" href="structASN1__AUX__st.html#m3">00667</a>     <span class="keywordtype">int</span> <a class="code" href="structASN1__AUX__st.html#m3">ref_lock</a>;       <span class="comment">/* Lock type to use */</span>
<a name="l00668"></a><a class="code" href="structASN1__AUX__st.html#m4">00668</a>     <a class="code" href="asn1t_8h.html#a120">ASN1_aux_cb</a> *<a class="code" href="structASN1__AUX__st.html#m4">asn1_cb</a>;
<a name="l00669"></a><a class="code" href="structASN1__AUX__st.html#m5">00669</a>     <span class="keywordtype">int</span> <a class="code" href="structASN1__AUX__st.html#m5">enc_offset</a>;     <span class="comment">/* Offset of ASN1_ENCODING structure */</span>
00670 } <a class="code" href="structASN1__AUX__st.html">ASN1_AUX</a>;
00671 
00672 <span class="comment">/* Flags in ASN1_AUX */</span>
00673 
00674 <span class="comment">/* Use a reference count */</span>
<a name="l00675"></a><a class="code" href="asn1t_8h.html#a78">00675</a> <span class="preprocessor">#define ASN1_AFLG_REFCOUNT  1</span>
00676 <span class="preprocessor"></span><span class="comment">/* Save the encoding of structure (useful for signatures) */</span>
<a name="l00677"></a><a class="code" href="asn1t_8h.html#a79">00677</a> <span class="preprocessor">#define ASN1_AFLG_ENCODING  2</span>
00678 <span class="preprocessor"></span><span class="comment">/* The Sequence length is invalid */</span>
<a name="l00679"></a><a class="code" href="asn1t_8h.html#a80">00679</a> <span class="preprocessor">#define ASN1_AFLG_BROKEN    4</span>
00680 <span class="preprocessor"></span>
00681 <span class="comment">/* operation values for asn1_cb */</span>
00682 
<a name="l00683"></a><a class="code" href="asn1t_8h.html#a81">00683</a> <span class="preprocessor">#define ASN1_OP_NEW_PRE     0</span>
<a name="l00684"></a><a class="code" href="asn1t_8h.html#a82">00684</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OP_NEW_POST    1</span>
<a name="l00685"></a><a class="code" href="asn1t_8h.html#a83">00685</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OP_FREE_PRE    2</span>
<a name="l00686"></a><a class="code" href="asn1t_8h.html#a84">00686</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OP_FREE_POST   3</span>
<a name="l00687"></a><a class="code" href="asn1t_8h.html#a85">00687</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OP_D2I_PRE     4</span>
<a name="l00688"></a><a class="code" href="asn1t_8h.html#a86">00688</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OP_D2I_POST    5</span>
<a name="l00689"></a><a class="code" href="asn1t_8h.html#a87">00689</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OP_I2D_PRE     6</span>
<a name="l00690"></a><a class="code" href="asn1t_8h.html#a88">00690</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OP_I2D_POST    7</span>
00691 <span class="preprocessor"></span>
00692 <span class="comment">/* Macro to implement a primitive type */</span>
<a name="l00693"></a><a class="code" href="asn1t_8h.html#a89">00693</a> <span class="preprocessor">#define IMPLEMENT_ASN1_TYPE(stname) IMPLEMENT_ASN1_TYPE_ex(stname, stname, 0)</span>
<a name="l00694"></a><a class="code" href="asn1t_8h.html#a90">00694</a> <span class="preprocessor"></span><span class="preprocessor">#define IMPLEMENT_ASN1_TYPE_ex(itname, vname, ex) \</span>
00695 <span class="preprocessor">                ASN1_ITEM_start(itname) \</span>
00696 <span class="preprocessor">                    ASN1_ITYPE_PRIMITIVE, V_##vname, NULL, 0, NULL, ex, #itname \</span>
00697 <span class="preprocessor">                ASN1_ITEM_end(itname)</span>
00698 <span class="preprocessor"></span>
00699 <span class="comment">/* Macro to implement a multi string type */</span>
<a name="l00700"></a><a class="code" href="asn1t_8h.html#a91">00700</a> <span class="preprocessor">#define IMPLEMENT_ASN1_MSTRING(itname, mask) \</span>
00701 <span class="preprocessor">                ASN1_ITEM_start(itname) \</span>
00702 <span class="preprocessor">                    ASN1_ITYPE_MSTRING, mask, NULL, 0, NULL, sizeof(ASN1_STRING), #itname \</span>
00703 <span class="preprocessor">                ASN1_ITEM_end(itname)</span>
00704 <span class="preprocessor"></span>
00705 <span class="comment">/* Macro to implement an ASN1_ITEM in terms of old style funcs */</span>
00706 
<a name="l00707"></a><a class="code" href="asn1t_8h.html#a92">00707</a> <span class="preprocessor">#define IMPLEMENT_COMPAT_ASN1(sname) IMPLEMENT_COMPAT_ASN1_type(sname, V_ASN1_SEQUENCE)</span>
00708 <span class="preprocessor"></span>
<a name="l00709"></a><a class="code" href="asn1t_8h.html#a93">00709</a> <span class="preprocessor">#define IMPLEMENT_COMPAT_ASN1_type(sname, tag) \</span>
00710 <span class="preprocessor">    static const ASN1_COMPAT_FUNCS sname##_ff = { \</span>
00711 <span class="preprocessor">        (ASN1_new_func *)sname##_new, \</span>
00712 <span class="preprocessor">        (ASN1_free_func *)sname##_free, \</span>
00713 <span class="preprocessor">        (ASN1_d2i_func *)d2i_##sname, \</span>
00714 <span class="preprocessor">        (ASN1_i2d_func *)i2d_##sname, \</span>
00715 <span class="preprocessor">    }; \</span>
00716 <span class="preprocessor">    ASN1_ITEM_start(sname) \</span>
00717 <span class="preprocessor">        ASN1_ITYPE_COMPAT, \</span>
00718 <span class="preprocessor">        tag, \</span>
00719 <span class="preprocessor">        NULL, \</span>
00720 <span class="preprocessor">        0, \</span>
00721 <span class="preprocessor">        &amp;sname##_ff, \</span>
00722 <span class="preprocessor">        0, \</span>
00723 <span class="preprocessor">        #sname \</span>
00724 <span class="preprocessor">    ASN1_ITEM_end(sname)</span>
00725 <span class="preprocessor"></span>
<a name="l00726"></a><a class="code" href="asn1t_8h.html#a94">00726</a> <span class="preprocessor">#define IMPLEMENT_EXTERN_ASN1(sname, tag, fptrs) \</span>
00727 <span class="preprocessor">    ASN1_ITEM_start(sname) \</span>
00728 <span class="preprocessor">        ASN1_ITYPE_EXTERN, \</span>
00729 <span class="preprocessor">        tag, \</span>
00730 <span class="preprocessor">        NULL, \</span>
00731 <span class="preprocessor">        0, \</span>
00732 <span class="preprocessor">        &amp;fptrs, \</span>
00733 <span class="preprocessor">        0, \</span>
00734 <span class="preprocessor">        #sname \</span>
00735 <span class="preprocessor">    ASN1_ITEM_end(sname)</span>
00736 <span class="preprocessor"></span>
00737 <span class="comment">/* Macro to implement standard functions in terms of ASN1_ITEM structures */</span>
00738 
<a name="l00739"></a><a class="code" href="asn1t_8h.html#a95">00739</a> <span class="preprocessor">#define IMPLEMENT_ASN1_FUNCTIONS(stname) IMPLEMENT_ASN1_FUNCTIONS_fname(stname, stname, stname)</span>
00740 <span class="preprocessor"></span>
<a name="l00741"></a><a class="code" href="asn1t_8h.html#a96">00741</a> <span class="preprocessor">#define IMPLEMENT_ASN1_FUNCTIONS_name(stname, itname) IMPLEMENT_ASN1_FUNCTIONS_fname(stname, itname, itname)</span>
00742 <span class="preprocessor"></span>
<a name="l00743"></a><a class="code" href="asn1t_8h.html#a97">00743</a> <span class="preprocessor">#define IMPLEMENT_ASN1_FUNCTIONS_ENCODE_name(stname, itname) \</span>
00744 <span class="preprocessor">            IMPLEMENT_ASN1_FUNCTIONS_ENCODE_fname(stname, itname, itname)</span>
00745 <span class="preprocessor"></span>
<a name="l00746"></a><a class="code" href="asn1t_8h.html#a98">00746</a> <span class="preprocessor">#define IMPLEMENT_ASN1_ALLOC_FUNCTIONS_fname(stname, itname, fname) \</span>
00747 <span class="preprocessor">    stname *fname##_new(void) \</span>
00748 <span class="preprocessor">    { \</span>
00749 <span class="preprocessor">        return (stname *)ASN1_item_new(ASN1_ITEM_rptr(itname)); \</span>
00750 <span class="preprocessor">    } \</span>
00751 <span class="preprocessor">    void fname##_free(stname *a) \</span>
00752 <span class="preprocessor">    { \</span>
00753 <span class="preprocessor">        ASN1_item_free((ASN1_VALUE *)a, ASN1_ITEM_rptr(itname)); \</span>
00754 <span class="preprocessor">    }</span>
00755 <span class="preprocessor"></span>
<a name="l00756"></a><a class="code" href="asn1t_8h.html#a99">00756</a> <span class="preprocessor">#define IMPLEMENT_ASN1_FUNCTIONS_fname(stname, itname, fname) \</span>
00757 <span class="preprocessor">    IMPLEMENT_ASN1_ENCODE_FUNCTIONS_fname(stname, itname, fname) \</span>
00758 <span class="preprocessor">    IMPLEMENT_ASN1_ALLOC_FUNCTIONS_fname(stname, itname, fname)</span>
00759 <span class="preprocessor"></span>
<a name="l00760"></a><a class="code" href="asn1t_8h.html#a100">00760</a> <span class="preprocessor">#define IMPLEMENT_ASN1_ENCODE_FUNCTIONS_fname(stname, itname, fname) \</span>
00761 <span class="preprocessor">    stname *d2i_##fname(stname **a, unsigned char **in, long len) \</span>
00762 <span class="preprocessor">    { \</span>
00763 <span class="preprocessor">        return (stname *)ASN1_item_d2i((ASN1_VALUE **)a, in, len, ASN1_ITEM_rptr(itname));\</span>
00764 <span class="preprocessor">    } \</span>
00765 <span class="preprocessor">    int i2d_##fname(stname *a, unsigned char **out) \</span>
00766 <span class="preprocessor">    { \</span>
00767 <span class="preprocessor">        return ASN1_item_i2d((ASN1_VALUE *)a, out, ASN1_ITEM_rptr(itname));\</span>
00768 <span class="preprocessor">    } </span>
00769 <span class="preprocessor"></span>
00770 <span class="comment">/* This includes evil casts to remove const: they will go away when full</span>
00771 <span class="comment"> * ASN1 constification is done.</span>
00772 <span class="comment"> */</span>
<a name="l00773"></a><a class="code" href="asn1t_8h.html#a101">00773</a> <span class="preprocessor">#define IMPLEMENT_ASN1_ENCODE_FUNCTIONS_const_fname(stname, itname, fname) \</span>
00774 <span class="preprocessor">    stname *d2i_##fname(stname **a, const unsigned char **in, long len) \</span>
00775 <span class="preprocessor">    { \</span>
00776 <span class="preprocessor">        return (stname *)ASN1_item_d2i((ASN1_VALUE **)a, (unsigned char **)in, len, ASN1_ITEM_rptr(itname));\</span>
00777 <span class="preprocessor">    } \</span>
00778 <span class="preprocessor">    int i2d_##fname(const stname *a, unsigned char **out) \</span>
00779 <span class="preprocessor">    { \</span>
00780 <span class="preprocessor">        return ASN1_item_i2d((ASN1_VALUE *)a, out, ASN1_ITEM_rptr(itname));\</span>
00781 <span class="preprocessor">    } </span>
00782 <span class="preprocessor"></span>
<a name="l00783"></a><a class="code" href="asn1t_8h.html#a102">00783</a> <span class="preprocessor">#define IMPLEMENT_ASN1_DUP_FUNCTION(stname) \</span>
00784 <span class="preprocessor">    stname * stname##_dup(stname *x) \</span>
00785 <span class="preprocessor">        { \</span>
00786 <span class="preprocessor">        return ASN1_item_dup(ASN1_ITEM_rptr(stname), x); \</span>
00787 <span class="preprocessor">        }</span>
00788 <span class="preprocessor"></span>
<a name="l00789"></a><a class="code" href="asn1t_8h.html#a103">00789</a> <span class="preprocessor">#define IMPLEMENT_ASN1_FUNCTIONS_const(name) \</span>
00790 <span class="preprocessor">        IMPLEMENT_ASN1_FUNCTIONS_const_fname(name, name, name)</span>
00791 <span class="preprocessor"></span>
<a name="l00792"></a><a class="code" href="asn1t_8h.html#a104">00792</a> <span class="preprocessor">#define IMPLEMENT_ASN1_FUNCTIONS_const_fname(stname, itname, fname) \</span>
00793 <span class="preprocessor">    IMPLEMENT_ASN1_ENCODE_FUNCTIONS_const_fname(stname, itname, fname) \</span>
00794 <span class="preprocessor">    IMPLEMENT_ASN1_ALLOC_FUNCTIONS_fname(stname, itname, fname)</span>
00795 <span class="preprocessor"></span>
00796 <span class="comment">/* external definitions for primitive types */</span>
00797 
00798 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(ASN1_BOOLEAN)
00799 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(ASN1_TBOOLEAN)
00800 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(ASN1_FBOOLEAN)
00801 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(ASN1_ANY)
00802 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(<a class="code" href="asn1t_8h.html#a5">ASN1_SEQUENCE</a>)
00803 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(CBIGNUM)
00804 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(<a class="code" href="structbignum__st.html">BIGNUM</a>)
00805 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(LONG)
00806 <a class="code" href="asn1_8h.html#a94">DECLARE_ASN1_ITEM</a>(ZLONG)
00807 
00808 <a class="code" href="safestack_8h.html#a2">DECLARE_STACK_OF</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a>)
00809 
00810 <span class="comment">/* Functions used internally by the ASN1 code */</span>
00811 
00812 <span class="keywordtype">int</span> <a class="code" href="tasn__new_8c.html#a5">ASN1_item_ex_new</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00813 <span class="keywordtype">void</span> <a class="code" href="tasn__fre_8c.html#a2">ASN1_item_ex_free</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00814 <span class="keywordtype">int</span> <a class="code" href="tasn__new_8c.html#a6">ASN1_template_new</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *tt);
00815 <span class="keywordtype">int</span> <a class="code" href="tasn__new_8c.html#a7">ASN1_primitive_new</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00816 
00817 <span class="keywordtype">void</span> <a class="code" href="tasn__fre_8c.html#a3">ASN1_template_free</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *tt);
00818 <span class="keywordtype">int</span> <a class="code" href="tasn__dec_8c.html#a11">ASN1_template_d2i</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **in, <span class="keywordtype">long</span> <a class="code" href="x509_8h.html#a176">len</a>, <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *tt);
00819 <span class="keywordtype">int</span> <a class="code" href="tasn__dec_8c.html#a12">ASN1_item_ex_d2i</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **in, <span class="keywordtype">long</span> <a class="code" href="x509_8h.html#a176">len</a>, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it,
00820                 <span class="keywordtype">int</span> tag, <span class="keywordtype">int</span> aclass, <span class="keywordtype">char</span> opt, <a class="code" href="structASN1__TLC__st.html">ASN1_TLC</a> *ctx);
00821 
00822 <span class="keywordtype">int</span> <a class="code" href="tasn__enc_8c.html#a3">ASN1_item_ex_i2d</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **out, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it, <span class="keywordtype">int</span> tag, <span class="keywordtype">int</span> aclass);
00823 <span class="keywordtype">int</span> <a class="code" href="tasn__enc_8c.html#a4">ASN1_template_i2d</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **out, <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *tt);
00824 <span class="keywordtype">void</span> <a class="code" href="tasn__fre_8c.html#a4">ASN1_primitive_free</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00825 
00826 <span class="keywordtype">int</span> <a class="code" href="tasn__enc_8c.html#a6">asn1_ex_i2c</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cont, <span class="keywordtype">int</span> *putype, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00827 <span class="keywordtype">int</span> <a class="code" href="tasn__dec_8c.html#a13">asn1_ex_c2i</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cont, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>, <span class="keywordtype">int</span> utype, <span class="keywordtype">char</span> *free_cont, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00828 
00829 <span class="keywordtype">int</span> <a class="code" href="tasn__utl_8c.html#a1">asn1_get_choice_selector</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00830 <span class="keywordtype">int</span> <a class="code" href="tasn__utl_8c.html#a2">asn1_set_choice_selector</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">int</span> <a class="code" href="v3__cpols_8c.html#a1">value</a>, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00831 
00832 <a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> ** <a class="code" href="tasn__utl_8c.html#a9">asn1_get_field_ptr</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *tt);
00833 
00834 <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *<a class="code" href="tasn__utl_8c.html#a10">asn1_do_adb</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__TEMPLATE__st.html">ASN1_TEMPLATE</a> *tt, <span class="keywordtype">int</span> nullerr);
00835 
00836 <span class="keywordtype">int</span> <a class="code" href="tasn__utl_8c.html#a3">asn1_do_lock</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">int</span> op, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00837 
00838 <span class="keywordtype">void</span> <a class="code" href="tasn__utl_8c.html#a5">asn1_enc_init</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00839 <span class="keywordtype">void</span> <a class="code" href="tasn__utl_8c.html#a6">asn1_enc_free</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00840 <span class="keywordtype">int</span> <a class="code" href="tasn__utl_8c.html#a8">asn1_enc_restore</a>(<span class="keywordtype">int</span> *<a class="code" href="x509_8h.html#a176">len</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **out, <a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00841 <span class="keywordtype">int</span> <a class="code" href="tasn__utl_8c.html#a7">asn1_enc_save</a>(<a class="code" href="asn1_8h.html#a351">ASN1_VALUE</a> **pval, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *in, <span class="keywordtype">int</span> inlen, <span class="keyword">const</span> <a class="code" href="structASN1__ITEM__st.html">ASN1_ITEM</a> *it);
00842 
00843 <span class="preprocessor">#ifdef  __cplusplus</span>
00844 <span class="preprocessor"></span>}
00845 <span class="preprocessor">#endif</span>
00846 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Mon Aug 14 19:59:35 2006 for Octeon Core Crypto API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
