<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ocsp.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>ocsp.h</h1><a href="include_2openssl_2ocsp_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* ocsp.h */</span>
00002 <span class="comment">/* Written by Tom Titchener &lt;Tom_Titchener@groove.net&gt; for the OpenSSL</span>
00003 <span class="comment"> * project. */</span>
00004 
00005 <span class="comment">/* History:</span>
00006 <span class="comment">   This file was transfered to Richard Levitte from CertCo by Kathy</span>
00007 <span class="comment">   Weinhold in mid-spring 2000 to be included in OpenSSL or released</span>
00008 <span class="comment">   as a patch kit. */</span>
00009 
00010 <span class="comment">/* ====================================================================</span>
00011 <span class="comment"> * Copyright (c) 1998-2000 The OpenSSL Project.  All rights reserved.</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
00014 <span class="comment"> * modification, are permitted provided that the following conditions</span>
00015 <span class="comment"> * are met:</span>
00016 <span class="comment"> *</span>
00017 <span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
00018 <span class="comment"> *    notice, this list of conditions and the following disclaimer. </span>
00019 <span class="comment"> *</span>
00020 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
00021 <span class="comment"> *    notice, this list of conditions and the following disclaimer in</span>
00022 <span class="comment"> *    the documentation and/or other materials provided with the</span>
00023 <span class="comment"> *    distribution.</span>
00024 <span class="comment"> *</span>
00025 <span class="comment"> * 3. All advertising materials mentioning features or use of this</span>
00026 <span class="comment"> *    software must display the following acknowledgment:</span>
00027 <span class="comment"> *    "This product includes software developed by the OpenSSL Project</span>
00028 <span class="comment"> *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)"</span>
00029 <span class="comment"> *</span>
00030 <span class="comment"> * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to</span>
00031 <span class="comment"> *    endorse or promote products derived from this software without</span>
00032 <span class="comment"> *    prior written permission. For written permission, please contact</span>
00033 <span class="comment"> *    openssl-core@openssl.org.</span>
00034 <span class="comment"> *</span>
00035 <span class="comment"> * 5. Products derived from this software may not be called "OpenSSL"</span>
00036 <span class="comment"> *    nor may "OpenSSL" appear in their names without prior written</span>
00037 <span class="comment"> *    permission of the OpenSSL Project.</span>
00038 <span class="comment"> *</span>
00039 <span class="comment"> * 6. Redistributions of any form whatsoever must retain the following</span>
00040 <span class="comment"> *    acknowledgment:</span>
00041 <span class="comment"> *    "This product includes software developed by the OpenSSL Project</span>
00042 <span class="comment"> *    for use in the OpenSSL Toolkit (http://www.openssl.org/)"</span>
00043 <span class="comment"> *</span>
00044 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY</span>
00045 <span class="comment"> * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00046 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR</span>
00047 <span class="comment"> * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR</span>
00048 <span class="comment"> * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
00049 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</span>
00050 <span class="comment"> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
00051 <span class="comment"> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
00052 <span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span>
00053 <span class="comment"> * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
00054 <span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED</span>
00055 <span class="comment"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00056 <span class="comment"> * ====================================================================</span>
00057 <span class="comment"> *</span>
00058 <span class="comment"> * This product includes cryptographic software written by Eric Young</span>
00059 <span class="comment"> * (eay@cryptsoft.com).  This product includes software written by Tim</span>
00060 <span class="comment"> * Hudson (tjh@cryptsoft.com).</span>
00061 <span class="comment"> *</span>
00062 <span class="comment"> */</span>
00063 
00064 <span class="preprocessor">#ifndef HEADER_OCSP_H</span>
00065 <span class="preprocessor"></span><span class="preprocessor">#define HEADER_OCSP_H</span>
00066 <span class="preprocessor"></span>
00067 <span class="preprocessor">#include &lt;<a class="code" href="x509_8h.html">openssl/x509.h</a>&gt;</span>
00068 <span class="preprocessor">#include &lt;<a class="code" href="include_2openssl_2x509v3_8h.html">openssl/x509v3.h</a>&gt;</span>
00069 <span class="preprocessor">#include &lt;<a class="code" href="safestack_8h.html">openssl/safestack.h</a>&gt;</span>
00070 
00071 <span class="preprocessor">#ifdef  __cplusplus</span>
00072 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00073 <span class="preprocessor">#endif</span>
00074 <span class="preprocessor"></span>
00075 <span class="comment">/* Various flags and values */</span>
00076 
<a name="l00077"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a0">00077</a> <span class="preprocessor">#define OCSP_DEFAULT_NONCE_LENGTH   16</span>
00078 <span class="preprocessor"></span>
<a name="l00079"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a1">00079</a> <span class="preprocessor">#define OCSP_NOCERTS            0x1</span>
<a name="l00080"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a2">00080</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NOINTERN           0x2</span>
<a name="l00081"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a3">00081</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NOSIGS         0x4</span>
<a name="l00082"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a4">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NOCHAIN            0x8</span>
<a name="l00083"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a5">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NOVERIFY           0x10</span>
<a name="l00084"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a6">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NOEXPLICIT         0x20</span>
<a name="l00085"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a7">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NOCASIGN           0x40</span>
<a name="l00086"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a8">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NODELEGATED        0x80</span>
<a name="l00087"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a9">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NOCHECKS           0x100</span>
<a name="l00088"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a10">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_TRUSTOTHER         0x200</span>
<a name="l00089"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a11">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_RESPID_KEY         0x400</span>
<a name="l00090"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a12">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_NOTIME         0x800</span>
00091 <span class="preprocessor"></span>
00092 <span class="comment">/*   CertID ::= SEQUENCE {</span>
00093 <span class="comment"> *       hashAlgorithm            AlgorithmIdentifier,</span>
00094 <span class="comment"> *       issuerNameHash     OCTET STRING, -- Hash of Issuer's DN</span>
00095 <span class="comment"> *       issuerKeyHash      OCTET STRING, -- Hash of Issuers public key (excluding the tag &amp; length fields)</span>
00096 <span class="comment"> *       serialNumber       CertificateSerialNumber }</span>
00097 <span class="comment"> */</span>
00098 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__cert__id__st.html">ocsp_cert_id_st</a>
00099     {
<a name="l00100"></a><a class="code" href="structocsp__cert__id__st.html#m4">00100</a>     <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *<a class="code" href="structocsp__cert__id__st.html#m0">hashAlgorithm</a>;
<a name="l00101"></a><a class="code" href="structocsp__cert__id__st.html#m5">00101</a>     <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> *<a class="code" href="structocsp__cert__id__st.html#m1">issuerNameHash</a>;
<a name="l00102"></a><a class="code" href="structocsp__cert__id__st.html#m6">00102</a>     <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> *<a class="code" href="structocsp__cert__id__st.html#m2">issuerKeyHash</a>;
<a name="l00103"></a><a class="code" href="structocsp__cert__id__st.html#m7">00103</a>     <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *<a class="code" href="structocsp__cert__id__st.html#m3">serialNumber</a>;
00104     } <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a>;
00105 
00106 <a class="code" href="safestack_8h.html#a2">DECLARE_STACK_OF</a>(<a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a>)
00107 
00108 <span class="comment">/*   Request ::=     SEQUENCE {</span>
00109 <span class="comment"> *       reqCert                    CertID,</span>
00110 <span class="comment"> *       singleRequestExtensions    [0] EXPLICIT Extensions OPTIONAL }</span>
00111 <span class="comment"> */</span>
00112 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__one__request__st.html">ocsp_one_request_st</a>
00113     {
<a name="l00114"></a><a class="code" href="structocsp__one__request__st.html#m1">00114</a>     <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *<a class="code" href="structocsp__one__request__st.html#m0">reqCert</a>;
00115     <a class="code" href="structocsp__one__request__st.html#a0">STACK_OF</a>(<a class="code" href="structX509__extension__st.html">X509_EXTENSION</a>) *singleRequestExtensions;
00116     } <a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a>;
00117 
00118 <a class="code" href="safestack_8h.html#a2">DECLARE_STACK_OF</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a>)
00119 <a class="code" href="asn1_8h.html#a65">DECLARE_ASN1_SET_OF</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a>)
00120 
00121 
00122 <span class="comment">/*   TBSRequest      ::=     SEQUENCE {</span>
00123 <span class="comment"> *       version             [0] EXPLICIT Version DEFAULT v1,</span>
00124 <span class="comment"> *       requestorName       [1] EXPLICIT GeneralName OPTIONAL,</span>
00125 <span class="comment"> *       requestList             SEQUENCE OF Request,</span>
00126 <span class="comment"> *       requestExtensions   [2] EXPLICIT Extensions OPTIONAL }</span>
00127 <span class="comment"> */</span>
00128 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__req__info__st.html">ocsp_req_info_st</a>
00129     {
<a name="l00130"></a><a class="code" href="structocsp__req__info__st.html#m2">00130</a>     <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *<a class="code" href="structocsp__req__info__st.html#m0">version</a>;
<a name="l00131"></a><a class="code" href="structocsp__req__info__st.html#m3">00131</a>     <a class="code" href="structGENERAL__NAME__st.html">GENERAL_NAME</a> *<a class="code" href="structocsp__req__info__st.html#m1">requestorName</a>;
00132     <a class="code" href="structocsp__req__info__st.html#a0">STACK_OF</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a>) *requestList;
00133     <a class="code" href="structocsp__req__info__st.html#a0">STACK_OF</a>(<a class="code" href="structX509__extension__st.html">X509_EXTENSION</a>) *requestExtensions;
00134     } <a class="code" href="structocsp__req__info__st.html">OCSP_REQINFO</a>;
00135 
00136 <span class="comment">/*   Signature       ::=     SEQUENCE {</span>
00137 <span class="comment"> *       signatureAlgorithm   AlgorithmIdentifier,</span>
00138 <span class="comment"> *       signature            BIT STRING,</span>
00139 <span class="comment"> *       certs                [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }</span>
00140 <span class="comment"> */</span>
00141 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__signature__st.html">ocsp_signature_st</a>
00142     {
<a name="l00143"></a><a class="code" href="structocsp__signature__st.html#m2">00143</a>     <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *<a class="code" href="structocsp__signature__st.html#m0">signatureAlgorithm</a>;
<a name="l00144"></a><a class="code" href="structocsp__signature__st.html#m3">00144</a>     <a class="code" href="structasn1__string__st.html">ASN1_BIT_STRING</a> *<a class="code" href="structocsp__signature__st.html#m1">signature</a>;
00145     <a class="code" href="structocsp__signature__st.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *certs;
00146     } <a class="code" href="structocsp__signature__st.html">OCSP_SIGNATURE</a>;
00147 
00148 <span class="comment">/*   OCSPRequest     ::=     SEQUENCE {</span>
00149 <span class="comment"> *       tbsRequest                  TBSRequest,</span>
00150 <span class="comment"> *       optionalSignature   [0]     EXPLICIT Signature OPTIONAL }</span>
00151 <span class="comment"> */</span>
00152 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__request__st.html">ocsp_request_st</a>
00153     {
<a name="l00154"></a><a class="code" href="structocsp__request__st.html#m2">00154</a>     <a class="code" href="structocsp__req__info__st.html">OCSP_REQINFO</a> *<a class="code" href="structocsp__request__st.html#m0">tbsRequest</a>;
<a name="l00155"></a><a class="code" href="structocsp__request__st.html#m3">00155</a>     <a class="code" href="structocsp__signature__st.html">OCSP_SIGNATURE</a> *<a class="code" href="structocsp__request__st.html#m1">optionalSignature</a>; <span class="comment">/* OPTIONAL */</span>
00156     } <a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a>;
00157 
00158 <span class="comment">/*   OCSPResponseStatus ::= ENUMERATED {</span>
00159 <span class="comment"> *       successful            (0),      --Response has valid confirmations</span>
00160 <span class="comment"> *       malformedRequest      (1),      --Illegal confirmation request</span>
00161 <span class="comment"> *       internalError         (2),      --Internal error in issuer</span>
00162 <span class="comment"> *       tryLater              (3),      --Try again later</span>
00163 <span class="comment"> *                                       --(4) is not used</span>
00164 <span class="comment"> *       sigRequired           (5),      --Must sign the request</span>
00165 <span class="comment"> *       unauthorized          (6)       --Request unauthorized</span>
00166 <span class="comment"> *   }</span>
00167 <span class="comment"> */</span>
<a name="l00168"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a13">00168</a> <span class="preprocessor">#define OCSP_RESPONSE_STATUS_SUCCESSFUL          0</span>
<a name="l00169"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a14">00169</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_RESPONSE_STATUS_MALFORMEDREQUEST     1</span>
<a name="l00170"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a15">00170</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_RESPONSE_STATUS_INTERNALERROR        2</span>
<a name="l00171"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a16">00171</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_RESPONSE_STATUS_TRYLATER             3</span>
<a name="l00172"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a17">00172</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_RESPONSE_STATUS_SIGREQUIRED          5</span>
<a name="l00173"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a18">00173</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_RESPONSE_STATUS_UNAUTHORIZED         6</span>
00174 <span class="preprocessor"></span>
00175 <span class="comment">/*   ResponseBytes ::=       SEQUENCE {</span>
00176 <span class="comment"> *       responseType   OBJECT IDENTIFIER,</span>
00177 <span class="comment"> *       response       OCTET STRING }</span>
00178 <span class="comment"> */</span>
00179 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__resp__bytes__st.html">ocsp_resp_bytes_st</a>
00180     {
<a name="l00181"></a><a class="code" href="structocsp__resp__bytes__st.html#m2">00181</a>     <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *<a class="code" href="structocsp__resp__bytes__st.html#m0">responseType</a>;
<a name="l00182"></a><a class="code" href="structocsp__resp__bytes__st.html#m3">00182</a>     <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> *<a class="code" href="structocsp__resp__bytes__st.html#m1">response</a>;
00183     } <a class="code" href="structocsp__resp__bytes__st.html">OCSP_RESPBYTES</a>;
00184 
00185 <span class="comment">/*   OCSPResponse ::= SEQUENCE {</span>
00186 <span class="comment"> *      responseStatus         OCSPResponseStatus,</span>
00187 <span class="comment"> *      responseBytes          [0] EXPLICIT ResponseBytes OPTIONAL }</span>
00188 <span class="comment"> */</span>
00189 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__response__st.html">ocsp_response_st</a>
00190     {
<a name="l00191"></a><a class="code" href="structocsp__response__st.html#m2">00191</a>     <a class="code" href="structasn1__string__st.html">ASN1_ENUMERATED</a> *<a class="code" href="structocsp__response__st.html#m0">responseStatus</a>;
<a name="l00192"></a><a class="code" href="structocsp__response__st.html#m3">00192</a>     <a class="code" href="structocsp__resp__bytes__st.html">OCSP_RESPBYTES</a>  *<a class="code" href="structocsp__response__st.html#m1">responseBytes</a>;
00193     } <a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a>;
00194 
00195 <span class="comment">/*   ResponderID ::= CHOICE {</span>
00196 <span class="comment"> *      byName   [1] Name,</span>
00197 <span class="comment"> *      byKey    [2] KeyHash }</span>
00198 <span class="comment"> */</span>
<a name="l00199"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a19">00199</a> <span class="preprocessor">#define V_OCSP_RESPID_NAME 0</span>
<a name="l00200"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a20">00200</a> <span class="preprocessor"></span><span class="preprocessor">#define V_OCSP_RESPID_KEY  1</span>
00201 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__responder__id__st.html">ocsp_responder_id_st</a>
00202     {
<a name="l00203"></a><a class="code" href="structocsp__responder__id__st.html#m0">00203</a>     <span class="keywordtype">int</span> <a class="code" href="structocsp__responder__id__st.html#m0">type</a>;
00204     <span class="keyword">union   </span>{
<a name="l00205"></a><a class="code" href="structocsp__responder__id__st.html#m4">00205</a>         <a class="code" href="structX509__name__st.html">X509_NAME</a>* <a class="code" href="structocsp__responder__id__st.html#m1">byName</a>;
<a name="l00206"></a><a class="code" href="structocsp__responder__id__st.html#m5">00206</a>             <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> *<a class="code" href="structocsp__responder__id__st.html#m2">byKey</a>;
00207         } <a class="code" href="structocsp__responder__id__st.html#m3">value</a>;
00208     } <a class="code" href="structocsp__responder__id__st.html">OCSP_RESPID</a>;
00209 <span class="comment">/*   KeyHash ::= OCTET STRING --SHA-1 hash of responder's public key</span>
00210 <span class="comment"> *                            --(excluding the tag and length fields)</span>
00211 <span class="comment"> */</span>
00212 
00213 <span class="comment">/*   RevokedInfo ::= SEQUENCE {</span>
00214 <span class="comment"> *       revocationTime              GeneralizedTime,</span>
00215 <span class="comment"> *       revocationReason    [0]     EXPLICIT CRLReason OPTIONAL }</span>
00216 <span class="comment"> */</span>
00217 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__revoked__info__st.html">ocsp_revoked_info_st</a>
00218     {
<a name="l00219"></a><a class="code" href="structocsp__revoked__info__st.html#m2">00219</a>     <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> *<a class="code" href="structocsp__revoked__info__st.html#m0">revocationTime</a>;
<a name="l00220"></a><a class="code" href="structocsp__revoked__info__st.html#m3">00220</a>     <a class="code" href="structasn1__string__st.html">ASN1_ENUMERATED</a> *<a class="code" href="structocsp__revoked__info__st.html#m1">revocationReason</a>;
00221     } <a class="code" href="structocsp__revoked__info__st.html">OCSP_REVOKEDINFO</a>;
00222 
00223 <span class="comment">/*   CertStatus ::= CHOICE {</span>
00224 <span class="comment"> *       good                [0]     IMPLICIT NULL,</span>
00225 <span class="comment"> *       revoked             [1]     IMPLICIT RevokedInfo,</span>
00226 <span class="comment"> *       unknown             [2]     IMPLICIT UnknownInfo }</span>
00227 <span class="comment"> */</span>
<a name="l00228"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a21">00228</a> <span class="preprocessor">#define V_OCSP_CERTSTATUS_GOOD    0</span>
<a name="l00229"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a22">00229</a> <span class="preprocessor"></span><span class="preprocessor">#define V_OCSP_CERTSTATUS_REVOKED 1</span>
<a name="l00230"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a23">00230</a> <span class="preprocessor"></span><span class="preprocessor">#define V_OCSP_CERTSTATUS_UNKNOWN 2</span>
00231 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__cert__status__st.html">ocsp_cert_status_st</a>
00232     {
<a name="l00233"></a><a class="code" href="structocsp__cert__status__st.html#m0">00233</a>     <span class="keywordtype">int</span> <a class="code" href="structocsp__cert__status__st.html#m0">type</a>;
00234     <span class="keyword">union   </span>{
<a name="l00235"></a><a class="code" href="structocsp__cert__status__st.html#m5">00235</a>         ASN1_NULL *<a class="code" href="structocsp__cert__status__st.html#m1">good</a>;
<a name="l00236"></a><a class="code" href="structocsp__cert__status__st.html#m6">00236</a>         <a class="code" href="structocsp__revoked__info__st.html">OCSP_REVOKEDINFO</a> *<a class="code" href="structocsp__cert__status__st.html#m2">revoked</a>;
<a name="l00237"></a><a class="code" href="structocsp__cert__status__st.html#m7">00237</a>         ASN1_NULL *<a class="code" href="structocsp__cert__status__st.html#m3">unknown</a>;
00238         } <a class="code" href="structocsp__cert__status__st.html#m4">value</a>;
00239     } <a class="code" href="structocsp__cert__status__st.html">OCSP_CERTSTATUS</a>;
00240 
00241 <span class="comment">/*   SingleResponse ::= SEQUENCE {</span>
00242 <span class="comment"> *      certID                       CertID,</span>
00243 <span class="comment"> *      certStatus                   CertStatus,</span>
00244 <span class="comment"> *      thisUpdate                   GeneralizedTime,</span>
00245 <span class="comment"> *      nextUpdate           [0]     EXPLICIT GeneralizedTime OPTIONAL,</span>
00246 <span class="comment"> *      singleExtensions     [1]     EXPLICIT Extensions OPTIONAL }</span>
00247 <span class="comment"> */</span>
00248 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__single__response__st.html">ocsp_single_response_st</a>
00249     {
<a name="l00250"></a><a class="code" href="structocsp__single__response__st.html#m4">00250</a>     <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *<a class="code" href="structocsp__single__response__st.html#m0">certId</a>;
<a name="l00251"></a><a class="code" href="structocsp__single__response__st.html#m5">00251</a>     <a class="code" href="structocsp__cert__status__st.html">OCSP_CERTSTATUS</a> *<a class="code" href="structocsp__single__response__st.html#m1">certStatus</a>;
<a name="l00252"></a><a class="code" href="structocsp__single__response__st.html#m6">00252</a>     <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> *<a class="code" href="structocsp__single__response__st.html#m2">thisUpdate</a>;
<a name="l00253"></a><a class="code" href="structocsp__single__response__st.html#m7">00253</a>     <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> *<a class="code" href="structocsp__single__response__st.html#m3">nextUpdate</a>;
00254     <a class="code" href="structocsp__single__response__st.html#a0">STACK_OF</a>(<a class="code" href="structX509__extension__st.html">X509_EXTENSION</a>) *singleExtensions;
00255     } <a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a>;
00256 
00257 <a class="code" href="safestack_8h.html#a2">DECLARE_STACK_OF</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a>)
00258 <a class="code" href="asn1_8h.html#a65">DECLARE_ASN1_SET_OF</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a>)
00259 
00260 <span class="comment">/*   ResponseData ::= SEQUENCE {</span>
00261 <span class="comment"> *      version              [0] EXPLICIT Version DEFAULT v1,</span>
00262 <span class="comment"> *      responderID              ResponderID,</span>
00263 <span class="comment"> *      producedAt               GeneralizedTime,</span>
00264 <span class="comment"> *      responses                SEQUENCE OF SingleResponse,</span>
00265 <span class="comment"> *      responseExtensions   [1] EXPLICIT Extensions OPTIONAL }</span>
00266 <span class="comment"> */</span>
00267 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__response__data__st.html">ocsp_response_data_st</a>
00268     {
<a name="l00269"></a><a class="code" href="structocsp__response__data__st.html#m3">00269</a>     <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *<a class="code" href="structocsp__response__data__st.html#m0">version</a>;
<a name="l00270"></a><a class="code" href="structocsp__response__data__st.html#m4">00270</a>     <a class="code" href="structocsp__responder__id__st.html">OCSP_RESPID</a>  *<a class="code" href="structocsp__response__data__st.html#m1">responderId</a>;
<a name="l00271"></a><a class="code" href="structocsp__response__data__st.html#m5">00271</a>     <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> *<a class="code" href="structocsp__response__data__st.html#m2">producedAt</a>;
00272     <a class="code" href="structocsp__response__data__st.html#a0">STACK_OF</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a>) *responses;
00273     <a class="code" href="structocsp__response__data__st.html#a0">STACK_OF</a>(<a class="code" href="structX509__extension__st.html">X509_EXTENSION</a>) *responseExtensions;
00274     } <a class="code" href="structocsp__response__data__st.html">OCSP_RESPDATA</a>;
00275 
00276 <span class="comment">/*   BasicOCSPResponse       ::= SEQUENCE {</span>
00277 <span class="comment"> *      tbsResponseData      ResponseData,</span>
00278 <span class="comment"> *      signatureAlgorithm   AlgorithmIdentifier,</span>
00279 <span class="comment"> *      signature            BIT STRING,</span>
00280 <span class="comment"> *      certs                [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }</span>
00281 <span class="comment"> */</span>
00282   <span class="comment">/* Note 1:</span>
00283 <span class="comment">     The value for "signature" is specified in the OCSP rfc2560 as follows:</span>
00284 <span class="comment">     "The value for the signature SHALL be computed on the hash of the DER</span>
00285 <span class="comment">     encoding ResponseData."  This means that you must hash the DER-encoded</span>
00286 <span class="comment">     tbsResponseData, and then run it through a crypto-signing function, which</span>
00287 <span class="comment">     will (at least w/RSA) do a hash-'n'-private-encrypt operation.  This seems</span>
00288 <span class="comment">     a bit odd, but that's the spec.  Also note that the data structures do not</span>
00289 <span class="comment">     leave anywhere to independently specify the algorithm used for the initial</span>
00290 <span class="comment">     hash. So, we look at the signature-specification algorithm, and try to do</span>
00291 <span class="comment">     something intelligent. -- Kathy Weinhold, CertCo */</span>
00292   <span class="comment">/* Note 2:</span>
00293 <span class="comment">     It seems that the mentioned passage from RFC 2560 (section 4.2.1) is open</span>
00294 <span class="comment">     for interpretation.  I've done tests against another responder, and found</span>
00295 <span class="comment">     that it doesn't do the double hashing that the RFC seems to say one</span>
00296 <span class="comment">     should.  Therefore, all relevant functions take a flag saying which</span>
00297 <span class="comment">     variant should be used.    -- Richard Levitte, OpenSSL team and CeloCom */</span>
00298 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__basic__response__st.html">ocsp_basic_response_st</a>
00299     {
<a name="l00300"></a><a class="code" href="structocsp__basic__response__st.html#m3">00300</a>     <a class="code" href="structocsp__response__data__st.html">OCSP_RESPDATA</a> *<a class="code" href="structocsp__basic__response__st.html#m0">tbsResponseData</a>;
<a name="l00301"></a><a class="code" href="structocsp__basic__response__st.html#m4">00301</a>     <a class="code" href="structX509__algor__st.html">X509_ALGOR</a> *<a class="code" href="structocsp__basic__response__st.html#m1">signatureAlgorithm</a>;
<a name="l00302"></a><a class="code" href="structocsp__basic__response__st.html#m5">00302</a>     <a class="code" href="structasn1__string__st.html">ASN1_BIT_STRING</a> *<a class="code" href="structocsp__basic__response__st.html#m2">signature</a>;
00303     <a class="code" href="structocsp__basic__response__st.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *certs;
00304     } <a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a>;
00305 
00306 <span class="comment">/*</span>
00307 <span class="comment"> *   CRLReason ::= ENUMERATED {</span>
00308 <span class="comment"> *        unspecified             (0),</span>
00309 <span class="comment"> *        keyCompromise           (1),</span>
00310 <span class="comment"> *        cACompromise            (2),</span>
00311 <span class="comment"> *        affiliationChanged      (3),</span>
00312 <span class="comment"> *        superseded              (4),</span>
00313 <span class="comment"> *        cessationOfOperation    (5),</span>
00314 <span class="comment"> *        certificateHold         (6),</span>
00315 <span class="comment"> *        removeFromCRL           (8) }</span>
00316 <span class="comment"> */</span>
<a name="l00317"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a24">00317</a> <span class="preprocessor">#define OCSP_REVOKED_STATUS_NOSTATUS               -1</span>
<a name="l00318"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a25">00318</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_REVOKED_STATUS_UNSPECIFIED             0</span>
<a name="l00319"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a26">00319</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_REVOKED_STATUS_KEYCOMPROMISE           1</span>
<a name="l00320"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a27">00320</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_REVOKED_STATUS_CACOMPROMISE            2</span>
<a name="l00321"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a28">00321</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_REVOKED_STATUS_AFFILIATIONCHANGED      3</span>
<a name="l00322"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a29">00322</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_REVOKED_STATUS_SUPERSEDED              4</span>
<a name="l00323"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a30">00323</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_REVOKED_STATUS_CESSATIONOFOPERATION    5</span>
<a name="l00324"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a31">00324</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_REVOKED_STATUS_CERTIFICATEHOLD         6</span>
<a name="l00325"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a32">00325</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_REVOKED_STATUS_REMOVEFROMCRL           8</span>
00326 <span class="preprocessor"></span>
00327 <span class="comment">/* CrlID ::= SEQUENCE {</span>
00328 <span class="comment"> *     crlUrl               [0]     EXPLICIT IA5String OPTIONAL,</span>
00329 <span class="comment"> *     crlNum               [1]     EXPLICIT INTEGER OPTIONAL,</span>
00330 <span class="comment"> *     crlTime              [2]     EXPLICIT GeneralizedTime OPTIONAL }</span>
00331 <span class="comment"> */</span>
00332 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__crl__id__st.html">ocsp_crl_id_st</a>
00333         {
<a name="l00334"></a><a class="code" href="structocsp__crl__id__st.html#m3">00334</a>     <a class="code" href="structasn1__string__st.html">ASN1_IA5STRING</a> *<a class="code" href="structocsp__crl__id__st.html#m0">crlUrl</a>;
<a name="l00335"></a><a class="code" href="structocsp__crl__id__st.html#m4">00335</a>     <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *<a class="code" href="structocsp__crl__id__st.html#m1">crlNum</a>;
<a name="l00336"></a><a class="code" href="structocsp__crl__id__st.html#m5">00336</a>     <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> *<a class="code" href="structocsp__crl__id__st.html#m2">crlTime</a>;
00337         } <a class="code" href="structocsp__crl__id__st.html">OCSP_CRLID</a>;
00338 
00339 <span class="comment">/* ServiceLocator ::= SEQUENCE {</span>
00340 <span class="comment"> *      issuer    Name,</span>
00341 <span class="comment"> *      locator   AuthorityInfoAccessSyntax OPTIONAL }</span>
00342 <span class="comment"> */</span>
00343 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structocsp__service__locator__st.html">ocsp_service_locator_st</a>
00344         {
<a name="l00345"></a><a class="code" href="structocsp__service__locator__st.html#m1">00345</a>     <a class="code" href="structX509__name__st.html">X509_NAME</a>* <a class="code" href="structocsp__service__locator__st.html#m0">issuer</a>;
00346     <a class="code" href="structocsp__service__locator__st.html#a0">STACK_OF</a>(<a class="code" href="structACCESS__DESCRIPTION__st.html">ACCESS_DESCRIPTION</a>) *locator;
00347         } <a class="code" href="structocsp__service__locator__st.html">OCSP_SERVICELOC</a>;
00348  
<a name="l00349"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a33">00349</a> <span class="preprocessor">#define PEM_STRING_OCSP_REQUEST "OCSP REQUEST"</span>
<a name="l00350"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a34">00350</a> <span class="preprocessor"></span><span class="preprocessor">#define PEM_STRING_OCSP_RESPONSE "OCSP RESPONSE"</span>
00351 <span class="preprocessor"></span>
<a name="l00352"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a35">00352</a> <span class="preprocessor">#define d2i_OCSP_REQUEST_bio(bp,p) (OCSP_REQUEST*)ASN1_d2i_bio((char*(*)()) \</span>
00353 <span class="preprocessor">        OCSP_REQUEST_new,(char *(*)())d2i_OCSP_REQUEST, (bp),\</span>
00354 <span class="preprocessor">        (unsigned char **)(p))</span>
00355 <span class="preprocessor"></span>
<a name="l00356"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a36">00356</a> <span class="preprocessor">#define d2i_OCSP_RESPONSE_bio(bp,p) (OCSP_RESPONSE*)ASN1_d2i_bio((char*(*)())\</span>
00357 <span class="preprocessor">        OCSP_REQUEST_new,(char *(*)())d2i_OCSP_RESPONSE, (bp),\</span>
00358 <span class="preprocessor">        (unsigned char **)(p))</span>
00359 <span class="preprocessor"></span>
<a name="l00360"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a37">00360</a> <span class="preprocessor">#define PEM_read_bio_OCSP_REQUEST(bp,x,cb) (OCSP_REQUEST *)PEM_ASN1_read_bio( \</span>
00361 <span class="preprocessor">     (char *(*)())d2i_OCSP_REQUEST,PEM_STRING_OCSP_REQUEST,bp,(char **)x,cb,NULL)</span>
00362 <span class="preprocessor"></span>
<a name="l00363"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a38">00363</a> <span class="preprocessor">#define PEM_read_bio_OCSP_RESPONSE(bp,x,cb)(OCSP_RESPONSE *)PEM_ASN1_read_bio(\</span>
00364 <span class="preprocessor">     (char *(*)())d2i_OCSP_RESPONSE,PEM_STRING_OCSP_RESPONSE,bp,(char **)x,cb,NULL)</span>
00365 <span class="preprocessor"></span>
<a name="l00366"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a39">00366</a> <span class="preprocessor">#define PEM_write_bio_OCSP_REQUEST(bp,o) \</span>
00367 <span class="preprocessor">    PEM_ASN1_write_bio((int (*)())i2d_OCSP_REQUEST,PEM_STRING_OCSP_REQUEST,\</span>
00368 <span class="preprocessor">            bp,(char *)o, NULL,NULL,0,NULL,NULL)</span>
00369 <span class="preprocessor"></span>
<a name="l00370"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a40">00370</a> <span class="preprocessor">#define PEM_write_bio_OCSP_RESPONSE(bp,o) \</span>
00371 <span class="preprocessor">    PEM_ASN1_write_bio((int (*)())i2d_OCSP_RESPONSE,PEM_STRING_OCSP_RESPONSE,\</span>
00372 <span class="preprocessor">            bp,(char *)o, NULL,NULL,0,NULL,NULL)</span>
00373 <span class="preprocessor"></span>
<a name="l00374"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a41">00374</a> <span class="preprocessor">#define i2d_OCSP_RESPONSE_bio(bp,o) ASN1_i2d_bio(i2d_OCSP_RESPONSE,bp,\</span>
00375 <span class="preprocessor">        (unsigned char *)o)</span>
00376 <span class="preprocessor"></span>
<a name="l00377"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a42">00377</a> <span class="preprocessor">#define i2d_OCSP_REQUEST_bio(bp,o) ASN1_i2d_bio(i2d_OCSP_REQUEST,bp,\</span>
00378 <span class="preprocessor">        (unsigned char *)o)</span>
00379 <span class="preprocessor"></span>
<a name="l00380"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a43">00380</a> <span class="preprocessor">#define OCSP_REQUEST_sign(o,pkey,md) \</span>
00381 <span class="preprocessor">    ASN1_item_sign(ASN1_ITEM_rptr(OCSP_REQINFO),\</span>
00382 <span class="preprocessor">        o-&gt;optionalSignature-&gt;signatureAlgorithm,NULL,\</span>
00383 <span class="preprocessor">            o-&gt;optionalSignature-&gt;signature,o-&gt;tbsRequest,pkey,md)</span>
00384 <span class="preprocessor"></span>
<a name="l00385"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a44">00385</a> <span class="preprocessor">#define OCSP_BASICRESP_sign(o,pkey,md,d) \</span>
00386 <span class="preprocessor">    ASN1_item_sign(ASN1_ITEM_rptr(OCSP_RESPDATA),o-&gt;signatureAlgorithm,NULL,\</span>
00387 <span class="preprocessor">        o-&gt;signature,o-&gt;tbsResponseData,pkey,md)</span>
00388 <span class="preprocessor"></span>
<a name="l00389"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a45">00389</a> <span class="preprocessor">#define OCSP_REQUEST_verify(a,r) ASN1_item_verify(ASN1_ITEM_rptr(OCSP_REQINFO),\</span>
00390 <span class="preprocessor">        a-&gt;optionalSignature-&gt;signatureAlgorithm,\</span>
00391 <span class="preprocessor">    a-&gt;optionalSignature-&gt;signature,a-&gt;tbsRequest,r)</span>
00392 <span class="preprocessor"></span>
<a name="l00393"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a46">00393</a> <span class="preprocessor">#define OCSP_BASICRESP_verify(a,r,d) ASN1_item_verify(ASN1_ITEM_rptr(OCSP_RESPDATA),\</span>
00394 <span class="preprocessor">    a-&gt;signatureAlgorithm,a-&gt;signature,a-&gt;tbsResponseData,r)</span>
00395 <span class="preprocessor"></span>
<a name="l00396"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a47">00396</a> <span class="preprocessor">#define ASN1_BIT_STRING_digest(data,type,md,len) \</span>
00397 <span class="preprocessor">    ASN1_item_digest(ASN1_ITEM_rptr(ASN1_BIT_STRING),type,data,md,len)</span>
00398 <span class="preprocessor"></span>
<a name="l00399"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a48">00399</a> <span class="preprocessor">#define OCSP_CERTID_dup(cid) (OCSP_CERTID*)ASN1_dup((int(*)())i2d_OCSP_CERTID,\</span>
00400 <span class="preprocessor">        (char *(*)())d2i_OCSP_CERTID,(char *)(cid))</span>
00401 <span class="preprocessor"></span>
<a name="l00402"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a49">00402</a> <span class="preprocessor">#define OCSP_CERTSTATUS_dup(cs)\</span>
00403 <span class="preprocessor">                (OCSP_CERTSTATUS*)ASN1_dup((int(*)())i2d_OCSP_CERTSTATUS,\</span>
00404 <span class="preprocessor">        (char *(*)())d2i_OCSP_CERTSTATUS,(char *)(cs))</span>
00405 <span class="preprocessor"></span>
00406 <a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a> *<a class="code" href="ocsp__ht_8c.html#a0">OCSP_sendreq_bio</a>(<a class="code" href="structbio__st.html">BIO</a> *b, <span class="keywordtype">char</span> *path, <a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req);
00407 
00408 <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *<a class="code" href="ocsp__lib_8c.html#a0">OCSP_cert_to_id</a>(<span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a> *dgst, <a class="code" href="structx509__st.html">X509</a> *subject, <a class="code" href="structx509__st.html">X509</a> *issuer);
00409 
00410 <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *<a class="code" href="ocsp__lib_8c.html#a1">OCSP_cert_id_new</a>(<span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a> *dgst, 
00411                   <a class="code" href="structX509__name__st.html">X509_NAME</a> *issuerName, 
00412                   <a class="code" href="structasn1__string__st.html">ASN1_BIT_STRING</a>* issuerKey, 
00413                   <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *serialNumber);
00414 
00415 <a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *<a class="code" href="ocsp__cl_8c.html#a0">OCSP_request_add0_id</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req, <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *cid);
00416 
00417 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a38">OCSP_request_add1_nonce</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *val, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>);
00418 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a39">OCSP_basic_add1_nonce</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *resp, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *val, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>);
00419 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a40">OCSP_check_nonce</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req, <a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *bs);
00420 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a41">OCSP_copy_nonce</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *resp, <a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req);
00421 
00422 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a1">OCSP_request_set1_name</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req, <a class="code" href="structX509__name__st.html">X509_NAME</a> *nm);
00423 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a2">OCSP_request_add1_cert</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req, <a class="code" href="structx509__st.html">X509</a> *cert);
00424 
00425 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a3">OCSP_request_sign</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a>   *req,
00426               <a class="code" href="structx509__st.html">X509</a>           *signer,
00427               <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a>       *key,
00428               <span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a>   *dgst,
00429               <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *certs,
00430               <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00431 
00432 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a4">OCSP_response_status</a>(<a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a> *resp);
00433 <a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *<a class="code" href="ocsp__cl_8c.html#a5">OCSP_response_get1_basic</a>(<a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a> *resp);
00434 
00435 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a6">OCSP_resp_count</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *bs);
00436 <a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *<a class="code" href="ocsp__cl_8c.html#a7">OCSP_resp_get0</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *bs, <span class="keywordtype">int</span> idx);
00437 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a8">OCSP_resp_find</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *bs, <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *id, <span class="keywordtype">int</span> last);
00438 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a9">OCSP_single_get0_status</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *single, <span class="keywordtype">int</span> *reason,
00439                 <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> **revtime,
00440                 <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> **thisupd,
00441                 <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> **nextupd);
00442 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a10">OCSP_resp_find_status</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *bs, <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *id, <span class="keywordtype">int</span> *status,
00443                 <span class="keywordtype">int</span> *reason,
00444                 <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> **revtime,
00445                 <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> **thisupd,
00446                 <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> **nextupd);
00447 <span class="keywordtype">int</span> <a class="code" href="ocsp__cl_8c.html#a11">OCSP_check_validity</a>(<a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> *thisupd,
00448             <a class="code" href="structasn1__string__st.html">ASN1_GENERALIZEDTIME</a> *nextupd,
00449             <span class="keywordtype">long</span> sec, <span class="keywordtype">long</span> maxsec);
00450 
00451 <span class="keywordtype">int</span> <a class="code" href="ocsp__vfy_8c.html#a8">OCSP_request_verify</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req, <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *certs, <a class="code" href="structx509__store__st.html">X509_STORE</a> *store, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00452 
00453 <span class="keywordtype">int</span> <a class="code" href="ocsp__lib_8c.html#a4">OCSP_parse_url</a>(<span class="keywordtype">char</span> *url, <span class="keywordtype">char</span> **phost, <span class="keywordtype">char</span> **pport, <span class="keywordtype">char</span> **ppath, <span class="keywordtype">int</span> *pssl);
00454 
00455 <span class="keywordtype">int</span> <a class="code" href="ocsp__lib_8c.html#a2">OCSP_id_issuer_cmp</a>(<a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *<a class="code" href="v3__extku_8c.html#a3">a</a>, <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *b);
00456 <span class="keywordtype">int</span> <a class="code" href="ocsp__lib_8c.html#a3">OCSP_id_cmp</a>(<a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *<a class="code" href="v3__extku_8c.html#a3">a</a>, <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *b);
00457 
00458 <span class="keywordtype">int</span> <a class="code" href="ocsp__srv_8c.html#a0">OCSP_request_onereq_count</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req);
00459 <a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *<a class="code" href="ocsp__srv_8c.html#a1">OCSP_request_onereq_get0</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req, <span class="keywordtype">int</span> i);
00460 <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *<a class="code" href="ocsp__srv_8c.html#a2">OCSP_onereq_get0_id</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *one);
00461 <span class="keywordtype">int</span> <a class="code" href="ocsp__srv_8c.html#a3">OCSP_id_get0_info</a>(<a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> **piNameHash, <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> **pmd,
00462             <a class="code" href="structasn1__string__st.html">ASN1_OCTET_STRING</a> **pikeyHash,
00463             <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> **pserial, <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *cid);
00464 <span class="keywordtype">int</span> <a class="code" href="ocsp__srv_8c.html#a4">OCSP_request_is_signed</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *req);
00465 <a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a> *<a class="code" href="ocsp__srv_8c.html#a5">OCSP_response_create</a>(<span class="keywordtype">int</span> status, <a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *bs);
00466 <a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *<a class="code" href="ocsp__srv_8c.html#a6">OCSP_basic_add1_status</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *rsp,
00467                         <a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a> *cid,
00468                         <span class="keywordtype">int</span> status, <span class="keywordtype">int</span> reason,
00469                         <a class="code" href="structasn1__string__st.html">ASN1_TIME</a> *revtime,
00470                     <a class="code" href="structasn1__string__st.html">ASN1_TIME</a> *thisupd, <a class="code" href="structasn1__string__st.html">ASN1_TIME</a> *nextupd);
00471 <span class="keywordtype">int</span> <a class="code" href="ocsp__srv_8c.html#a7">OCSP_basic_add1_cert</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *resp, <a class="code" href="structx509__st.html">X509</a> *cert);
00472 <span class="keywordtype">int</span> <a class="code" href="ocsp__srv_8c.html#a8">OCSP_basic_sign</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *brsp, 
00473             <a class="code" href="structx509__st.html">X509</a> *signer, <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *key, <span class="keyword">const</span> <a class="code" href="structenv__md__st.html">EVP_MD</a> *dgst,
00474             <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *certs, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00475 
00476 <a class="code" href="structasn1__string__st.html">ASN1_STRING</a> *<a class="code" href="ocsp__ext_8c.html#a36">ASN1_STRING_encode</a>(<a class="code" href="structasn1__string__st.html">ASN1_STRING</a> *s, <span class="keywordtype">int</span> (*i2d)(), 
00477                 <span class="keywordtype">char</span> *data, <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a>) *sk);
00478 
00479 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a42">OCSP_crlID_new</a>(<span class="keywordtype">char</span> *url, <span class="keywordtype">long</span> *n, <span class="keywordtype">char</span> *tim);
00480 
00481 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a43">OCSP_accept_responses_new</a>(<span class="keywordtype">char</span> **oids);
00482 
00483 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a44">OCSP_archive_cutoff_new</a>(<span class="keywordtype">char</span>* tim);
00484 
00485 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a45">OCSP_url_svcloc_new</a>(<a class="code" href="structX509__name__st.html">X509_NAME</a>* issuer, <span class="keywordtype">char</span> **urls);
00486 
00487 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a0">OCSP_REQUEST_get_ext_count</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x);
00488 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a1">OCSP_REQUEST_get_ext_by_NID</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">int</span> lastpos);
00489 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a2">OCSP_REQUEST_get_ext_by_OBJ</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x, <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *<a class="code" href="x509_8h.html#a173">obj</a>, <span class="keywordtype">int</span> lastpos);
00490 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a3">OCSP_REQUEST_get_ext_by_critical</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x, <span class="keywordtype">int</span> crit, <span class="keywordtype">int</span> lastpos);
00491 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a4">OCSP_REQUEST_get_ext</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00492 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a5">OCSP_REQUEST_delete_ext</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00493 <span class="keywordtype">void</span> *<a class="code" href="ocsp__ext_8c.html#a6">OCSP_REQUEST_get1_ext_d2i</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">int</span> *crit, <span class="keywordtype">int</span> *idx);
00494 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a7">OCSP_REQUEST_add1_ext_i2d</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">void</span> *<a class="code" href="v3__cpols_8c.html#a1">value</a>, <span class="keywordtype">int</span> crit,
00495                             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00496 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a8">OCSP_REQUEST_add_ext</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a> *x, <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *ex, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00497 
00498 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a9">OCSP_ONEREQ_get_ext_count</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x);
00499 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a10">OCSP_ONEREQ_get_ext_by_NID</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">int</span> lastpos);
00500 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a11">OCSP_ONEREQ_get_ext_by_OBJ</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x, <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *<a class="code" href="x509_8h.html#a173">obj</a>, <span class="keywordtype">int</span> lastpos);
00501 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a12">OCSP_ONEREQ_get_ext_by_critical</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x, <span class="keywordtype">int</span> crit, <span class="keywordtype">int</span> lastpos);
00502 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a13">OCSP_ONEREQ_get_ext</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00503 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a14">OCSP_ONEREQ_delete_ext</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00504 <span class="keywordtype">void</span> *<a class="code" href="ocsp__ext_8c.html#a15">OCSP_ONEREQ_get1_ext_d2i</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">int</span> *crit, <span class="keywordtype">int</span> *idx);
00505 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a16">OCSP_ONEREQ_add1_ext_i2d</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">void</span> *<a class="code" href="v3__cpols_8c.html#a1">value</a>, <span class="keywordtype">int</span> crit,
00506                             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00507 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a17">OCSP_ONEREQ_add_ext</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a> *x, <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *ex, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00508 
00509 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a18">OCSP_BASICRESP_get_ext_count</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x);
00510 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a19">OCSP_BASICRESP_get_ext_by_NID</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">int</span> lastpos);
00511 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a20">OCSP_BASICRESP_get_ext_by_OBJ</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x, <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *<a class="code" href="x509_8h.html#a173">obj</a>, <span class="keywordtype">int</span> lastpos);
00512 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a21">OCSP_BASICRESP_get_ext_by_critical</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x, <span class="keywordtype">int</span> crit, <span class="keywordtype">int</span> lastpos);
00513 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a22">OCSP_BASICRESP_get_ext</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00514 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a23">OCSP_BASICRESP_delete_ext</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00515 <span class="keywordtype">void</span> *<a class="code" href="ocsp__ext_8c.html#a24">OCSP_BASICRESP_get1_ext_d2i</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">int</span> *crit, <span class="keywordtype">int</span> *idx);
00516 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a25">OCSP_BASICRESP_add1_ext_i2d</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">void</span> *<a class="code" href="v3__cpols_8c.html#a1">value</a>, <span class="keywordtype">int</span> crit,
00517                             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00518 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a26">OCSP_BASICRESP_add_ext</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *x, <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *ex, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00519 
00520 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a27">OCSP_SINGLERESP_get_ext_count</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x);
00521 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a28">OCSP_SINGLERESP_get_ext_by_NID</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">int</span> lastpos);
00522 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a29">OCSP_SINGLERESP_get_ext_by_OBJ</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x, <a class="code" href="structasn1__object__st.html">ASN1_OBJECT</a> *<a class="code" href="x509_8h.html#a173">obj</a>, <span class="keywordtype">int</span> lastpos);
00523 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a30">OCSP_SINGLERESP_get_ext_by_critical</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x, <span class="keywordtype">int</span> crit, <span class="keywordtype">int</span> lastpos);
00524 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a31">OCSP_SINGLERESP_get_ext</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00525 <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *<a class="code" href="ocsp__ext_8c.html#a32">OCSP_SINGLERESP_delete_ext</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00526 <span class="keywordtype">void</span> *<a class="code" href="ocsp__ext_8c.html#a33">OCSP_SINGLERESP_get1_ext_d2i</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">int</span> *crit, <span class="keywordtype">int</span> *idx);
00527 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a34">OCSP_SINGLERESP_add1_ext_i2d</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a177">nid</a>, <span class="keywordtype">void</span> *<a class="code" href="v3__cpols_8c.html#a1">value</a>, <span class="keywordtype">int</span> crit,
00528                             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00529 <span class="keywordtype">int</span> <a class="code" href="ocsp__ext_8c.html#a35">OCSP_SINGLERESP_add_ext</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a> *x, <a class="code" href="structX509__extension__st.html">X509_EXTENSION</a> *ex, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a171">loc</a>);
00530 
00531 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__single__response__st.html">OCSP_SINGLERESP</a>)
00532 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__cert__status__st.html">OCSP_CERTSTATUS</a>)
00533 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__revoked__info__st.html">OCSP_REVOKEDINFO</a>)
00534 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a>)
00535 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__response__data__st.html">OCSP_RESPDATA</a>)
00536 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__responder__id__st.html">OCSP_RESPID</a>)
00537 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a>)
00538 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__resp__bytes__st.html">OCSP_RESPBYTES</a>)
00539 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__one__request__st.html">OCSP_ONEREQ</a>)
00540 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__cert__id__st.html">OCSP_CERTID</a>)
00541 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a>)
00542 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__signature__st.html">OCSP_SIGNATURE</a>)
00543 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__req__info__st.html">OCSP_REQINFO</a>)
00544 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__crl__id__st.html">OCSP_CRLID</a>)
00545 <a class="code" href="asn1_8h.html#a85">DECLARE_ASN1_FUNCTIONS</a>(<a class="code" href="structocsp__service__locator__st.html">OCSP_SERVICELOC</a>)
00546 
00547 <span class="keywordtype">char</span> *<a class="code" href="ocsp__prn_8c.html#a2">OCSP_response_status_str</a>(<span class="keywordtype">long</span> s);
00548 <span class="keywordtype">char</span> *<a class="code" href="ocsp__prn_8c.html#a3">OCSP_cert_status_str</a>(<span class="keywordtype">long</span> s);
00549 <span class="keywordtype">char</span> *<a class="code" href="ocsp__prn_8c.html#a4">OCSP_crl_reason_str</a>(<span class="keywordtype">long</span> s);
00550 
00551 <span class="keywordtype">int</span> <a class="code" href="ocsp__prn_8c.html#a5">OCSP_REQUEST_print</a>(<a class="code" href="structbio__st.html">BIO</a> *bp, <a class="code" href="structocsp__request__st.html">OCSP_REQUEST</a>* <a class="code" href="v3__extku_8c.html#a3">a</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00552 <span class="keywordtype">int</span> <a class="code" href="ocsp__prn_8c.html#a6">OCSP_RESPONSE_print</a>(<a class="code" href="structbio__st.html">BIO</a> *bp, <a class="code" href="structocsp__response__st.html">OCSP_RESPONSE</a>* o, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00553 
00554 <span class="keywordtype">int</span> <a class="code" href="ocsp__vfy_8c.html#a7">OCSP_basic_verify</a>(<a class="code" href="structocsp__basic__response__st.html">OCSP_BASICRESP</a> *bs, <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *certs,
00555                 <a class="code" href="structx509__store__st.html">X509_STORE</a> *st, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> flags);
00556 
00557 <span class="comment">/* BEGIN ERROR CODES */</span>
00558 <span class="comment">/* The following lines are auto generated by the script mkerr.pl. Any changes</span>
00559 <span class="comment"> * made after this point may be overwritten when the script is next run.</span>
00560 <span class="comment"> */</span>
00561 <span class="keywordtype">void</span> <a class="code" href="ocsp__err_8c.html#a3">ERR_load_OCSP_strings</a>(<span class="keywordtype">void</span>);
00562 
00563 <span class="comment">/* Error codes for the OCSP functions. */</span>
00564 
00565 <span class="comment">/* Function codes. */</span>
<a name="l00566"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a50">00566</a> <span class="preprocessor">#define OCSP_F_ASN1_STRING_ENCODE            100</span>
<a name="l00567"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a51">00567</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_CERT_ID_NEW               101</span>
<a name="l00568"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a52">00568</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_D2I_OCSP_NONCE                102</span>
<a name="l00569"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a53">00569</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_BASIC_ADD1_STATUS            103</span>
<a name="l00570"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a54">00570</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_BASIC_SIGN               104</span>
<a name="l00571"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a55">00571</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_BASIC_VERIFY             105</span>
<a name="l00572"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a56">00572</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_CHECK_DELEGATED          106</span>
<a name="l00573"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a57">00573</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_CHECK_IDS                107</span>
<a name="l00574"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a58">00574</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_CHECK_ISSUER             108</span>
<a name="l00575"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a59">00575</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_CHECK_VALIDITY           115</span>
<a name="l00576"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a60">00576</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_MATCH_ISSUERID           109</span>
<a name="l00577"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a61">00577</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_PARSE_URL                114</span>
<a name="l00578"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a62">00578</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_REQUEST_SIGN             110</span>
<a name="l00579"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a63">00579</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_REQUEST_VERIFY           116</span>
<a name="l00580"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a64">00580</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_RESPONSE_GET1_BASIC          111</span>
<a name="l00581"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a65">00581</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_OCSP_SENDREQ_BIO              112</span>
<a name="l00582"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a66">00582</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_F_REQUEST_VERIFY                113</span>
00583 <span class="preprocessor"></span>
00584 <span class="comment">/* Reason codes. */</span>
<a name="l00585"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a67">00585</a> <span class="preprocessor">#define OCSP_R_BAD_DATA                  100</span>
<a name="l00586"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a68">00586</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_CERTIFICATE_VERIFY_ERROR          101</span>
<a name="l00587"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a69">00587</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_DIGEST_ERR                102</span>
<a name="l00588"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a70">00588</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_ERROR_IN_NEXTUPDATE_FIELD         122</span>
<a name="l00589"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a71">00589</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_ERROR_IN_THISUPDATE_FIELD         123</span>
<a name="l00590"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a72">00590</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_ERROR_PARSING_URL             121</span>
<a name="l00591"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a73">00591</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_MISSING_OCSPSIGNING_USAGE         103</span>
<a name="l00592"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a74">00592</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_NEXTUPDATE_BEFORE_THISUPDATE      124</span>
<a name="l00593"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a75">00593</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_NOT_BASIC_RESPONSE            104</span>
<a name="l00594"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a76">00594</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_NO_CERTIFICATES_IN_CHAIN          105</span>
<a name="l00595"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a77">00595</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_NO_CONTENT                106</span>
<a name="l00596"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a78">00596</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_NO_PUBLIC_KEY                 107</span>
<a name="l00597"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a79">00597</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_NO_RESPONSE_DATA              108</span>
<a name="l00598"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a80">00598</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_NO_REVOKED_TIME               109</span>
<a name="l00599"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a81">00599</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE    110</span>
<a name="l00600"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a82">00600</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_REQUEST_NOT_SIGNED            128</span>
<a name="l00601"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a83">00601</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_RESPONSE_CONTAINS_NO_REVOCATION_DATA  111</span>
<a name="l00602"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a84">00602</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_ROOT_CA_NOT_TRUSTED           112</span>
<a name="l00603"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a85">00603</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_SERVER_READ_ERROR             113</span>
<a name="l00604"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a86">00604</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_SERVER_RESPONSE_ERROR             114</span>
<a name="l00605"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a87">00605</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_SERVER_RESPONSE_PARSE_ERROR       115</span>
<a name="l00606"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a88">00606</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_SERVER_WRITE_ERROR            116</span>
<a name="l00607"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a89">00607</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_SIGNATURE_FAILURE             117</span>
<a name="l00608"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a90">00608</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_SIGNER_CERTIFICATE_NOT_FOUND      118</span>
<a name="l00609"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a91">00609</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_STATUS_EXPIRED                125</span>
<a name="l00610"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a92">00610</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_STATUS_NOT_YET_VALID          126</span>
<a name="l00611"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a93">00611</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_STATUS_TOO_OLD                127</span>
<a name="l00612"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a94">00612</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_UNKNOWN_MESSAGE_DIGEST            119</span>
<a name="l00613"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a95">00613</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_UNKNOWN_NID               120</span>
<a name="l00614"></a><a class="code" href="include_2openssl_2ocsp_8h.html#a96">00614</a> <span class="preprocessor"></span><span class="preprocessor">#define OCSP_R_UNSUPPORTED_REQUESTORNAME_TYPE        129</span>
00615 <span class="preprocessor"></span>
00616 <span class="preprocessor">#ifdef  __cplusplus</span>
00617 <span class="preprocessor"></span>}
00618 <span class="preprocessor">#endif</span>
00619 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Mon Aug 14 19:59:37 2006 for Octeon Core Crypto API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
