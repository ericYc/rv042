<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cryptolinux.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>cryptolinux.h</h1><a href="cryptolinux_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">   Copyright (c) 2003-2005 Cavium Networks (support@cavium.com). All rights</span>
00003 <span class="comment">   reserved.</span>
00004 <span class="comment"></span>
00005 <span class="comment">   Redistribution and use in source and binary forms, with or without</span>
00006 <span class="comment">   modification, are permitted provided that the following conditions are met:</span>
00007 <span class="comment">   1. Redistributions of source code must retain the above copyright notice,</span>
00008 <span class="comment">   this list of conditions and the following disclaimer.</span>
00009 <span class="comment">   2. Redistributions in binary form must reproduce the above copyright notice,</span>
00010 <span class="comment">   this list of conditions and the following disclaimer in the documentation</span>
00011 <span class="comment">   and/or other materials provided with the distribution.</span>
00012 <span class="comment">   3. All advertising materials mentioning features or use of this software</span>
00013 <span class="comment">   must display the following acknowledgement:</span>
00014 <span class="comment">   This product includes software developed by Cavium Networks</span>
00015 <span class="comment">   4. Cavium Networks' name may not be used to endorse or promote products</span>
00016 <span class="comment">   derived from this software without specific prior written permission.</span>
00017 <span class="comment"></span>
00018 <span class="comment">   This Software, including technical data, may be subject to U.S. export</span>
00019 <span class="comment">   control laws, including the U.S. Export Administration Act and its</span>
00020 <span class="comment">   associated regulations, and may be subject to export or import regulations</span>
00021 <span class="comment">   in other countries. You warrant that You will comply strictly in all</span>
00022 <span class="comment">   respects with all such regulations and acknowledge that you have the</span>
00023 <span class="comment">   responsibility to obtain licenses to export, re-export or import the</span>
00024 <span class="comment">   Software.</span>
00025 <span class="comment"></span>
00026 <span class="comment">   TO THE MAXIMUM EXTENT PERMITTED BY LAW, THE SOFTWARE IS PROVIDED "AS IS" AND</span>
00027 <span class="comment">   WITH ALL FAULTS AND CAVIUM MAKES NO PROMISES, REPRESENTATIONS OR WARRANTIES,</span>
00028 <span class="comment">   EITHER EXPRESS, IMPLIED, STATUTORY, OR OTHERWISE, WITH RESPECT TO THE</span>
00029 <span class="comment">   SOFTWARE, INCLUDING ITS CONDITION, ITS CONFORMITY TO ANY REPRESENTATION OR</span>
00030 <span class="comment">   DESCRIPTION, OR THE EXISTENCE OF ANY LATENT OR PATENT DEFECTS, AND CAVIUM</span>
00031 <span class="comment">   SPECIFICALLY DISCLAIMS ALL IMPLIED (IF ANY) WARRANTIES OF TITLE,</span>
00032 <span class="comment">   MERCHANTABILITY, NONINFRINGEMENT, FITNESS FOR A PARTICULAR PURPOSE, LACK OF</span>
00033 <span class="comment">   VIRUSES, ACCURACY OR COMPLETENESS, QUIET ENJOYMENT, QUIET POSSESSION OR</span>
00034 <span class="comment">   CORRESPONDENCE TO DESCRIPTION. THE ENTIRE RISK ARISING OUT OF USE OR</span>
00035 <span class="comment">   PERFORMANCE OF THE SOFTWARE LIES WITH YOU.</span>
00036 <span class="comment"> */</span>
00037 
00038 <span class="preprocessor">#include "cvmx-asm.h"</span>
00039 <span class="preprocessor">#if defined(__linux__)</span>
00040 <span class="preprocessor"></span><span class="preprocessor">#include &lt;linux/ioctl.h&gt;</span>
00041 <span class="preprocessor">#include &lt;asm/unistd.h&gt;</span>
00042 <span class="preprocessor">#endif</span>
00043 <span class="preprocessor"></span>
<a name="l00044"></a><a class="code" href="cryptolinux_8h.html#a0">00044</a> <span class="preprocessor">#define OCT_CRYPT_MAJOR                 125</span>
00045 <span class="preprocessor"></span><span class="preprocessor">#ifndef MUL_PAD</span>
<a name="l00046"></a><a class="code" href="cryptolinux_8h.html#a1">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define MUL_PAD  8 </span>
00047 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00048 <span class="preprocessor"></span>
<a name="l00049"></a><a class="code" href="cryptolinux_8h.html#a2">00049</a> <span class="preprocessor">#define MODEXP_GUARD 192</span>
<a name="l00050"></a><a class="code" href="cryptolinux_8h.html#a3">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define ROUNDUP8(val) (((val) + 7)&amp;0xfffffff8)</span>
00051 <span class="preprocessor"></span>
00052 
<a name="l00053"></a><a class="code" href="cryptolinux_8h.html#a4">00053</a> <span class="preprocessor">#define FATAL_ERROR</span>
00054 <span class="preprocessor"></span>
<a name="l00055"></a><a class="code" href="cryptolinux_8h.html#a5">00055</a> <span class="preprocessor">#define KEY_LEN                          128</span>
<a name="l00056"></a><a class="code" href="cryptolinux_8h.html#a6">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_LEN_8                      128*8</span>
00057 <span class="preprocessor"></span>
00058 <span class="preprocessor">#if defined(__KERNEL__)</span>
00059 <span class="preprocessor"></span>
00060 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcvm__rsa__key.html">cvm_rsa_key</a>
00061 {
00062     uint64_t *<a class="code" href="structcvm__rsa__key.html#m0">mod</a>;
00063     uint64_t *<a class="code" href="structcvm__rsa__key.html#m1">privexp</a>;
00064     uint64_t *<a class="code" href="structcvm__rsa__key.html#m2">pubexp</a>;
00065     uint64_t *<a class="code" href="structcvm__rsa__key.html#m3">expp</a>;
00066     uint64_t *<a class="code" href="structcvm__rsa__key.html#m4">expq</a>;
00067     uint64_t *<a class="code" href="structcvm__rsa__key.html#m5">p</a>;
00068     uint64_t *<a class="code" href="structcvm__rsa__key.html#m6">q</a>;
00069     uint64_t *<a class="code" href="structcvm__rsa__key.html#m7">coeff</a>;
00070     <span class="keywordtype">int</span>      <a class="code" href="structcvm__rsa__key.html#m8">len</a>;
00071     <span class="keywordtype">int</span>      <a class="code" href="structcvm__rsa__key.html#m9">eplen</a>;
00072     <span class="keywordtype">int</span>      <a class="code" href="structcvm__rsa__key.html#m10">eqlen</a>;
00073 } <a class="code" href="structcvm__rsa__key.html">cvm_rsa_key_t</a>;
00074 
00075 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmulparams.html">mulparams</a>
00076 {
00077     uint64_t *<a class="code" href="structmulparams.html#m0">product</a>;
00078     uint64_t *<a class="code" href="structmulparams.html#m1">mpcand</a>;
00079     uint64_t *<a class="code" href="structmulparams.html#m2">mplier</a>;
00080     uint64_t *<a class="code" href="structmulparams.html#m3">mod</a>;
00081     uint64_t *<a class="code" href="structmulparams.html#m4">recip</a>;
00082     <span class="keywordtype">int</span> <a class="code" href="structmulparams.html#m5">len</a>;
00083     <span class="keywordtype">int</span> <a class="code" href="structmulparams.html#m6">elen</a>;
00084     <span class="keywordtype">int</span> <a class="code" href="structmulparams.html#m7">mlen</a>;
00085     <span class="keywordtype">int</span> <a class="code" href="structmulparams.html#m8">blen</a>;
00086 }<a class="code" href="structmulparams.html">mulparams</a>;
00087 
00088 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcrtparams.html">crtparams</a>
00089 {
00090     uint64_t *<a class="code" href="structcrtparams.html#m0">product</a>;
00091     uint64_t *<a class="code" href="structcrtparams.html#m1">base</a>;
00092     <a class="code" href="structcvm__rsa__key.html">cvm_rsa_key_t</a> *<a class="code" href="structcrtparams.html#m2">rkey</a>;
00093   <span class="keywordtype">int</span> <a class="code" href="structcrtparams.html#m3">nonwalign</a>;
00094 }<a class="code" href="structcrtparams.html">crtparams</a>;
00095 <span class="preprocessor">#endif</span>
00096 <span class="preprocessor"></span>
<a name="l00097"></a><a class="code" href="structcvm__crypto__op__t.html">00097</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
00098 <span class="keyword"></span>{
<a name="l00099"></a><a class="code" href="structcvm__crypto__op__t.html#m0">00099</a>     uint64_t sizeofptr;
<a name="l00100"></a><a class="code" href="structcvm__crypto__op__t.html#m1">00100</a>     uint64_t arg1;
<a name="l00101"></a><a class="code" href="structcvm__crypto__op__t.html#m2">00101</a>     uint64_t arg2;
<a name="l00102"></a><a class="code" href="structcvm__crypto__op__t.html#m3">00102</a>     uint64_t arg3;
<a name="l00103"></a><a class="code" href="structcvm__crypto__op__t.html#m4">00103</a>     uint64_t arg4;
<a name="l00104"></a><a class="code" href="structcvm__crypto__op__t.html#m5">00104</a>     uint64_t arg5;
<a name="l00105"></a><a class="code" href="structcvm__crypto__op__t.html#m6">00105</a>     int64_t arg6;
<a name="l00106"></a><a class="code" href="structcvm__crypto__op__t.html#m7">00106</a>     int64_t arg7;
<a name="l00107"></a><a class="code" href="structcvm__crypto__op__t.html#m8">00107</a>     int64_t arg8;
<a name="l00108"></a><a class="code" href="structcvm__crypto__op__t.html#m9">00108</a>     int64_t arg9;
00109 }<a class="code" href="structcvm__crypto__op__t.html">cvm_crypto_op_t</a>;
00110 
<a name="l00111"></a><a class="code" href="structcvm__rsa__key__n32__t.html">00111</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>
00112 <span class="keyword"></span>{
<a name="l00113"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m0">00113</a>     uint32_t mod;
<a name="l00114"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m1">00114</a>     uint32_t privexp;
<a name="l00115"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m2">00115</a>     uint32_t pubexp;
<a name="l00116"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m3">00116</a>     uint32_t expp;
<a name="l00117"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m4">00117</a>     uint32_t expq;
<a name="l00118"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m5">00118</a>     uint32_t p;
<a name="l00119"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m6">00119</a>     uint32_t q;
<a name="l00120"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m7">00120</a>     uint32_t coeff;
<a name="l00121"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m8">00121</a>     int32_t  <a class="code" href="x509_8h.html#a176">len</a>;
<a name="l00122"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m9">00122</a>     int32_t  eplen;
<a name="l00123"></a><a class="code" href="structcvm__rsa__key__n32__t.html#m10">00123</a>     int32_t  eqlen;
00124 } <a class="code" href="structcvm__rsa__key__n32__t.html">cvm_rsa_key_n32_t</a>;
00125 
<a name="l00126"></a><a class="code" href="cryptolinux_8h.html#a7">00126</a> <span class="preprocessor">#define CVM_MOD_EXP_BASE 0xbb</span>
00127 <span class="preprocessor"></span>
00128 <span class="comment">/* ioctl command */</span>
<a name="l00129"></a><a class="code" href="cryptolinux_8h.html#a8">00129</a> <span class="preprocessor">#define CRYPT_MODEXPCRT     _IOWR(CVM_MOD_EXP_BASE,0,cvm_crypto_op_t) </span>
<a name="l00130"></a><a class="code" href="cryptolinux_8h.html#a9">00130</a> <span class="preprocessor"></span><span class="preprocessor">#define CRYPT_MODEXP        _IOWR(CVM_MOD_EXP_BASE,1,cvm_crypto_op_t)          </span>
<a name="l00131"></a><a class="code" href="cryptolinux_8h.html#a10">00131</a> <span class="preprocessor"></span><span class="preprocessor">#define CRYPT_ENABLE        _IOWR(CVM_MOD_EXP_BASE,2,cvm_crypto_op_t)         </span>
<a name="l00132"></a><a class="code" href="cryptolinux_8h.html#a11">00132</a> <span class="preprocessor"></span><span class="preprocessor">#define CRYPT_DISABLE       _IOWR(CVM_MOD_EXP_BASE,3,cvm_crypto_op_t)</span>
00133 <span class="preprocessor"></span>
00134 
00135 
00136 <span class="keywordtype">int</span> <a class="code" href="modexp_8c.html#a16">cvm_ModExp</a>(uint64_t *product, uint64_t *base, uint64_t *exponent, uint64_t *mod, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>,<span class="keywordtype">int</span> elen,<span class="keywordtype">int</span> mlen,<span class="keywordtype">int</span> blen);
00137 <span class="keywordtype">int</span> <a class="code" href="modexp_8c.html#a20">cvm_ModExpCrt</a>( uint64_t *product, uint64_t *base, <a class="code" href="structcvm__rsa__key.html">cvm_rsa_key_t</a> *rkey,<span class="keywordtype">int</span> nonwalign);
</pre></div><hr><address style="align: right;"><small>Generated on Mon Aug 14 19:59:36 2006 for Octeon Core Crypto API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
