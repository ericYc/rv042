<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>x509_vfy.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>x509_vfy.h</h1><a href="x509__vfy_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* crypto/x509/x509_vfy.h */</span>
00002 <span class="comment">/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)</span>
00003 <span class="comment"> * All rights reserved.</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> * This package is an SSL implementation written</span>
00006 <span class="comment"> * by Eric Young (eay@cryptsoft.com).</span>
00007 <span class="comment"> * The implementation was written so as to conform with Netscapes SSL.</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> * This library is free for commercial and non-commercial use as long as</span>
00010 <span class="comment"> * the following conditions are aheared to.  The following conditions</span>
00011 <span class="comment"> * apply to all code found in this distribution, be it the RC4, RSA,</span>
00012 <span class="comment"> * lhash, DES, etc., code; not just the SSL code.  The SSL documentation</span>
00013 <span class="comment"> * included with this distribution is covered by the same copyright terms</span>
00014 <span class="comment"> * except that the holder is Tim Hudson (tjh@cryptsoft.com).</span>
00015 <span class="comment"> * </span>
00016 <span class="comment"> * Copyright remains Eric Young's, and as such any Copyright notices in</span>
00017 <span class="comment"> * the code are not to be removed.</span>
00018 <span class="comment"> * If this package is used in a product, Eric Young should be given attribution</span>
00019 <span class="comment"> * as the author of the parts of the library used.</span>
00020 <span class="comment"> * This can be in the form of a textual message at program startup or</span>
00021 <span class="comment"> * in documentation (online or textual) provided with the package.</span>
00022 <span class="comment"> * </span>
00023 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
00024 <span class="comment"> * modification, are permitted provided that the following conditions</span>
00025 <span class="comment"> * are met:</span>
00026 <span class="comment"> * 1. Redistributions of source code must retain the copyright</span>
00027 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
00028 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
00029 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
00030 <span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
00031 <span class="comment"> * 3. All advertising materials mentioning features or use of this software</span>
00032 <span class="comment"> *    must display the following acknowledgement:</span>
00033 <span class="comment"> *    "This product includes cryptographic software written by</span>
00034 <span class="comment"> *     Eric Young (eay@cryptsoft.com)"</span>
00035 <span class="comment"> *    The word 'cryptographic' can be left out if the rouines from the library</span>
00036 <span class="comment"> *    being used are not cryptographic related :-).</span>
00037 <span class="comment"> * 4. If you include any Windows specific code (or a derivative thereof) from </span>
00038 <span class="comment"> *    the apps directory (application code) you must include an acknowledgement:</span>
00039 <span class="comment"> *    "This product includes software written by Tim Hudson (tjh@cryptsoft.com)"</span>
00040 <span class="comment"> * </span>
00041 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND</span>
00042 <span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00043 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
00044 <span class="comment"> * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE</span>
00045 <span class="comment"> * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
00046 <span class="comment"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span>
00047 <span class="comment"> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
00048 <span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
00049 <span class="comment"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
00050 <span class="comment"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
00051 <span class="comment"> * SUCH DAMAGE.</span>
00052 <span class="comment"> * </span>
00053 <span class="comment"> * The licence and distribution terms for any publically available version or</span>
00054 <span class="comment"> * derivative of this code cannot be changed.  i.e. this code cannot simply be</span>
00055 <span class="comment"> * copied and put under another distribution licence</span>
00056 <span class="comment"> * [including the GNU Public Licence.]</span>
00057 <span class="comment"> */</span>
00058 
00059 <span class="preprocessor">#ifndef HEADER_X509_H</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="x509_8h.html">openssl/x509.h</a>&gt;</span>
00061 <span class="comment">/* openssl/x509.h ends up #include-ing this file at about the only</span>
00062 <span class="comment"> * appropriate moment. */</span>
00063 <span class="preprocessor">#endif</span>
00064 <span class="preprocessor"></span>
00065 <span class="preprocessor">#ifndef HEADER_X509_VFY_H</span>
00066 <span class="preprocessor"></span><span class="preprocessor">#define HEADER_X509_VFY_H</span>
00067 <span class="preprocessor"></span>
00068 <span class="preprocessor">#ifndef OPENSSL_NO_LHASH</span>
00069 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="lhash_8h.html">openssl/lhash.h</a>&gt;</span>
00070 <span class="preprocessor">#endif</span>
00071 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="bio_8h.html">openssl/bio.h</a>&gt;</span>
00072 <span class="preprocessor">#include &lt;<a class="code" href="crypto_8h.html">openssl/crypto.h</a>&gt;</span>
00073 <span class="preprocessor">#include &lt;<a class="code" href="include_2openssl_2symhacks_8h.html">openssl/symhacks.h</a>&gt;</span>
00074 
00075 <span class="preprocessor">#ifdef  __cplusplus</span>
00076 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00077 <span class="preprocessor">#endif</span>
00078 <span class="preprocessor"></span>
00079 <span class="comment">/* Outer object */</span>
<a name="l00080"></a><a class="code" href="structx509__hash__dir__st.html">00080</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structx509__hash__dir__st.html">x509_hash_dir_st</a>
00081     {
<a name="l00082"></a><a class="code" href="structx509__hash__dir__st.html#m0">00082</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__hash__dir__st.html#m0">num_dirs</a>;
<a name="l00083"></a><a class="code" href="structx509__hash__dir__st.html#m1">00083</a>     <span class="keywordtype">char</span> **<a class="code" href="structx509__hash__dir__st.html#m1">dirs</a>;
<a name="l00084"></a><a class="code" href="structx509__hash__dir__st.html#m2">00084</a>     <span class="keywordtype">int</span> *<a class="code" href="structx509__hash__dir__st.html#m2">dirs_type</a>;
<a name="l00085"></a><a class="code" href="structx509__hash__dir__st.html#m3">00085</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__hash__dir__st.html#m3">num_dirs_alloced</a>;
00086     } <a class="code" href="structx509__hash__dir__st.html">X509_HASH_DIR_CTX</a>;
00087 
<a name="l00088"></a><a class="code" href="structx509__file__st.html">00088</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structx509__file__st.html">x509_file_st</a>
00089     {
<a name="l00090"></a><a class="code" href="structx509__file__st.html#m0">00090</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__file__st.html#m0">num_paths</a>;  <span class="comment">/* number of paths to files or directories */</span>
<a name="l00091"></a><a class="code" href="structx509__file__st.html#m1">00091</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__file__st.html#m1">num_alloced</a>;
<a name="l00092"></a><a class="code" href="structx509__file__st.html#m2">00092</a>     <span class="keywordtype">char</span> **<a class="code" href="structx509__file__st.html#m2">paths</a>;   <span class="comment">/* the list of paths or directories */</span>
<a name="l00093"></a><a class="code" href="structx509__file__st.html#m3">00093</a>     <span class="keywordtype">int</span> *<a class="code" href="structx509__file__st.html#m3">path_type</a>;
00094     } <a class="code" href="structx509__file__st.html">X509_CERT_FILE_CTX</a>;
00095 
00096 <span class="comment">/*******************************/</span>
00097 <span class="comment">/*</span>
00098 <span class="comment">SSL_CTX -&gt; X509_STORE    </span>
00099 <span class="comment">        -&gt; X509_LOOKUP</span>
00100 <span class="comment">            -&gt;X509_LOOKUP_METHOD</span>
00101 <span class="comment">        -&gt; X509_LOOKUP</span>
00102 <span class="comment">            -&gt;X509_LOOKUP_METHOD</span>
00103 <span class="comment"> </span>
00104 <span class="comment">SSL -&gt; X509_STORE_CTX</span>
00105 <span class="comment">        -&gt;X509_STORE    </span>
00106 <span class="comment"></span>
00107 <span class="comment">The X509_STORE holds the tables etc for verification stuff.</span>
00108 <span class="comment">A X509_STORE_CTX is used while validating a single certificate.</span>
00109 <span class="comment">The X509_STORE has X509_LOOKUPs for looking up certs.</span>
00110 <span class="comment">The X509_STORE then calls a function to actually verify the</span>
00111 <span class="comment">certificate chain.</span>
00112 <span class="comment">*/</span>
00113 
<a name="l00114"></a><a class="code" href="x509__vfy_8h.html#a0">00114</a> <span class="preprocessor">#define X509_LU_RETRY       -1</span>
<a name="l00115"></a><a class="code" href="x509__vfy_8h.html#a1">00115</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_LU_FAIL        0</span>
<a name="l00116"></a><a class="code" href="x509__vfy_8h.html#a2">00116</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_LU_X509        1</span>
<a name="l00117"></a><a class="code" href="x509__vfy_8h.html#a3">00117</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_LU_CRL     2</span>
<a name="l00118"></a><a class="code" href="x509__vfy_8h.html#a4">00118</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_LU_PKEY        3</span>
00119 <span class="preprocessor"></span>
<a name="l00120"></a><a class="code" href="structx509__object__st.html">00120</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structx509__object__st.html">x509_object_st</a>
00121     {
00122     <span class="comment">/* one of the above types */</span>
<a name="l00123"></a><a class="code" href="structx509__object__st.html#m0">00123</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__object__st.html#m0">type</a>;
00124     <span class="keyword">union   </span>{
<a name="l00125"></a><a class="code" href="structx509__object__st.html#m1">00125</a>         <span class="keywordtype">char</span> *<a class="code" href="structx509__object__st.html#m1">ptr</a>;
<a name="l00126"></a><a class="code" href="structx509__object__st.html#m2">00126</a>         <a class="code" href="structx509__st.html">X509</a> *<a class="code" href="structx509__object__st.html#m2">x509</a>;
<a name="l00127"></a><a class="code" href="structx509__object__st.html#m3">00127</a>         <a class="code" href="structX509__crl__st.html">X509_CRL</a> *<a class="code" href="structx509__object__st.html#m3">crl</a>;
<a name="l00128"></a><a class="code" href="structx509__object__st.html#m4">00128</a>         <a class="code" href="structevp__pkey__st.html">EVP_PKEY</a> *<a class="code" href="structx509__object__st.html#m4">pkey</a>;
00129         } <a class="code" href="structx509__object__st.html#m5">data</a>;
00130     } <a class="code" href="structx509__object__st.html">X509_OBJECT</a>;
00131 
<a name="l00132"></a><a class="code" href="x509__vfy_8h.html#a61">00132</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structx509__lookup__st.html">x509_lookup_st</a> X509_LOOKUP;
00133 
00134 <a class="code" href="safestack_8h.html#a2">DECLARE_STACK_OF</a>(X509_LOOKUP)
00135 <a class="code" href="safestack_8h.html#a2">DECLARE_STACK_OF</a>(<a class="code" href="structx509__object__st.html">X509_OBJECT</a>)
00136 
00137 <span class="comment">/* This is a static that defines the function interface */</span>
<a name="l00138"></a><a class="code" href="structx509__lookup__method__st.html">00138</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structx509__lookup__method__st.html">x509_lookup_method_st</a>
00139     {
<a name="l00140"></a><a class="code" href="structx509__lookup__method__st.html#m0">00140</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structx509__lookup__method__st.html#m0">name</a>;
00141     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__lookup__method__st.html#m1">new_item</a>)(X509_LOOKUP *ctx);
00142     <a class="code" href="cryptlib_8c.html#a8">void</a> (*<a class="code" href="structx509__lookup__method__st.html#m2">free</a>)(X509_LOOKUP *ctx);
00143     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__lookup__method__st.html#m3">init</a>)(X509_LOOKUP *ctx);
00144     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__lookup__method__st.html#m4">shutdown</a>)(X509_LOOKUP *ctx);
00145     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__lookup__method__st.html#m5">ctrl</a>)(X509_LOOKUP *ctx,<span class="keywordtype">int</span> cmd,<span class="keyword">const</span> <span class="keywordtype">char</span> *argc,<span class="keywordtype">long</span> argl,
00146             <span class="keywordtype">char</span> **ret);
00147     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__lookup__method__st.html#m6">get_by_subject</a>)(X509_LOOKUP *ctx,<span class="keywordtype">int</span> type,<a class="code" href="structX509__name__st.html">X509_NAME</a> *<a class="code" href="structx509__lookup__method__st.html#m0">name</a>,
00148                   <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00149     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__lookup__method__st.html#m7">get_by_issuer_serial</a>)(X509_LOOKUP *ctx,<span class="keywordtype">int</span> type,<a class="code" href="structX509__name__st.html">X509_NAME</a> *<a class="code" href="structx509__lookup__method__st.html#m0">name</a>,
00150                     <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *serial,<a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00151     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__lookup__method__st.html#m8">get_by_fingerprint</a>)(X509_LOOKUP *ctx,<span class="keywordtype">int</span> type,
00152                   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="x509_8h.html#a175">bytes</a>,<span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>,
00153                   <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00154     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__lookup__method__st.html#m9">get_by_alias</a>)(X509_LOOKUP *ctx,<span class="keywordtype">int</span> type,<span class="keywordtype">char</span> *str,<span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>,
00155                 <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00156     } <a class="code" href="structx509__lookup__method__st.html">X509_LOOKUP_METHOD</a>;
00157 
00158 <span class="comment">/* This is used to hold everything.  It is used for all certificate</span>
00159 <span class="comment"> * validation.  Once we have a certificate chain, the 'verify'</span>
00160 <span class="comment"> * function is then called to actually check the cert chain. */</span>
<a name="l00161"></a><a class="code" href="structx509__store__st.html">00161</a> <span class="keyword">struct </span><a class="code" href="structx509__store__st.html">x509_store_st</a>
00162     {
00163     <span class="comment">/* The following is a cache of trusted certs */</span>
<a name="l00164"></a><a class="code" href="structx509__store__st.html#m0">00164</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__st.html#m0">cache</a>;  <span class="comment">/* if true, stash any hits */</span>
00165     <a class="code" href="structx509__store__st.html#a0">STACK_OF</a>(<a class="code" href="structx509__object__st.html">X509_OBJECT</a>) *objs;    <span class="comment">/* Cache of all objects */</span>
00166 
00167     <span class="comment">/* These are external lookup methods */</span>
00168     <a class="code" href="structx509__store__st.html#a0">STACK_OF</a>(X509_LOOKUP) *get_cert_methods;
00169 
00170     <span class="comment">/* The following fields are not used by X509_STORE but are</span>
00171 <span class="comment">         * inherited by X509_STORE_CTX when it is initialised.</span>
00172 <span class="comment">     */</span>
00173 
<a name="l00174"></a><a class="code" href="structx509__store__st.html#m1">00174</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structx509__store__st.html#m1">flags</a>;    <span class="comment">/* Various verify flags */</span>
<a name="l00175"></a><a class="code" href="structx509__store__st.html#m2">00175</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__st.html#m2">purpose</a>;
<a name="l00176"></a><a class="code" href="structx509__store__st.html#m3">00176</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__st.html#m3">trust</a>;
00177     <span class="comment">/* Callbacks for various operations */</span>
00178     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m4">verify</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx); <span class="comment">/* called to verify a certificate */</span>
00179     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m5">verify_cb</a>)(<span class="keywordtype">int</span> ok,<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);   <span class="comment">/* error callback */</span>
00180     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m6">get_issuer</a>)(<a class="code" href="structx509__st.html">X509</a> **issuer, <a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structx509__st.html">X509</a> *x); <span class="comment">/* get issuers cert from ctx */</span>
00181     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m7">check_issued</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structx509__st.html">X509</a> *x, <a class="code" href="structx509__st.html">X509</a> *issuer); <span class="comment">/* check issued */</span>
00182     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m8">check_revocation</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx); <span class="comment">/* Check revocation status of chain */</span>
00183     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m9">get_crl</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structX509__crl__st.html">X509_CRL</a> **crl, <a class="code" href="structx509__st.html">X509</a> *x); <span class="comment">/* retrieve CRL */</span>
00184     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m10">check_crl</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structX509__crl__st.html">X509_CRL</a> *crl); <span class="comment">/* Check CRL validity */</span>
00185     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m11">cert_crl</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structX509__crl__st.html">X509_CRL</a> *crl, <a class="code" href="structx509__st.html">X509</a> *x); <span class="comment">/* Check certificate against CRL */</span>
00186     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__st.html#m12">cleanup</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00187 
<a name="l00188"></a><a class="code" href="structx509__store__st.html#m13">00188</a>     <a class="code" href="structcrypto__ex__data__st.html">CRYPTO_EX_DATA</a> <a class="code" href="structx509__store__st.html#m13">ex_data</a>;
<a name="l00189"></a><a class="code" href="structx509__store__st.html#m14">00189</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__st.html#m14">references</a>;
<a name="l00190"></a><a class="code" href="structx509__store__st.html#m15">00190</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__st.html#m15">depth</a>;      <span class="comment">/* how deep to look (still unused -- X509_STORE_CTX's depth is used) */</span>
00191     } <span class="comment">/* X509_STORE */</span>;
00192 
<a name="l00193"></a><a class="code" href="x509__vfy_8h.html#a5">00193</a> <span class="preprocessor">#define X509_STORE_set_depth(ctx,d)       ((ctx)-&gt;depth=(d))</span>
00194 <span class="preprocessor"></span>
<a name="l00195"></a><a class="code" href="x509__vfy_8h.html#a6">00195</a> <span class="preprocessor">#define X509_STORE_set_verify_cb_func(ctx,func) ((ctx)-&gt;verify_cb=(func))</span>
<a name="l00196"></a><a class="code" href="x509__vfy_8h.html#a7">00196</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_STORE_set_verify_func(ctx,func)    ((ctx)-&gt;verify=(func))</span>
00197 <span class="preprocessor"></span>
00198 <span class="comment">/* This is the functions plus an instance of the local variables. */</span>
<a name="l00199"></a><a class="code" href="structx509__lookup__st.html">00199</a> <span class="keyword">struct </span><a class="code" href="structx509__lookup__st.html">x509_lookup_st</a>
00200     {
<a name="l00201"></a><a class="code" href="structx509__lookup__st.html#m0">00201</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__lookup__st.html#m0">init</a>;           <span class="comment">/* have we been started */</span>
<a name="l00202"></a><a class="code" href="structx509__lookup__st.html#m1">00202</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__lookup__st.html#m1">skip</a>;           <span class="comment">/* don't use us. */</span>
<a name="l00203"></a><a class="code" href="structx509__lookup__st.html#m2">00203</a>     <a class="code" href="structx509__lookup__method__st.html">X509_LOOKUP_METHOD</a> *<a class="code" href="structx509__lookup__st.html#m2">method</a>; <span class="comment">/* the functions */</span>
<a name="l00204"></a><a class="code" href="structx509__lookup__st.html#m3">00204</a>     <span class="keywordtype">char</span> *<a class="code" href="structx509__lookup__st.html#m3">method_data</a>;      <span class="comment">/* method data */</span>
00205 
<a name="l00206"></a><a class="code" href="structx509__lookup__st.html#m4">00206</a>     <a class="code" href="structx509__store__st.html">X509_STORE</a> *<a class="code" href="structx509__lookup__st.html#m4">store_ctx</a>;  <span class="comment">/* who owns us */</span>
00207     } <span class="comment">/* X509_LOOKUP */</span>;
00208 
00209 <span class="comment">/* This is a used when verifying cert chains.  Since the</span>
00210 <span class="comment"> * gathering of the cert chain can take some time (and have to be</span>
00211 <span class="comment"> * 'retried', this needs to be kept and passed around. */</span>
<a name="l00212"></a><a class="code" href="structx509__store__ctx__st.html">00212</a> <span class="keyword">struct </span><a class="code" href="structx509__store__ctx__st.html">x509_store_ctx_st</a>      <span class="comment">/* X509_STORE_CTX */</span>
00213     {
<a name="l00214"></a><a class="code" href="structx509__store__ctx__st.html#m0">00214</a>     <a class="code" href="structx509__store__st.html">X509_STORE</a> *<a class="code" href="structx509__store__ctx__st.html#m0">ctx</a>;
<a name="l00215"></a><a class="code" href="structx509__store__ctx__st.html#m1">00215</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__ctx__st.html#m1">current_method</a>; <span class="comment">/* used when looking up certs */</span>
00216 
00217     <span class="comment">/* The following are set by the caller */</span>
<a name="l00218"></a><a class="code" href="structx509__store__ctx__st.html#m2">00218</a>     <a class="code" href="structx509__st.html">X509</a> *<a class="code" href="structx509__store__ctx__st.html#m2">cert</a>;     <span class="comment">/* The cert to check */</span>
00219     <a class="code" href="structx509__store__ctx__st.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *untrusted;  <span class="comment">/* chain of X509s - untrusted - passed in */</span>
<a name="l00220"></a><a class="code" href="structx509__store__ctx__st.html#m3">00220</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__ctx__st.html#m3">purpose</a>;        <span class="comment">/* purpose to check untrusted certificates */</span>
<a name="l00221"></a><a class="code" href="structx509__store__ctx__st.html#m4">00221</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__ctx__st.html#m4">trust</a>;      <span class="comment">/* trust setting to check */</span>
<a name="l00222"></a><a class="code" href="structx509__store__ctx__st.html#m5">00222</a>     time_t  <a class="code" href="structx509__store__ctx__st.html#m5">check_time</a>; <span class="comment">/* time to make verify at */</span>
<a name="l00223"></a><a class="code" href="structx509__store__ctx__st.html#m6">00223</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structx509__store__ctx__st.html#m6">flags</a>;    <span class="comment">/* Various verify flags */</span>
<a name="l00224"></a><a class="code" href="structx509__store__ctx__st.html#m7">00224</a>     <span class="keywordtype">void</span> *<a class="code" href="structx509__store__ctx__st.html#m7">other_ctx</a>;    <span class="comment">/* Other info for use with get_issuer() */</span>
00225 
00226     <span class="comment">/* Callbacks for various operations */</span>
00227     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m8">verify</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx); <span class="comment">/* called to verify a certificate */</span>
00228     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m9">verify_cb</a>)(<span class="keywordtype">int</span> ok,<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);       <span class="comment">/* error callback */</span>
00229     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m10">get_issuer</a>)(<a class="code" href="structx509__st.html">X509</a> **issuer, <a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structx509__st.html">X509</a> *x); <span class="comment">/* get issuers cert from ctx */</span>
00230     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m11">check_issued</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structx509__st.html">X509</a> *x, <a class="code" href="structx509__st.html">X509</a> *issuer); <span class="comment">/* check issued */</span>
00231     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m12">check_revocation</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx); <span class="comment">/* Check revocation status of chain */</span>
00232     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m13">get_crl</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structX509__crl__st.html">X509_CRL</a> **crl, <a class="code" href="structx509__st.html">X509</a> *x); <span class="comment">/* retrieve CRL */</span>
00233     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m14">check_crl</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structX509__crl__st.html">X509_CRL</a> *crl); <span class="comment">/* Check CRL validity */</span>
00234     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m15">cert_crl</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structX509__crl__st.html">X509_CRL</a> *crl, <a class="code" href="structx509__st.html">X509</a> *x); <span class="comment">/* Check certificate against CRL */</span>
00235     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structx509__store__ctx__st.html#m16">cleanup</a>)(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00236 
00237     <span class="comment">/* The following is built up */</span>
<a name="l00238"></a><a class="code" href="structx509__store__ctx__st.html#m17">00238</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__ctx__st.html#m17">depth</a>;      <span class="comment">/* how far to go looking up certs */</span>
<a name="l00239"></a><a class="code" href="structx509__store__ctx__st.html#m18">00239</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__ctx__st.html#m18">valid</a>;      <span class="comment">/* if 0, rebuild chain */</span>
<a name="l00240"></a><a class="code" href="structx509__store__ctx__st.html#m19">00240</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__ctx__st.html#m19">last_untrusted</a>; <span class="comment">/* index of last untrusted cert */</span>
00241     <a class="code" href="structx509__store__ctx__st.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *chain;      <span class="comment">/* chain of X509s - built up and trusted */</span>
00242 
00243     <span class="comment">/* When something goes wrong, this is why */</span>
<a name="l00244"></a><a class="code" href="structx509__store__ctx__st.html#m20">00244</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__ctx__st.html#m20">error_depth</a>;
<a name="l00245"></a><a class="code" href="structx509__store__ctx__st.html#m21">00245</a>     <span class="keywordtype">int</span> <a class="code" href="structx509__store__ctx__st.html#m21">error</a>;
<a name="l00246"></a><a class="code" href="structx509__store__ctx__st.html#m22">00246</a>     <a class="code" href="structx509__st.html">X509</a> *<a class="code" href="structx509__store__ctx__st.html#m22">current_cert</a>;
<a name="l00247"></a><a class="code" href="structx509__store__ctx__st.html#m23">00247</a>     <a class="code" href="structx509__st.html">X509</a> *<a class="code" href="structx509__store__ctx__st.html#m23">current_issuer</a>;   <span class="comment">/* cert currently being tested as valid issuer */</span>
<a name="l00248"></a><a class="code" href="structx509__store__ctx__st.html#m24">00248</a>     <a class="code" href="structX509__crl__st.html">X509_CRL</a> *<a class="code" href="structx509__store__ctx__st.html#m24">current_crl</a>;  <span class="comment">/* current CRL */</span>
00249 
<a name="l00250"></a><a class="code" href="structx509__store__ctx__st.html#m25">00250</a>     <a class="code" href="structcrypto__ex__data__st.html">CRYPTO_EX_DATA</a> <a class="code" href="structx509__store__ctx__st.html#m25">ex_data</a>;
00251     } <span class="comment">/* X509_STORE_CTX */</span>;
00252 
<a name="l00253"></a><a class="code" href="x509__vfy_8h.html#a8">00253</a> <span class="preprocessor">#define X509_STORE_CTX_set_depth(ctx,d)       ((ctx)-&gt;depth=(d))</span>
00254 <span class="preprocessor"></span>
<a name="l00255"></a><a class="code" href="x509__vfy_8h.html#a9">00255</a> <span class="preprocessor">#define X509_STORE_CTX_set_app_data(ctx,data) \</span>
00256 <span class="preprocessor">    X509_STORE_CTX_set_ex_data(ctx,0,data)</span>
<a name="l00257"></a><a class="code" href="x509__vfy_8h.html#a10">00257</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_STORE_CTX_get_app_data(ctx) \</span>
00258 <span class="preprocessor">    X509_STORE_CTX_get_ex_data(ctx,0)</span>
00259 <span class="preprocessor"></span>
<a name="l00260"></a><a class="code" href="x509__vfy_8h.html#a11">00260</a> <span class="preprocessor">#define X509_L_FILE_LOAD    1</span>
<a name="l00261"></a><a class="code" href="x509__vfy_8h.html#a12">00261</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_L_ADD_DIR      2</span>
00262 <span class="preprocessor"></span>
<a name="l00263"></a><a class="code" href="x509__vfy_8h.html#a13">00263</a> <span class="preprocessor">#define X509_LOOKUP_load_file(x,name,type) \</span>
00264 <span class="preprocessor">        X509_LOOKUP_ctrl((x),X509_L_FILE_LOAD,(name),(long)(type),NULL)</span>
00265 <span class="preprocessor"></span>
<a name="l00266"></a><a class="code" href="x509__vfy_8h.html#a14">00266</a> <span class="preprocessor">#define X509_LOOKUP_add_dir(x,name,type) \</span>
00267 <span class="preprocessor">        X509_LOOKUP_ctrl((x),X509_L_ADD_DIR,(name),(long)(type),NULL)</span>
00268 <span class="preprocessor"></span>
<a name="l00269"></a><a class="code" href="x509__vfy_8h.html#a15">00269</a> <span class="preprocessor">#define     X509_V_OK                   0</span>
00270 <span class="preprocessor"></span><span class="comment">/* illegal error (for uninitialized values, to avoid X509_V_OK): 1 */</span>
00271 
<a name="l00272"></a><a class="code" href="x509__vfy_8h.html#a16">00272</a> <span class="preprocessor">#define     X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT        2</span>
<a name="l00273"></a><a class="code" href="x509__vfy_8h.html#a17">00273</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_UNABLE_TO_GET_CRL            3</span>
<a name="l00274"></a><a class="code" href="x509__vfy_8h.html#a18">00274</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE 4</span>
<a name="l00275"></a><a class="code" href="x509__vfy_8h.html#a19">00275</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE  5</span>
<a name="l00276"></a><a class="code" href="x509__vfy_8h.html#a20">00276</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY   6</span>
<a name="l00277"></a><a class="code" href="x509__vfy_8h.html#a21">00277</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CERT_SIGNATURE_FAILURE       7</span>
<a name="l00278"></a><a class="code" href="x509__vfy_8h.html#a22">00278</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CRL_SIGNATURE_FAILURE        8</span>
<a name="l00279"></a><a class="code" href="x509__vfy_8h.html#a23">00279</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CERT_NOT_YET_VALID           9   </span>
<a name="l00280"></a><a class="code" href="x509__vfy_8h.html#a24">00280</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CERT_HAS_EXPIRED         10</span>
<a name="l00281"></a><a class="code" href="x509__vfy_8h.html#a25">00281</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CRL_NOT_YET_VALID            11</span>
<a name="l00282"></a><a class="code" href="x509__vfy_8h.html#a26">00282</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CRL_HAS_EXPIRED          12</span>
<a name="l00283"></a><a class="code" href="x509__vfy_8h.html#a27">00283</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD   13</span>
<a name="l00284"></a><a class="code" href="x509__vfy_8h.html#a28">00284</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD    14</span>
<a name="l00285"></a><a class="code" href="x509__vfy_8h.html#a29">00285</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD   15</span>
<a name="l00286"></a><a class="code" href="x509__vfy_8h.html#a30">00286</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD   16</span>
<a name="l00287"></a><a class="code" href="x509__vfy_8h.html#a31">00287</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_OUT_OF_MEM               17</span>
<a name="l00288"></a><a class="code" href="x509__vfy_8h.html#a32">00288</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT      18</span>
<a name="l00289"></a><a class="code" href="x509__vfy_8h.html#a33">00289</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN        19</span>
<a name="l00290"></a><a class="code" href="x509__vfy_8h.html#a34">00290</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY    20</span>
<a name="l00291"></a><a class="code" href="x509__vfy_8h.html#a35">00291</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE  21</span>
<a name="l00292"></a><a class="code" href="x509__vfy_8h.html#a36">00292</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CERT_CHAIN_TOO_LONG          22</span>
<a name="l00293"></a><a class="code" href="x509__vfy_8h.html#a37">00293</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CERT_REVOKED             23</span>
<a name="l00294"></a><a class="code" href="x509__vfy_8h.html#a38">00294</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_INVALID_CA               24</span>
<a name="l00295"></a><a class="code" href="x509__vfy_8h.html#a39">00295</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_PATH_LENGTH_EXCEEDED         25</span>
<a name="l00296"></a><a class="code" href="x509__vfy_8h.html#a40">00296</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_INVALID_PURPOSE          26</span>
<a name="l00297"></a><a class="code" href="x509__vfy_8h.html#a41">00297</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CERT_UNTRUSTED           27</span>
<a name="l00298"></a><a class="code" href="x509__vfy_8h.html#a42">00298</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_CERT_REJECTED            28</span>
00299 <span class="preprocessor"></span><span class="comment">/* These are 'informational' when looking for issuer cert */</span>
<a name="l00300"></a><a class="code" href="x509__vfy_8h.html#a43">00300</a> <span class="preprocessor">#define     X509_V_ERR_SUBJECT_ISSUER_MISMATCH      29</span>
<a name="l00301"></a><a class="code" href="x509__vfy_8h.html#a44">00301</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_AKID_SKID_MISMATCH           30</span>
<a name="l00302"></a><a class="code" href="x509__vfy_8h.html#a45">00302</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH      31</span>
<a name="l00303"></a><a class="code" href="x509__vfy_8h.html#a46">00303</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_KEYUSAGE_NO_CERTSIGN         32</span>
00304 <span class="preprocessor"></span>
<a name="l00305"></a><a class="code" href="x509__vfy_8h.html#a47">00305</a> <span class="preprocessor">#define     X509_V_ERR_UNABLE_TO_GET_CRL_ISSUER     33</span>
<a name="l00306"></a><a class="code" href="x509__vfy_8h.html#a48">00306</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_UNHANDLED_CRITICAL_EXTENSION     34</span>
<a name="l00307"></a><a class="code" href="x509__vfy_8h.html#a49">00307</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_KEYUSAGE_NO_CRL_SIGN         35</span>
<a name="l00308"></a><a class="code" href="x509__vfy_8h.html#a50">00308</a> <span class="preprocessor"></span><span class="preprocessor">#define     X509_V_ERR_UNHANDLED_CRITICAL_CRL_EXTENSION 36</span>
00309 <span class="preprocessor"></span>
00310 <span class="comment">/* The application is not happy */</span>
<a name="l00311"></a><a class="code" href="x509__vfy_8h.html#a51">00311</a> <span class="preprocessor">#define     X509_V_ERR_APPLICATION_VERIFICATION     50</span>
00312 <span class="preprocessor"></span>
00313 <span class="comment">/* Certificate verify flags */</span>
00314 
00315 <span class="comment">/* Send issuer+subject checks to verify_cb */</span>
<a name="l00316"></a><a class="code" href="x509__vfy_8h.html#a52">00316</a> <span class="preprocessor">#define X509_V_FLAG_CB_ISSUER_CHECK     0x1</span>
00317 <span class="preprocessor"></span><span class="comment">/* Use check time instead of current time */</span>
<a name="l00318"></a><a class="code" href="x509__vfy_8h.html#a53">00318</a> <span class="preprocessor">#define X509_V_FLAG_USE_CHECK_TIME      0x2</span>
00319 <span class="preprocessor"></span><span class="comment">/* Lookup CRLs */</span>
<a name="l00320"></a><a class="code" href="x509__vfy_8h.html#a54">00320</a> <span class="preprocessor">#define X509_V_FLAG_CRL_CHECK           0x4</span>
00321 <span class="preprocessor"></span><span class="comment">/* Lookup CRLs for whole chain */</span>
<a name="l00322"></a><a class="code" href="x509__vfy_8h.html#a55">00322</a> <span class="preprocessor">#define X509_V_FLAG_CRL_CHECK_ALL       0x8</span>
00323 <span class="preprocessor"></span><span class="comment">/* Ignore unhandled critical extensions */</span>
<a name="l00324"></a><a class="code" href="x509__vfy_8h.html#a56">00324</a> <span class="preprocessor">#define X509_V_FLAG_IGNORE_CRITICAL     0x10</span>
00325 <span class="preprocessor"></span><span class="comment">/* Disable workarounds for broken certificates */</span>
<a name="l00326"></a><a class="code" href="x509__vfy_8h.html#a57">00326</a> <span class="preprocessor">#define X509_V_FLAG_X509_STRICT         0x20</span>
00327 <span class="preprocessor"></span>
00328 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a19">X509_OBJECT_idx_by_subject</a>(<a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__object__st.html">X509_OBJECT</a>) *h, <span class="keywordtype">int</span> type,
00329          <a class="code" href="structX509__name__st.html">X509_NAME</a> *name);
00330 <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *<a class="code" href="x509__lu_8c.html#a20">X509_OBJECT_retrieve_by_subject</a>(<a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__object__st.html">X509_OBJECT</a>) *h,<span class="keywordtype">int</span> type,<a class="code" href="structX509__name__st.html">X509_NAME</a> *name);
00331 <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *<a class="code" href="x509__lu_8c.html#a21">X509_OBJECT_retrieve_match</a>(<a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__object__st.html">X509_OBJECT</a>) *h, <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *x);
00332 <span class="keywordtype">void</span> <a class="code" href="x509__lu_8c.html#a17">X509_OBJECT_up_ref_count</a>(<a class="code" href="structx509__object__st.html">X509_OBJECT</a> *<a class="code" href="v3__extku_8c.html#a3">a</a>);
00333 <span class="keywordtype">void</span> <a class="code" href="x509__lu_8c.html#a18">X509_OBJECT_free_contents</a>(<a class="code" href="structx509__object__st.html">X509_OBJECT</a> *<a class="code" href="v3__extku_8c.html#a3">a</a>);
00334 <a class="code" href="structx509__store__st.html">X509_STORE</a> *<a class="code" href="x509__lu_8c.html#a10">X509_STORE_new</a>(<span class="keywordtype">void</span> );
00335 <span class="keywordtype">void</span> <a class="code" href="x509__lu_8c.html#a12">X509_STORE_free</a>(<a class="code" href="structx509__store__st.html">X509_STORE</a> *v);
00336 
00337 <span class="keywordtype">void</span> <a class="code" href="x509__lu_8c.html#a23">X509_STORE_set_flags</a>(<a class="code" href="structx509__store__st.html">X509_STORE</a> *ctx, <span class="keywordtype">long</span> flags);
00338 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a24">X509_STORE_set_purpose</a>(<a class="code" href="structx509__store__st.html">X509_STORE</a> *ctx, <span class="keywordtype">int</span> purpose);
00339 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a25">X509_STORE_set_trust</a>(<a class="code" href="structx509__store__st.html">X509_STORE</a> *ctx, <span class="keywordtype">int</span> trust);
00340 
00341 <a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *<a class="code" href="x509__vfy_8c.html#a32">X509_STORE_CTX_new</a>(<span class="keywordtype">void</span>);
00342 
00343 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a22">X509_STORE_CTX_get1_issuer</a>(<a class="code" href="structx509__st.html">X509</a> **issuer, <a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structx509__st.html">X509</a> *x);
00344 
00345 <span class="keywordtype">void</span> <a class="code" href="x509__vfy_8c.html#a33">X509_STORE_CTX_free</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00346 <span class="keywordtype">int</span> <a class="code" href="x509__vfy_8c.html#a34">X509_STORE_CTX_init</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="structx509__store__st.html">X509_STORE</a> *store,
00347              <a class="code" href="structx509__st.html">X509</a> *x509, <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *chain);
00348 <span class="keywordtype">void</span> <a class="code" href="x509__vfy_8c.html#a35">X509_STORE_CTX_trusted_stack</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *sk);
00349 <span class="keywordtype">void</span> <a class="code" href="x509__vfy_8c.html#a36">X509_STORE_CTX_cleanup</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00350 
00351 X509_LOOKUP *<a class="code" href="x509__lu_8c.html#a13">X509_STORE_add_lookup</a>(<a class="code" href="structx509__store__st.html">X509_STORE</a> *v, <a class="code" href="structx509__lookup__method__st.html">X509_LOOKUP_METHOD</a> *m);
00352 
00353 <a class="code" href="structx509__lookup__method__st.html">X509_LOOKUP_METHOD</a> *<a class="code" href="by__dir_8c.html#a7">X509_LOOKUP_hash_dir</a>(<span class="keywordtype">void</span>);
00354 <a class="code" href="structx509__lookup__method__st.html">X509_LOOKUP_METHOD</a> *<a class="code" href="by__file_8c.html#a2">X509_LOOKUP_file</a>(<span class="keywordtype">void</span>);
00355 
00356 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a15">X509_STORE_add_cert</a>(<a class="code" href="structx509__store__st.html">X509_STORE</a> *ctx, <a class="code" href="structx509__st.html">X509</a> *x);
00357 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a16">X509_STORE_add_crl</a>(<a class="code" href="structx509__store__st.html">X509_STORE</a> *ctx, <a class="code" href="structX509__crl__st.html">X509_CRL</a> *x);
00358 
00359 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a14">X509_STORE_get_by_subject</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *vs,<span class="keywordtype">int</span> type,<a class="code" href="structX509__name__st.html">X509_NAME</a> *name,
00360     <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00361 
00362 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a4">X509_LOOKUP_ctrl</a>(X509_LOOKUP *ctx, <span class="keywordtype">int</span> cmd, <span class="keyword">const</span> <span class="keywordtype">char</span> *argc,
00363     <span class="keywordtype">long</span> argl, <span class="keywordtype">char</span> **ret);
00364 
00365 <span class="preprocessor">#ifndef OPENSSL_NO_STDIO</span>
00366 <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="by__file_8c.html#a3">X509_load_cert_file</a>(X509_LOOKUP *ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cryptlib_8c.html#a3">file</a>, <span class="keywordtype">int</span> type);
00367 <span class="keywordtype">int</span> <a class="code" href="by__file_8c.html#a4">X509_load_crl_file</a>(X509_LOOKUP *ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cryptlib_8c.html#a3">file</a>, <span class="keywordtype">int</span> type);
00368 <span class="keywordtype">int</span> <a class="code" href="by__file_8c.html#a5">X509_load_cert_crl_file</a>(X509_LOOKUP *ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cryptlib_8c.html#a3">file</a>, <span class="keywordtype">int</span> type);
00369 <span class="preprocessor">#endif</span>
00370 <span class="preprocessor"></span>
00371 
00372 X509_LOOKUP *<a class="code" href="x509__lu_8c.html#a0">X509_LOOKUP_new</a>(<a class="code" href="structx509__lookup__method__st.html">X509_LOOKUP_METHOD</a> *method);
00373 <span class="keywordtype">void</span> <a class="code" href="x509__lu_8c.html#a1">X509_LOOKUP_free</a>(X509_LOOKUP *ctx);
00374 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a2">X509_LOOKUP_init</a>(X509_LOOKUP *ctx);
00375 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a5">X509_LOOKUP_by_subject</a>(X509_LOOKUP *ctx, <span class="keywordtype">int</span> type, <a class="code" href="structX509__name__st.html">X509_NAME</a> *name,
00376     <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00377 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a6">X509_LOOKUP_by_issuer_serial</a>(X509_LOOKUP *ctx, <span class="keywordtype">int</span> type, <a class="code" href="structX509__name__st.html">X509_NAME</a> *name,
00378     <a class="code" href="structasn1__string__st.html">ASN1_INTEGER</a> *serial, <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00379 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a7">X509_LOOKUP_by_fingerprint</a>(X509_LOOKUP *ctx, <span class="keywordtype">int</span> type,
00380     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="x509_8h.html#a175">bytes</a>, <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>, <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00381 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a8">X509_LOOKUP_by_alias</a>(X509_LOOKUP *ctx, <span class="keywordtype">int</span> type, <span class="keywordtype">char</span> *str,
00382     <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a176">len</a>, <a class="code" href="structx509__object__st.html">X509_OBJECT</a> *ret);
00383 <span class="keywordtype">int</span> <a class="code" href="x509__lu_8c.html#a3">X509_LOOKUP_shutdown</a>(X509_LOOKUP *ctx);
00384 
00385 <span class="preprocessor">#ifndef OPENSSL_NO_STDIO</span>
00386 <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="x509__d2_8c.html#a1">X509_STORE_load_locations</a> (<a class="code" href="structx509__store__st.html">X509_STORE</a> *ctx,
00387         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cryptlib_8c.html#a3">file</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *dir);
00388 <span class="keywordtype">int</span> <a class="code" href="x509__d2_8c.html#a0">X509_STORE_set_default_paths</a>(<a class="code" href="structx509__store__st.html">X509_STORE</a> *ctx);
00389 <span class="preprocessor">#endif</span>
00390 <span class="preprocessor"></span>
00391 <span class="keywordtype">int</span> <a class="code" href="x509__vfy_8c.html#a19">X509_STORE_CTX_get_ex_new_index</a>(<span class="keywordtype">long</span> argl, <span class="keywordtype">void</span> *argp, <a class="code" href="crypto_8h.html#a97">CRYPTO_EX_new</a> *new_func,
00392     <a class="code" href="crypto_8h.html#a99">CRYPTO_EX_dup</a> *dup_func, <a class="code" href="crypto_8h.html#a98">CRYPTO_EX_free</a> *free_func);
00393 <span class="keywordtype">int</span> <a class="code" href="x509__vfy_8c.html#a20">X509_STORE_CTX_set_ex_data</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx,<span class="keywordtype">int</span> idx,<span class="keywordtype">void</span> *data);
00394 <span class="keywordtype">void</span> *  <a class="code" href="x509__vfy_8c.html#a21">X509_STORE_CTX_get_ex_data</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx,<span class="keywordtype">int</span> idx);
00395 <span class="keywordtype">int</span> <a class="code" href="x509__vfy_8c.html#a22">X509_STORE_CTX_get_error</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00396 <span class="keywordtype">void</span>    <a class="code" href="x509__vfy_8c.html#a23">X509_STORE_CTX_set_error</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx,<span class="keywordtype">int</span> s);
00397 <span class="keywordtype">int</span> <a class="code" href="x509__vfy_8c.html#a24">X509_STORE_CTX_get_error_depth</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00398 <a class="code" href="structx509__st.html">X509</a> *  <a class="code" href="x509__vfy_8c.html#a25">X509_STORE_CTX_get_current_cert</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00399 <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *X509_STORE_CTX_get_chain(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00400 <a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *X509_STORE_CTX_get1_chain(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx);
00401 <span class="keywordtype">void</span>    <a class="code" href="x509__vfy_8c.html#a27">X509_STORE_CTX_set_cert</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *c,<a class="code" href="structx509__st.html">X509</a> *x);
00402 <span class="keywordtype">void</span>    <a class="code" href="x509__vfy_8c.html#a28">X509_STORE_CTX_set_chain</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *c,<a class="code" href="safestack_8h.html#a0">STACK_OF</a>(<a class="code" href="structx509__st.html">X509</a>) *sk);
00403 <span class="keywordtype">int</span> <a class="code" href="x509__vfy_8c.html#a29">X509_STORE_CTX_set_purpose</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <span class="keywordtype">int</span> purpose);
00404 <span class="keywordtype">int</span> <a class="code" href="x509__vfy_8c.html#a30">X509_STORE_CTX_set_trust</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <span class="keywordtype">int</span> trust);
00405 <span class="keywordtype">int</span> <a class="code" href="x509__vfy_8c.html#a31">X509_STORE_CTX_purpose_inherit</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <span class="keywordtype">int</span> def_purpose,
00406                 <span class="keywordtype">int</span> purpose, <span class="keywordtype">int</span> trust);
00407 <span class="keywordtype">void</span> <a class="code" href="x509__vfy_8c.html#a37">X509_STORE_CTX_set_flags</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <span class="keywordtype">long</span> flags);
00408 <span class="keywordtype">void</span> <a class="code" href="x509__vfy_8c.html#a38">X509_STORE_CTX_set_time</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx, <span class="keywordtype">long</span> flags, time_t <a class="code" href="asn1_8h.html#a357">t</a>);
00409 <span class="keywordtype">void</span> <a class="code" href="x509__vfy_8c.html#a39">X509_STORE_CTX_set_verify_cb</a>(<a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *ctx,
00410                   <span class="keywordtype">int</span> (*verify_cb)(<span class="keywordtype">int</span>, <a class="code" href="structx509__store__ctx__st.html">X509_STORE_CTX</a> *));
00411 
00412 <span class="preprocessor">#ifdef  __cplusplus</span>
00413 <span class="preprocessor"></span>}
00414 <span class="preprocessor">#endif</span>
00415 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00416 <span class="preprocessor"></span>
</pre></div><hr><address style="align: right;"><small>Generated on Mon Aug 14 19:59:39 2006 for Octeon Core Crypto API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
