<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>rsa.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>rsa.h</h1><a href="rsa_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* crypto/rsa/rsa.h */</span>
00002 <span class="comment">/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)</span>
00003 <span class="comment"> * All rights reserved.</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> * This package is an SSL implementation written</span>
00006 <span class="comment"> * by Eric Young (eay@cryptsoft.com).</span>
00007 <span class="comment"> * The implementation was written so as to conform with Netscapes SSL.</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> * This library is free for commercial and non-commercial use as long as</span>
00010 <span class="comment"> * the following conditions are aheared to.  The following conditions</span>
00011 <span class="comment"> * apply to all code found in this distribution, be it the RC4, RSA,</span>
00012 <span class="comment"> * lhash, DES, etc., code; not just the SSL code.  The SSL documentation</span>
00013 <span class="comment"> * included with this distribution is covered by the same copyright terms</span>
00014 <span class="comment"> * except that the holder is Tim Hudson (tjh@cryptsoft.com).</span>
00015 <span class="comment"> * </span>
00016 <span class="comment"> * Copyright remains Eric Young's, and as such any Copyright notices in</span>
00017 <span class="comment"> * the code are not to be removed.</span>
00018 <span class="comment"> * If this package is used in a product, Eric Young should be given attribution</span>
00019 <span class="comment"> * as the author of the parts of the library used.</span>
00020 <span class="comment"> * This can be in the form of a textual message at program startup or</span>
00021 <span class="comment"> * in documentation (online or textual) provided with the package.</span>
00022 <span class="comment"> * </span>
00023 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
00024 <span class="comment"> * modification, are permitted provided that the following conditions</span>
00025 <span class="comment"> * are met:</span>
00026 <span class="comment"> * 1. Redistributions of source code must retain the copyright</span>
00027 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
00028 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
00029 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
00030 <span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
00031 <span class="comment"> * 3. All advertising materials mentioning features or use of this software</span>
00032 <span class="comment"> *    must display the following acknowledgement:</span>
00033 <span class="comment"> *    "This product includes cryptographic software written by</span>
00034 <span class="comment"> *     Eric Young (eay@cryptsoft.com)"</span>
00035 <span class="comment"> *    The word 'cryptographic' can be left out if the rouines from the library</span>
00036 <span class="comment"> *    being used are not cryptographic related :-).</span>
00037 <span class="comment"> * 4. If you include any Windows specific code (or a derivative thereof) from </span>
00038 <span class="comment"> *    the apps directory (application code) you must include an acknowledgement:</span>
00039 <span class="comment"> *    "This product includes software written by Tim Hudson (tjh@cryptsoft.com)"</span>
00040 <span class="comment"> * </span>
00041 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND</span>
00042 <span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00043 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
00044 <span class="comment"> * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE</span>
00045 <span class="comment"> * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
00046 <span class="comment"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span>
00047 <span class="comment"> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
00048 <span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
00049 <span class="comment"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
00050 <span class="comment"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
00051 <span class="comment"> * SUCH DAMAGE.</span>
00052 <span class="comment"> * </span>
00053 <span class="comment"> * The licence and distribution terms for any publically available version or</span>
00054 <span class="comment"> * derivative of this code cannot be changed.  i.e. this code cannot simply be</span>
00055 <span class="comment"> * copied and put under another distribution licence</span>
00056 <span class="comment"> * [including the GNU Public Licence.]</span>
00057 <span class="comment"> */</span>
00058 <span class="comment">/*</span>
00059 <span class="comment">   Copyright (c) 2003-2005 Cavium Networks (support@cavium.com). All rights</span>
00060 <span class="comment">   reserved.</span>
00061 <span class="comment"></span>
00062 <span class="comment">   Redistribution and use in source and binary forms, with or without</span>
00063 <span class="comment">   modification, are permitted provided that the following conditions are met:</span>
00064 <span class="comment">   1. Redistributions of source code must retain the above copyright notice,</span>
00065 <span class="comment">   this list of conditions and the following disclaimer.</span>
00066 <span class="comment">   2. Redistributions in binary form must reproduce the above copyright notice,</span>
00067 <span class="comment">   this list of conditions and the following disclaimer in the documentation</span>
00068 <span class="comment">   and/or other materials provided with the distribution.</span>
00069 <span class="comment">   3. All advertising materials mentioning features or use of this software</span>
00070 <span class="comment">   must display the following acknowledgement:</span>
00071 <span class="comment">   This product includes software developed by Cavium Networks</span>
00072 <span class="comment">   4. Cavium Networks' name may not be used to endorse or promote products</span>
00073 <span class="comment">   derived from this software without specific prior written permission.</span>
00074 <span class="comment"></span>
00075 <span class="comment">   This Software, including technical data, may be subject to U.S. export</span>
00076 <span class="comment">   control laws, including the U.S. Export Administration Act and its</span>
00077 <span class="comment">   associated regulations, and may be subject to export or import regulations</span>
00078 <span class="comment">   in other countries. You warrant that You will comply strictly in all</span>
00079 <span class="comment">   respects with all such regulations and acknowledge that you have the</span>
00080 <span class="comment">   responsibility to obtain licenses to export, re-export or import the</span>
00081 <span class="comment">   Software.</span>
00082 <span class="comment"></span>
00083 <span class="comment">   TO THE MAXIMUM EXTENT PERMITTED BY LAW, THE SOFTWARE IS PROVIDED "AS IS" AND</span>
00084 <span class="comment">   WITH ALL FAULTS AND CAVIUM MAKES NO PROMISES, REPRESENTATIONS OR WARRANTIES,</span>
00085 <span class="comment">   EITHER EXPRESS, IMPLIED, STATUTORY, OR OTHERWISE, WITH RESPECT TO THE</span>
00086 <span class="comment">   SOFTWARE, INCLUDING ITS CONDITION, ITS CONFORMITY TO ANY REPRESENTATION OR</span>
00087 <span class="comment">   DESCRIPTION, OR THE EXISTENCE OF ANY LATENT OR PATENT DEFECTS, AND CAVIUM</span>
00088 <span class="comment">   SPECIFICALLY DISCLAIMS ALL IMPLIED (IF ANY) WARRANTIES OF TITLE,</span>
00089 <span class="comment">   MERCHANTABILITY, NONINFRINGEMENT, FITNESS FOR A PARTICULAR PURPOSE, LACK OF</span>
00090 <span class="comment">   VIRUSES, ACCURACY OR COMPLETENESS, QUIET ENJOYMENT, QUIET POSSESSION OR</span>
00091 <span class="comment">   CORRESPONDENCE TO DESCRIPTION. THE ENTIRE RISK ARISING OUT OF USE OR</span>
00092 <span class="comment">   PERFORMANCE OF THE SOFTWARE LIES WITH YOU.</span>
00093 <span class="comment"> */</span>
00094 
00095 
00096 <span class="preprocessor">#ifndef HEADER_RSA_H</span>
00097 <span class="preprocessor"></span><span class="preprocessor">#define HEADER_RSA_H</span>
00098 <span class="preprocessor"></span>
00099 <span class="preprocessor">#include &lt;<a class="code" href="asn1_8h.html">openssl/asn1.h</a>&gt;</span>
00100 
00101 <span class="preprocessor">#ifndef OPENSSL_NO_BIO</span>
00102 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="bio_8h.html">openssl/bio.h</a>&gt;</span>
00103 <span class="preprocessor">#endif</span>
00104 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="bn_8h.html">openssl/bn.h</a>&gt;</span>
00105 <span class="preprocessor">#include &lt;<a class="code" href="crypto_8h.html">openssl/crypto.h</a>&gt;</span>
00106 <span class="preprocessor">#include &lt;<a class="code" href="include_2openssl_2ossl__typ_8h.html">openssl/ossl_typ.h</a>&gt;</span>
00107 
00108 <span class="preprocessor">#ifdef OPENSSL_NO_RSA</span>
00109 <span class="preprocessor"></span><span class="preprocessor">#error RSA is disabled.</span>
00110 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00111 <span class="preprocessor"></span>
00112 <span class="preprocessor">#ifdef  __cplusplus</span>
00113 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00114 <span class="preprocessor">#endif</span>
00115 <span class="preprocessor"></span>
00116 <span class="preprocessor">#ifdef OCTEON_OPENSSL</span>
00117 <span class="preprocessor"></span><span class="preprocessor">#include "cvmx.h"</span>
00118 
<a name="l00119"></a><a class="code" href="rsa_8h.html#a0">00119</a> <span class="preprocessor">#define MODEXP_GUARD 192</span>
<a name="l00120"></a><a class="code" href="structcvm__pub__key.html">00120</a> <span class="preprocessor"></span>  <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcvm__pub__key.html">cvm_pub_key</a> {
<a name="l00121"></a><a class="code" href="structcvm__pub__key.html#m0">00121</a>     uint64_t *<a class="code" href="structcvm__pub__key.html#m0">mod</a>;
<a name="l00122"></a><a class="code" href="structcvm__pub__key.html#m1">00122</a>     uint64_t *<a class="code" href="structcvm__pub__key.html#m1">pubexp</a>;
<a name="l00123"></a><a class="code" href="structcvm__pub__key.html#m2">00123</a>     <span class="keywordtype">int</span> <a class="code" href="structcvm__pub__key.html#m2">len</a>;
<a name="l00124"></a><a class="code" href="structcvm__pub__key.html#m3">00124</a>     <span class="keywordtype">int</span> <a class="code" href="structcvm__pub__key.html#m3">elen</a>;
00125   } <a class="code" href="structcvm__pub__key.html">cvm_pub_key_t</a>;
00126 
<a name="l00127"></a><a class="code" href="structcvm__rsa__key.html">00127</a>   <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcvm__rsa__key.html">cvm_rsa_key</a> {
<a name="l00128"></a><a class="code" href="structcvm__rsa__key.html#m0">00128</a>     uint64_t *<a class="code" href="structcvm__rsa__key.html#m0">mod</a>;
<a name="l00129"></a><a class="code" href="structcvm__rsa__key.html#m1">00129</a>     uint64_t *<a class="code" href="structcvm__rsa__key.html#m1">privexp</a>;
<a name="l00130"></a><a class="code" href="structcvm__rsa__key.html#m2">00130</a>     uint64_t *<a class="code" href="structcvm__rsa__key.html#m2">pubexp</a>;
<a name="l00131"></a><a class="code" href="structcvm__rsa__key.html#m3">00131</a>     uint64_t *<a class="code" href="structcvm__rsa__key.html#m3">expp</a>;
<a name="l00132"></a><a class="code" href="structcvm__rsa__key.html#m4">00132</a>     uint64_t *<a class="code" href="structcvm__rsa__key.html#m4">expq</a>;
<a name="l00133"></a><a class="code" href="structcvm__rsa__key.html#m5">00133</a>     uint64_t *<a class="code" href="structcvm__rsa__key.html#m5">p</a>;
<a name="l00134"></a><a class="code" href="structcvm__rsa__key.html#m6">00134</a>     uint64_t *<a class="code" href="structcvm__rsa__key.html#m6">q</a>;
<a name="l00135"></a><a class="code" href="structcvm__rsa__key.html#m7">00135</a>     uint64_t *<a class="code" href="structcvm__rsa__key.html#m7">coeff</a>;
<a name="l00136"></a><a class="code" href="structcvm__rsa__key.html#m8">00136</a>     <span class="keywordtype">int</span> <a class="code" href="structcvm__rsa__key.html#m8">len</a>;
<a name="l00137"></a><a class="code" href="structcvm__rsa__key.html#m9">00137</a>     <span class="keywordtype">int</span> <a class="code" href="structcvm__rsa__key.html#m9">eplen</a>;
<a name="l00138"></a><a class="code" href="structcvm__rsa__key.html#m10">00138</a>     <span class="keywordtype">int</span> <a class="code" href="structcvm__rsa__key.html#m10">eqlen</a>;
00139   } <a class="code" href="structcvm__rsa__key.html">cvm_rsa_key_t</a>;
00140 <span class="preprocessor">#else</span>
00141 <span class="preprocessor"></span><span class="preprocessor">#error "OCTEON_OPENSSL flag to be defined to use crypto library"</span>
00142 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00143 <span class="preprocessor"></span>
00144 
<a name="l00145"></a><a class="code" href="rsa_8h.html#a77">00145</a>   <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structrsa__st.html">rsa_st</a> RSA;
00146 
00147 <span class="preprocessor">#ifdef OCTEON_OPENSSL</span>
00148 <span class="preprocessor"></span>  <span class="keywordtype">int</span> <a class="code" href="rsa__eay_8c.html#a13">rsa_to_cry_public</a> (RSA * rsa, <a class="code" href="structcvm__pub__key.html">cvm_pub_key_t</a> * rkey);
00149   <span class="keywordtype">int</span> <a class="code" href="rsa__eay_8c.html#a15">rsa_to_cry_private</a> (RSA * rsa, <a class="code" href="structcvm__rsa__key.html">cvm_rsa_key_t</a> * rkey);
00150   <span class="keywordtype">void</span> <a class="code" href="rsa__eay_8c.html#a16">rsa_cry_private_free</a> (<a class="code" href="structcvm__rsa__key.html">cvm_rsa_key_t</a> * key);
00151   <span class="keywordtype">void</span> <a class="code" href="rsa__eay_8c.html#a14">rsa_cry_public_free</a> (<a class="code" href="structcvm__pub__key.html">cvm_pub_key_t</a> * key);
00152   <span class="keywordtype">int</span> <a class="code" href="rsa__eay_8c.html#a17">cvm_rsa_public_decrypt</a> (<a class="code" href="structcvm__pub__key.html">cvm_pub_key_t</a> * key, uint64_t * base,
00153     uint64_t * tmpbuf, <span class="keywordtype">int</span> padding, <span class="keywordtype">int</span> blen);
00154   <span class="keywordtype">int</span> <a class="code" href="rsa__eay_8c.html#a18">cvm_rsa_private</a> (<a class="code" href="structcvm__rsa__key.html">cvm_rsa_key_t</a> * key, uint64_t * base,
00155     uint8_t * tmpbuf, <span class="keywordtype">int</span> align);
00156 <span class="preprocessor">#endif</span>
00157 <span class="preprocessor"></span>
<a name="l00158"></a><a class="code" href="structrsa__meth__st.html">00158</a>   <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structrsa__meth__st.html">rsa_meth_st</a> {
<a name="l00159"></a><a class="code" href="structrsa__meth__st.html#m0">00159</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__meth__st.html#m0">name</a>;
00160     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m1">rsa_pub_enc</a>) (<span class="keywordtype">int</span> flen, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *from,
00161       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, RSA * rsa, <span class="keywordtype">int</span> padding);
00162     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m2">rsa_pub_dec</a>) (<span class="keywordtype">int</span> flen, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *from,
00163       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, RSA * rsa, <span class="keywordtype">int</span> padding);
00164     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m3">rsa_priv_enc</a>) (<span class="keywordtype">int</span> flen, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *from,
00165       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, RSA * rsa, <span class="keywordtype">int</span> padding);
00166     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m4">rsa_priv_dec</a>) (<span class="keywordtype">int</span> flen, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *from,
00167       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, RSA * rsa, <span class="keywordtype">int</span> padding);
00168     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m5">rsa_mod_exp</a>) (<a class="code" href="structbignum__st.html">BIGNUM</a> * r0, <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> * <a class="code" href="md5__locl_8h.html#a16">I</a>, RSA * rsa);      <span class="comment">/* Can be null */</span>
00169     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m6">bn_mod_exp</a>) (<a class="code" href="structbignum__st.html">BIGNUM</a> * r, <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> * <a class="code" href="v3__extku_8c.html#a3">a</a>, <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> * p, <span class="keyword">const</span> <a class="code" href="structbignum__st.html">BIGNUM</a> * m, <a class="code" href="structbignum__ctx.html">BN_CTX</a> * ctx, <a class="code" href="structbn__mont__ctx__st.html">BN_MONT_CTX</a> * m_ctx);    <span class="comment">/* Can be null */</span>
00170     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m7">init</a>) (RSA * rsa);    <span class="comment">/* called at new */</span>
00171     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m8">finish</a>) (RSA * rsa);  <span class="comment">/* called at free */</span>
<a name="l00172"></a><a class="code" href="structrsa__meth__st.html#m9">00172</a>     <span class="keywordtype">int</span> <a class="code" href="structrsa__meth__st.html#m9">flags</a>;                  <span class="comment">/* RSA_METHOD_FLAG_* things */</span>
<a name="l00173"></a><a class="code" href="structrsa__meth__st.html#m10">00173</a>     <span class="keywordtype">char</span> *<a class="code" href="structrsa__meth__st.html#m10">app_data</a>;             <span class="comment">/* may be needed! */</span>
00174     <span class="comment">/* New sign and verify functions: some libraries don't allow arbitrary data</span>
00175 <span class="comment">     * to be signed/verified: this allows them to be used. Note: for this to work</span>
00176 <span class="comment">     * the RSA_public_decrypt() and RSA_private_encrypt() should *NOT* be used</span>
00177 <span class="comment">     * RSA_sign(), RSA_verify() should be used instead. Note: for backwards</span>
00178 <span class="comment">     * compatibility this functionality is only enabled if the RSA_FLAG_SIGN_VER</span>
00179 <span class="comment">     * option is set in 'flags'.</span>
00180 <span class="comment">     */</span>
00181     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m11">rsa_sign</a>) (<span class="keywordtype">int</span> type,
00182       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *m, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_length,
00183       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sigret, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *siglen, <span class="keyword">const</span> RSA * rsa);
00184     <a class="code" href="cryptlib_8c.html#a9">int</a> (*<a class="code" href="structrsa__meth__st.html#m12">rsa_verify</a>) (<span class="keywordtype">int</span> dtype,
00185       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *m, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_length,
00186       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sigbuf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> siglen, <span class="keyword">const</span> RSA * rsa);
00187 
00188   } <a class="code" href="structrsa__meth__st.html">RSA_METHOD</a>;
00189 
<a name="l00190"></a><a class="code" href="structrsa__st.html">00190</a>   <span class="keyword">struct </span><a class="code" href="structrsa__st.html">rsa_st</a> {
00191     <span class="comment">/* The first parameter is used to pickup errors where</span>
00192 <span class="comment">     * this is passed instead of aEVP_PKEY, it is set to 0 */</span>
<a name="l00193"></a><a class="code" href="structrsa__st.html#m0">00193</a>     <span class="keywordtype">int</span> <a class="code" href="structrsa__st.html#m0">pad</a>;
<a name="l00194"></a><a class="code" href="structrsa__st.html#m1">00194</a>     <span class="keywordtype">long</span> <a class="code" href="structrsa__st.html#m1">version</a>;
<a name="l00195"></a><a class="code" href="structrsa__st.html#m2">00195</a>     <span class="keyword">const</span> <a class="code" href="structrsa__meth__st.html">RSA_METHOD</a> *<a class="code" href="structrsa__st.html#m2">meth</a>;
00196     <span class="comment">/* functional reference if 'meth' is ENGINE-provided */</span>
<a name="l00197"></a><a class="code" href="structrsa__st.html#m3">00197</a>     <a class="code" href="structengine__st.html">ENGINE</a> *<a class="code" href="structrsa__st.html#m3">engine</a>;
<a name="l00198"></a><a class="code" href="structrsa__st.html#m4">00198</a>     <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="structrsa__st.html#m4">n</a>;
<a name="l00199"></a><a class="code" href="structrsa__st.html#m5">00199</a>     <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="structrsa__st.html#m5">e</a>;
<a name="l00200"></a><a class="code" href="structrsa__st.html#m6">00200</a>     <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="structrsa__st.html#m6">d</a>;
<a name="l00201"></a><a class="code" href="structrsa__st.html#m7">00201</a>     <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="structrsa__st.html#m7">p</a>;
<a name="l00202"></a><a class="code" href="structrsa__st.html#m8">00202</a>     <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="structrsa__st.html#m8">q</a>;
<a name="l00203"></a><a class="code" href="structrsa__st.html#m9">00203</a>     <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="structrsa__st.html#m9">dmp1</a>;
<a name="l00204"></a><a class="code" href="structrsa__st.html#m10">00204</a>     <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="structrsa__st.html#m10">dmq1</a>;
<a name="l00205"></a><a class="code" href="structrsa__st.html#m11">00205</a>     <a class="code" href="structbignum__st.html">BIGNUM</a> *<a class="code" href="structrsa__st.html#m11">iqmp</a>;
00206     <span class="comment">/* be careful using this if the RSA structure is shared */</span>
<a name="l00207"></a><a class="code" href="structrsa__st.html#m12">00207</a>     <a class="code" href="structcrypto__ex__data__st.html">CRYPTO_EX_DATA</a> <a class="code" href="structrsa__st.html#m12">ex_data</a>;
<a name="l00208"></a><a class="code" href="structrsa__st.html#m13">00208</a>     <span class="keywordtype">int</span> <a class="code" href="structrsa__st.html#m13">references</a>;
<a name="l00209"></a><a class="code" href="structrsa__st.html#m14">00209</a>     <span class="keywordtype">int</span> <a class="code" href="structrsa__st.html#m14">flags</a>;
00210 
00211     <span class="comment">/* Used to cache montgomery values */</span>
<a name="l00212"></a><a class="code" href="structrsa__st.html#m15">00212</a>     <a class="code" href="structbn__mont__ctx__st.html">BN_MONT_CTX</a> *<a class="code" href="structrsa__st.html#m15">_method_mod_n</a>;
<a name="l00213"></a><a class="code" href="structrsa__st.html#m16">00213</a>     <a class="code" href="structbn__mont__ctx__st.html">BN_MONT_CTX</a> *<a class="code" href="structrsa__st.html#m16">_method_mod_p</a>;
<a name="l00214"></a><a class="code" href="structrsa__st.html#m17">00214</a>     <a class="code" href="structbn__mont__ctx__st.html">BN_MONT_CTX</a> *<a class="code" href="structrsa__st.html#m17">_method_mod_q</a>;
00215 
00216     <span class="comment">/* all BIGNUM values are actually in the following data, if it is not</span>
00217 <span class="comment">     * NULL */</span>
<a name="l00218"></a><a class="code" href="structrsa__st.html#m18">00218</a>     <span class="keywordtype">char</span> *<a class="code" href="structrsa__st.html#m18">bignum_data</a>;
<a name="l00219"></a><a class="code" href="structrsa__st.html#m19">00219</a>     <a class="code" href="structbn__blinding__st.html">BN_BLINDING</a> *<a class="code" href="structrsa__st.html#m19">blinding</a>;
00220   };
00221 
<a name="l00222"></a><a class="code" href="rsa_8h.html#a1">00222</a> <span class="preprocessor">#define RSA_3   0x3L</span>
<a name="l00223"></a><a class="code" href="rsa_8h.html#a2">00223</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F4  0x10001L</span>
00224 <span class="preprocessor"></span>
<a name="l00225"></a><a class="code" href="rsa_8h.html#a3">00225</a> <span class="preprocessor">#define RSA_METHOD_FLAG_NO_CHECK    0x01    </span><span class="comment">/* don't check pub/private match */</span>
00226 
<a name="l00227"></a><a class="code" href="rsa_8h.html#a4">00227</a> <span class="preprocessor">#define RSA_FLAG_CACHE_PUBLIC       0x02</span>
<a name="l00228"></a><a class="code" href="rsa_8h.html#a5">00228</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_FLAG_CACHE_PRIVATE      0x04</span>
<a name="l00229"></a><a class="code" href="rsa_8h.html#a6">00229</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_FLAG_BLINDING       0x08</span>
<a name="l00230"></a><a class="code" href="rsa_8h.html#a7">00230</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_FLAG_THREAD_SAFE        0x10</span>
00231 <span class="preprocessor"></span>  <span class="comment">/* This flag means the private key operations will be handled by rsa_mod_exp</span>
00232 <span class="comment">   * and that they do not depend on the private key components being present:</span>
00233 <span class="comment">   * for example a key stored in external hardware. Without this flag bn_mod_exp</span>
00234 <span class="comment">   * gets called when private key components are absent.</span>
00235 <span class="comment">   */</span>
<a name="l00236"></a><a class="code" href="rsa_8h.html#a8">00236</a> <span class="preprocessor">#define RSA_FLAG_EXT_PKEY       0x20</span>
00237 <span class="preprocessor"></span>
00238   <span class="comment">/* This flag in the RSA_METHOD enables the new rsa_sign, rsa_verify functions.</span>
00239 <span class="comment">   */</span>
<a name="l00240"></a><a class="code" href="rsa_8h.html#a9">00240</a> <span class="preprocessor">#define RSA_FLAG_SIGN_VER       0x40</span>
00241 <span class="preprocessor"></span>
<a name="l00242"></a><a class="code" href="rsa_8h.html#a10">00242</a> <span class="preprocessor">#define RSA_FLAG_NO_BLINDING        0x80    </span><span class="comment">/* new with 0.9.6j and 0.9.7b; the built-in</span>
00243 <span class="comment">                                                 * RSA implementation now uses blinding by</span>
00244 <span class="comment">                                                 * default (ignoring RSA_FLAG_BLINDING),</span>
00245 <span class="comment">                                                 * but other engines might not need it</span>
00246 <span class="comment">                                                 */</span>
00247 
<a name="l00248"></a><a class="code" href="rsa_8h.html#a11">00248</a> <span class="preprocessor">#define RSA_PKCS1_PADDING   1</span>
<a name="l00249"></a><a class="code" href="rsa_8h.html#a12">00249</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_SSLV23_PADDING  2</span>
<a name="l00250"></a><a class="code" href="rsa_8h.html#a13">00250</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_NO_PADDING      3</span>
<a name="l00251"></a><a class="code" href="rsa_8h.html#a14">00251</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_PKCS1_OAEP_PADDING  4</span>
00252 <span class="preprocessor"></span>
<a name="l00253"></a><a class="code" href="rsa_8h.html#a15">00253</a> <span class="preprocessor">#define RSA_PKCS1_PADDING_SIZE  11</span>
00254 <span class="preprocessor"></span>
<a name="l00255"></a><a class="code" href="rsa_8h.html#a16">00255</a> <span class="preprocessor">#define RSA_set_app_data(s,arg)         RSA_set_ex_data(s,0,arg)</span>
<a name="l00256"></a><a class="code" href="rsa_8h.html#a17">00256</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_get_app_data(s)             RSA_get_ex_data(s,0)</span>
00257 <span class="preprocessor"></span>
00258   RSA *<a class="code" href="rsa__lib_8c.html#a2">RSA_new</a> (<span class="keywordtype">void</span>);
00259   RSA *<a class="code" href="rsa__lib_8c.html#a7">RSA_new_method</a> (<a class="code" href="structengine__st.html">ENGINE</a> * engine);
00260   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a13">RSA_size</a> (<span class="keyword">const</span> RSA *);
00261   RSA *<a class="code" href="rsa__gen_8c.html#a0">RSA_generate_key</a> (<span class="keywordtype">int</span> <a class="code" href="v3__bitst_8c.html#a0">bits</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> e, <span class="keywordtype">void</span>
00262       (*callback) (<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">void</span> *), <span class="keywordtype">void</span> *cb_arg);
00263   <span class="keywordtype">int</span> <a class="code" href="rsa__chk_8c.html#a0">RSA_check_key</a> (<span class="keyword">const</span> RSA *);
00264   <span class="comment">/* next 4 return -1 on error */</span>
00265   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a14">RSA_public_encrypt</a> (<span class="keywordtype">int</span> flen, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *from,
00266     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, RSA * rsa, <span class="keywordtype">int</span> padding);
00267   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a15">RSA_private_encrypt</a> (<span class="keywordtype">int</span> flen, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *from,
00268     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, RSA * rsa, <span class="keywordtype">int</span> padding);
00269   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a17">RSA_public_decrypt</a> (<span class="keywordtype">int</span> flen, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *from,
00270     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, RSA * rsa, <span class="keywordtype">int</span> padding);
00271   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a16">RSA_private_decrypt</a> (<span class="keywordtype">int</span> flen, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *from,
00272     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, RSA * rsa, <span class="keywordtype">int</span> padding);
00273   <span class="keywordtype">void</span> <a class="code" href="rsa__lib_8c.html#a8">RSA_free</a> (RSA * r);
00274   <span class="comment">/* "up" the RSA object's reference count */</span>
00275   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a9">RSA_up_ref</a> (RSA * r);
00276 
00277   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a18">RSA_flags</a> (<span class="keyword">const</span> RSA * r);
00278 
00279   <span class="keywordtype">void</span> <a class="code" href="rsa__lib_8c.html#a3">RSA_set_default_method</a> (<span class="keyword">const</span> <a class="code" href="structrsa__meth__st.html">RSA_METHOD</a> * meth);
00280   <span class="keyword">const</span> <a class="code" href="structrsa__meth__st.html">RSA_METHOD</a> *<a class="code" href="rsa__lib_8c.html#a4">RSA_get_default_method</a> (<span class="keywordtype">void</span>);
00281   <span class="keyword">const</span> <a class="code" href="structrsa__meth__st.html">RSA_METHOD</a> *<a class="code" href="rsa__lib_8c.html#a5">RSA_get_method</a> (<span class="keyword">const</span> RSA * rsa);
00282   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a6">RSA_set_method</a> (RSA * rsa, <span class="keyword">const</span> <a class="code" href="structrsa__meth__st.html">RSA_METHOD</a> * meth);
00283 
00284   <span class="comment">/* This function needs the memory locking malloc callbacks to be installed */</span>
00285   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a21">RSA_memory_lock</a> (RSA * r);
00286 
00287   <span class="comment">/* these are the actual SSLeay RSA functions */</span>
00288   <span class="keyword">const</span> <a class="code" href="structrsa__meth__st.html">RSA_METHOD</a> *<a class="code" href="rsa__eay_8c.html#a19">RSA_PKCS1_SSLeay</a> (<span class="keywordtype">void</span>);
00289 
00290   <span class="keyword">const</span> <a class="code" href="structrsa__meth__st.html">RSA_METHOD</a> *<a class="code" href="rsa__null_8c.html#a7">RSA_null_method</a> (<span class="keywordtype">void</span>);
00291 
00292     <a class="code" href="asn1_8h.html#a89">DECLARE_ASN1_ENCODE_FUNCTIONS_const</a> (RSA, RSAPublicKey)
00293     <a class="code" href="asn1_8h.html#a89">DECLARE_ASN1_ENCODE_FUNCTIONS_const</a> (RSA, RSAPrivateKey)
00294 #ifndef OPENSSL_NO_FP_API
00295   <span class="keywordtype">int</span> <a class="code" href="t__pkey_8c.html#a1">RSA_print_fp</a> (FILE * fp, <span class="keyword">const</span> RSA * r, <span class="keywordtype">int</span> offset);
00296 <span class="preprocessor">#endif</span>
00297 <span class="preprocessor"></span>
00298 <span class="preprocessor">#ifndef OPENSSL_NO_BIO</span>
00299 <span class="preprocessor"></span>  <span class="keywordtype">int</span> <a class="code" href="t__pkey_8c.html#a2">RSA_print</a> (<a class="code" href="structbio__st.html">BIO</a> * bp, <span class="keyword">const</span> RSA * r, <span class="keywordtype">int</span> offset);
00300 <span class="preprocessor">#endif</span>
00301 <span class="preprocessor"></span>
00302   <span class="keywordtype">int</span> <a class="code" href="n__pkey_8c.html#a10">i2d_RSA_NET</a> (<span class="keyword">const</span> RSA * <a class="code" href="v3__extku_8c.html#a3">a</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **pp, <span class="keywordtype">int</span> (*cb) (),
00303     <span class="keywordtype">int</span> <a class="code" href="n__pkey_8c.html#a4">sgckey</a>);
00304   RSA *<a class="code" href="n__pkey_8c.html#a12">d2i_RSA_NET</a> (RSA ** a, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **pp, <span class="keywordtype">long</span> length,
00305     <span class="keywordtype">int</span> (*cb) (), <span class="keywordtype">int</span> <a class="code" href="n__pkey_8c.html#a4">sgckey</a>);
00306 
00307   <span class="keywordtype">int</span> <a class="code" href="n__pkey_8c.html#a9">i2d_Netscape_RSA</a> (<span class="keyword">const</span> RSA * a, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **pp, <span class="keywordtype">int</span> (*cb) ());
00308   RSA *<a class="code" href="n__pkey_8c.html#a11">d2i_Netscape_RSA</a> (RSA ** a, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **pp, <span class="keywordtype">long</span> length,
00309     <span class="keywordtype">int</span> (*cb) ());
00310 
00311   <span class="comment">/* The following 2 functions sign and verify a X509_SIG ASN1 object</span>
00312 <span class="comment">   * inside PKCS#1 padded RSA encryption */</span>
00313   <span class="keywordtype">int</span> <a class="code" href="rsa__sign_8c.html#a1">RSA_sign</a> (<span class="keywordtype">int</span> type, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *m, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_length,
00314     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sigret, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *siglen, RSA * rsa);
00315   <span class="keywordtype">int</span> <a class="code" href="rsa__sign_8c.html#a2">RSA_verify</a> (<span class="keywordtype">int</span> type, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *m, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_length,
00316     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sigbuf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> siglen, RSA * rsa);
00317 
00318   <span class="comment">/* The following 2 function sign and verify a ASN1_OCTET_STRING</span>
00319 <span class="comment">   * object inside PKCS#1 padded RSA encryption */</span>
00320   <span class="keywordtype">int</span> <a class="code" href="rsa__saos_8c.html#a0">RSA_sign_ASN1_OCTET_STRING</a> (<span class="keywordtype">int</span> type,
00321     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *m, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_length,
00322     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sigret, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *siglen, RSA * rsa);
00323   <span class="keywordtype">int</span> <a class="code" href="rsa__saos_8c.html#a1">RSA_verify_ASN1_OCTET_STRING</a> (<span class="keywordtype">int</span> type,
00324     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *m, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_length,
00325     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sigbuf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> siglen, RSA * rsa);
00326 
00327   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a20">RSA_blinding_on</a> (RSA * rsa, <a class="code" href="structbignum__ctx.html">BN_CTX</a> * ctx);
00328   <span class="keywordtype">void</span> <a class="code" href="rsa__lib_8c.html#a19">RSA_blinding_off</a> (RSA * rsa);
00329 
00330   <span class="keywordtype">int</span> <a class="code" href="rsa__pk1_8c.html#a0">RSA_padding_add_PKCS1_type_1</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00331     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl);
00332   <span class="keywordtype">int</span> <a class="code" href="rsa__pk1_8c.html#a1">RSA_padding_check_PKCS1_type_1</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00333     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl, <span class="keywordtype">int</span> rsa_len);
00334   <span class="keywordtype">int</span> <a class="code" href="rsa__pk1_8c.html#a2">RSA_padding_add_PKCS1_type_2</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00335     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl);
00336   <span class="keywordtype">int</span> <a class="code" href="rsa__pk1_8c.html#a3">RSA_padding_check_PKCS1_type_2</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00337     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl, <span class="keywordtype">int</span> rsa_len);
00338   <span class="keywordtype">int</span> <a class="code" href="rsa__oaep_8c.html#a1">RSA_padding_add_PKCS1_OAEP</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00339     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p, <span class="keywordtype">int</span> pl);
00340   <span class="keywordtype">int</span> <a class="code" href="rsa__oaep_8c.html#a2">RSA_padding_check_PKCS1_OAEP</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00341     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl, <span class="keywordtype">int</span> rsa_len,
00342     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p, <span class="keywordtype">int</span> pl);
00343   <span class="keywordtype">int</span> <a class="code" href="rsa__ssl_8c.html#a0">RSA_padding_add_SSLv23</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00344     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl);
00345   <span class="keywordtype">int</span> <a class="code" href="rsa__ssl_8c.html#a1">RSA_padding_check_SSLv23</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00346     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl, <span class="keywordtype">int</span> rsa_len);
00347   <span class="keywordtype">int</span> <a class="code" href="rsa__none_8c.html#a0">RSA_padding_add_none</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00348     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl);
00349   <span class="keywordtype">int</span> <a class="code" href="rsa__none_8c.html#a1">RSA_padding_check_none</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *to, <span class="keywordtype">int</span> tlen,
00350     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *f, <span class="keywordtype">int</span> fl, <span class="keywordtype">int</span> rsa_len);
00351 
00352   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a10">RSA_get_ex_new_index</a> (<span class="keywordtype">long</span> argl, <span class="keywordtype">void</span> *argp,
00353     <a class="code" href="crypto_8h.html#a97">CRYPTO_EX_new</a> * new_func, <a class="code" href="crypto_8h.html#a99">CRYPTO_EX_dup</a> * dup_func,
00354     <a class="code" href="crypto_8h.html#a98">CRYPTO_EX_free</a> * free_func);
00355   <span class="keywordtype">int</span> <a class="code" href="rsa__lib_8c.html#a11">RSA_set_ex_data</a> (RSA * r, <span class="keywordtype">int</span> idx, <span class="keywordtype">void</span> *<a class="code" href="e__rc5_8c.html#a2">arg</a>);
00356   <span class="keywordtype">void</span> *<a class="code" href="rsa__lib_8c.html#a12">RSA_get_ex_data</a> (<span class="keyword">const</span> RSA * r, <span class="keywordtype">int</span> idx);
00357 
00358   RSA *<a class="code" href="rsa_8h.html#a130">RSAPublicKey_dup</a> (RSA * rsa);
00359   RSA *<a class="code" href="rsa_8h.html#a131">RSAPrivateKey_dup</a> (RSA * rsa);
00360 
00361   <span class="comment">/* BEGIN ERROR CODES */</span>
00362   <span class="comment">/* The following lines are auto generated by the script mkerr.pl. Any changes</span>
00363 <span class="comment">   * made after this point may be overwritten when the script is next run.</span>
00364 <span class="comment">   */</span>
00365   <span class="keywordtype">void</span> <a class="code" href="rsa__err_8c.html#a2">ERR_load_RSA_strings</a> (<span class="keywordtype">void</span>);
00366 
00367   <span class="comment">/* Error codes for the RSA functions. */</span>
00368 
00369   <span class="comment">/* Function codes. */</span>
<a name="l00370"></a><a class="code" href="rsa_8h.html#a18">00370</a> <span class="preprocessor">#define RSA_F_MEMORY_LOCK                100</span>
<a name="l00371"></a><a class="code" href="rsa_8h.html#a19">00371</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_CHECK_KEY              123</span>
<a name="l00372"></a><a class="code" href="rsa_8h.html#a20">00372</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_EAY_PRIVATE_DECRYPT            101</span>
<a name="l00373"></a><a class="code" href="rsa_8h.html#a21">00373</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_EAY_PRIVATE_ENCRYPT            102</span>
<a name="l00374"></a><a class="code" href="rsa_8h.html#a22">00374</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_EAY_PUBLIC_DECRYPT             103</span>
<a name="l00375"></a><a class="code" href="rsa_8h.html#a23">00375</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_EAY_PUBLIC_ENCRYPT             104</span>
<a name="l00376"></a><a class="code" href="rsa_8h.html#a24">00376</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_GENERATE_KEY               105</span>
<a name="l00377"></a><a class="code" href="rsa_8h.html#a25">00377</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_NEW_METHOD                 106</span>
<a name="l00378"></a><a class="code" href="rsa_8h.html#a26">00378</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_NULL                   124</span>
<a name="l00379"></a><a class="code" href="rsa_8h.html#a27">00379</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_ADD_NONE           107</span>
<a name="l00380"></a><a class="code" href="rsa_8h.html#a28">00380</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_ADD_PKCS1_OAEP         121</span>
<a name="l00381"></a><a class="code" href="rsa_8h.html#a29">00381</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_ADD_PKCS1_TYPE_1       108</span>
<a name="l00382"></a><a class="code" href="rsa_8h.html#a30">00382</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_ADD_PKCS1_TYPE_2       109</span>
<a name="l00383"></a><a class="code" href="rsa_8h.html#a31">00383</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_ADD_SSLV23             110</span>
<a name="l00384"></a><a class="code" href="rsa_8h.html#a32">00384</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_CHECK_NONE             111</span>
<a name="l00385"></a><a class="code" href="rsa_8h.html#a33">00385</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_CHECK_PKCS1_OAEP       122</span>
<a name="l00386"></a><a class="code" href="rsa_8h.html#a34">00386</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_1         112</span>
<a name="l00387"></a><a class="code" href="rsa_8h.html#a35">00387</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_CHECK_PKCS1_TYPE_2         113</span>
<a name="l00388"></a><a class="code" href="rsa_8h.html#a36">00388</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PADDING_CHECK_SSLV23           114</span>
<a name="l00389"></a><a class="code" href="rsa_8h.html#a37">00389</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PRINT                  115</span>
<a name="l00390"></a><a class="code" href="rsa_8h.html#a38">00390</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_PRINT_FP               116</span>
<a name="l00391"></a><a class="code" href="rsa_8h.html#a39">00391</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_SIGN                   117</span>
<a name="l00392"></a><a class="code" href="rsa_8h.html#a40">00392</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_SIGN_ASN1_OCTET_STRING         118</span>
<a name="l00393"></a><a class="code" href="rsa_8h.html#a41">00393</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_VERIFY                 119</span>
<a name="l00394"></a><a class="code" href="rsa_8h.html#a42">00394</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_RSA_VERIFY_ASN1_OCTET_STRING       120</span>
00395 <span class="preprocessor"></span>
00396   <span class="comment">/* Reason codes. */</span>
<a name="l00397"></a><a class="code" href="rsa_8h.html#a43">00397</a> <span class="preprocessor">#define RSA_R_ALGORITHM_MISMATCH             100</span>
<a name="l00398"></a><a class="code" href="rsa_8h.html#a44">00398</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_BAD_E_VALUE                101</span>
<a name="l00399"></a><a class="code" href="rsa_8h.html#a45">00399</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_BAD_FIXED_HEADER_DECRYPT           102</span>
<a name="l00400"></a><a class="code" href="rsa_8h.html#a46">00400</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_BAD_PAD_BYTE_COUNT             103</span>
<a name="l00401"></a><a class="code" href="rsa_8h.html#a47">00401</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_BAD_SIGNATURE              104</span>
<a name="l00402"></a><a class="code" href="rsa_8h.html#a48">00402</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_BLOCK_TYPE_IS_NOT_01           106</span>
<a name="l00403"></a><a class="code" href="rsa_8h.html#a49">00403</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_BLOCK_TYPE_IS_NOT_02           107</span>
<a name="l00404"></a><a class="code" href="rsa_8h.html#a50">00404</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DATA_GREATER_THAN_MOD_LEN          108</span>
<a name="l00405"></a><a class="code" href="rsa_8h.html#a51">00405</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DATA_TOO_LARGE                 109</span>
<a name="l00406"></a><a class="code" href="rsa_8h.html#a52">00406</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DATA_TOO_LARGE_FOR_KEY_SIZE        110</span>
<a name="l00407"></a><a class="code" href="rsa_8h.html#a53">00407</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DATA_TOO_LARGE_FOR_MODULUS         132</span>
<a name="l00408"></a><a class="code" href="rsa_8h.html#a54">00408</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DATA_TOO_SMALL                 111</span>
<a name="l00409"></a><a class="code" href="rsa_8h.html#a55">00409</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DATA_TOO_SMALL_FOR_KEY_SIZE        122</span>
<a name="l00410"></a><a class="code" href="rsa_8h.html#a56">00410</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DIGEST_TOO_BIG_FOR_RSA_KEY         112</span>
<a name="l00411"></a><a class="code" href="rsa_8h.html#a57">00411</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DMP1_NOT_CONGRUENT_TO_D            124</span>
<a name="l00412"></a><a class="code" href="rsa_8h.html#a58">00412</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_DMQ1_NOT_CONGRUENT_TO_D            125</span>
<a name="l00413"></a><a class="code" href="rsa_8h.html#a59">00413</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_D_E_NOT_CONGRUENT_TO_1             123</span>
<a name="l00414"></a><a class="code" href="rsa_8h.html#a60">00414</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_INVALID_MESSAGE_LENGTH             131</span>
<a name="l00415"></a><a class="code" href="rsa_8h.html#a61">00415</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_IQMP_NOT_INVERSE_OF_Q          126</span>
<a name="l00416"></a><a class="code" href="rsa_8h.html#a62">00416</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_KEY_SIZE_TOO_SMALL             120</span>
<a name="l00417"></a><a class="code" href="rsa_8h.html#a63">00417</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_NULL_BEFORE_BLOCK_MISSING          113</span>
<a name="l00418"></a><a class="code" href="rsa_8h.html#a64">00418</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_N_DOES_NOT_EQUAL_P_Q           127</span>
<a name="l00419"></a><a class="code" href="rsa_8h.html#a65">00419</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_OAEP_DECODING_ERROR            121</span>
<a name="l00420"></a><a class="code" href="rsa_8h.html#a66">00420</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_PADDING_CHECK_FAILED           114</span>
<a name="l00421"></a><a class="code" href="rsa_8h.html#a67">00421</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_P_NOT_PRIME                128</span>
<a name="l00422"></a><a class="code" href="rsa_8h.html#a68">00422</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_Q_NOT_PRIME                129</span>
<a name="l00423"></a><a class="code" href="rsa_8h.html#a69">00423</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_RSA_OPERATIONS_NOT_SUPPORTED       130</span>
<a name="l00424"></a><a class="code" href="rsa_8h.html#a70">00424</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_SSLV3_ROLLBACK_ATTACK          115</span>
<a name="l00425"></a><a class="code" href="rsa_8h.html#a71">00425</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_THE_ASN1_OBJECT_IDENTIFIER_IS_NOT_KNOWN_FOR_THIS_MD 116</span>
<a name="l00426"></a><a class="code" href="rsa_8h.html#a72">00426</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_UNKNOWN_ALGORITHM_TYPE             117</span>
<a name="l00427"></a><a class="code" href="rsa_8h.html#a73">00427</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_UNKNOWN_PADDING_TYPE           118</span>
<a name="l00428"></a><a class="code" href="rsa_8h.html#a74">00428</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_WRONG_SIGNATURE_LENGTH             119</span>
00429 <span class="preprocessor"></span>
00430 <span class="preprocessor">#ifdef  __cplusplus</span>
00431 <span class="preprocessor"></span>}
00432 <span class="preprocessor">#endif</span>
00433 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Mon Aug 14 19:59:37 2006 for Octeon Core Crypto API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
