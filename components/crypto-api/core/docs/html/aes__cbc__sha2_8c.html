<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>aes_cbc_sha2.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>aes_cbc_sha2.c File Reference</h1><code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;assert.h&gt;</code><br>
<code>#include "cvmx.h"</code><br>
<code>#include "cvmx-key.h"</code><br>
<code>#include "<a class="el" href="aes_8h-source.html">openssl/aes.h</a>"</code><br>
<code>#include "<a class="el" href="hmac_8h-source.html">openssl/hmac.h</a>"</code><br>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a0">ESP_HEADER_LENGTH</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a1">AES_CBC_IV_LENGTH</a>&nbsp;&nbsp;&nbsp;16</td></tr>
<tr><td nowrap align=right valign=top>#define&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a2">ESP_HMAC_LEN</a>&nbsp;&nbsp;&nbsp;12</td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a3">AES_cbc_sha224_encrypt</a> (uint16_t aes_keylen, uint8_t *aes_key, uint16_t sha224_keylen, uint8_t *sha224_key, uint8_t *espheader, uint8_t *<a class="el" href="e__des_8c.html#a1">iv</a>, uint8_t *input, uint16_t inputlen, uint8_t *output, uint16_t *outputlen)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>AES-CBC-SHA224 Encryption This function creates an IPSEC outbound packet using AES-CBC &amp; HMAC-SHA224 keys provided.</em> <a href="#a3"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a4">AES_cbc_sha224_decrypt</a> (uint16_t aes_keylen, uint8_t *aes_key, uint16_t sha224_keylen, uint8_t *sha224_key, uint8_t *<a class="el" href="e__des_8c.html#a1">iv</a>, uint8_t *input, uint16_t inputlen, uint8_t *output, uint16_t *outputlen, uint8_t compdigest)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>AES-CBC-SHA224 Decryption This function authenticates &amp; decrypts an inbound IPSEC packet using the AES-CBC and HMAC-SHA224 keys provided.</em> <a href="#a4"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a5">AES_cbc_sha256_encrypt</a> (uint16_t aes_keylen, uint8_t *aes_key, uint16_t sha256_keylen, uint8_t *sha256_key, uint8_t *espheader, uint8_t *<a class="el" href="e__des_8c.html#a1">iv</a>, uint8_t *input, uint16_t inputlen, uint8_t *output, uint16_t *outputlen)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>AES-CBC-SHA256 Encryption This function creates an IPSEC outbound packet using AES-CBC &amp; HMAC-SHA256 keys provided.</em> <a href="#a5"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a6">AES_cbc_sha256_decrypt</a> (uint16_t aes_keylen, uint8_t *aes_key, uint16_t sha256_keylen, uint8_t *sha256_key, uint8_t *<a class="el" href="e__des_8c.html#a1">iv</a>, uint8_t *input, uint16_t inputlen, uint8_t *output, uint16_t *outputlen, uint8_t compdigest)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>AES-CBC-SHA256 Decryption This function authenticates &amp; decrypts an inbound IPSEC packet using the AES-CBC and HMAC-SHA256 keys provided.</em> <a href="#a6"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a7">AES_cbc_sha384_encrypt</a> (uint16_t aes_keylen, uint8_t *aes_key, uint16_t sha384_keylen, uint8_t *sha384_key, uint8_t *espheader, uint8_t *<a class="el" href="e__des_8c.html#a1">iv</a>, uint8_t *input, uint16_t inputlen, uint8_t *output, uint16_t *outputlen)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>AES-CBC-SHA384 Encryption This function creates an IPSEC outbound packet using AES-CBC &amp; HMAC-SHA384 keys provided.</em> <a href="#a7"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a8">AES_cbc_sha384_decrypt</a> (uint16_t aes_keylen, uint8_t *aes_key, uint16_t sha384_keylen, uint8_t *sha384_key, uint8_t *<a class="el" href="e__des_8c.html#a1">iv</a>, uint8_t *input, uint16_t inputlen, uint8_t *output, uint16_t *outputlen, uint8_t compdigest)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>AES-CBC-SHA384 Decryption This function authenticates &amp; decrypts an inbound IPSEC packet using the AES-CBC and HMAC-SHA384 keys provided.</em> <a href="#a8"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a9">AES_cbc_sha512_encrypt</a> (uint16_t aes_keylen, uint8_t *aes_key, uint16_t sha512_keylen, uint8_t *sha512_key, uint8_t *espheader, uint8_t *<a class="el" href="e__des_8c.html#a1">iv</a>, uint8_t *input, uint16_t inputlen, uint8_t *output, uint16_t *outputlen)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>AES-CBC-SHA512 Encryption This function creates an IPSEC outbound packet using AES-CBC &amp; HMAC-SHA512 keys provided.</em> <a href="#a9"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="aes__cbc__sha2_8c.html#a10">AES_cbc_sha512_decrypt</a> (uint16_t aes_keylen, uint8_t *aes_key, uint16_t sha512_keylen, uint8_t *sha512_key, uint8_t *<a class="el" href="e__des_8c.html#a1">iv</a>, uint8_t *input, uint16_t inputlen, uint8_t *output, uint16_t *outputlen, uint8_t compdigest)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>AES-CBC-SHA512 Decryption This function authenticates &amp; decrypts an inbound IPSEC packet using the AES-CBC and HMAC-SHA512 keys provided.</em> <a href="#a10"></a><em></em></font><br><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a name="a1" doxytag="aes_cbc_sha2.c::AES_CBC_IV_LENGTH"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define AES_CBC_IV_LENGTH&nbsp;&nbsp;&nbsp;16
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a0" doxytag="aes_cbc_sha2.c::ESP_HEADER_LENGTH"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ESP_HEADER_LENGTH&nbsp;&nbsp;&nbsp;8
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="a2" doxytag="aes_cbc_sha2.c::ESP_HMAC_LEN"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ESP_HMAC_LEN&nbsp;&nbsp;&nbsp;12
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a4" doxytag="aes_cbc_sha2.c::AES_cbc_sha224_decrypt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AES_cbc_sha224_decrypt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha224_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha224_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iv</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>input</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>inputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>output</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>outputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>compdigest</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES-CBC-SHA224 Decryption This function authenticates &amp; decrypts an inbound IPSEC packet using the AES-CBC and HMAC-SHA224 keys provided.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>aes_keylen</em>&nbsp;</td><td>
[in] AES CBC decryption key length </td></tr>
<tr><td valign=top><em>aes_key</em>&nbsp;</td><td>
[in] AES CBC decryption key </td></tr>
<tr><td valign=top><em>sha224_keylen</em>&nbsp;</td><td>
[in] HMAC-SHA224 key length </td></tr>
<tr><td valign=top><em>sha224_key</em>&nbsp;</td><td>
[in] HMAC-SHA224 key </td></tr>
<tr><td valign=top><em>iv</em>&nbsp;</td><td>
[in] Initialization vector (must be of AES_BLOCK_SIZE  in length). </td></tr>
<tr><td valign=top><em>input</em>&nbsp;</td><td>
[in] Pointer to the IPSEC packet (i.e, points to ESP  header) </td></tr>
<tr><td valign=top><em>inputlen</em>&nbsp;</td><td>
[in] Length of IPSEC packet pointed to by input. It  should include the  ESP header (8 bytes) + IV (AES_BLOCK_SIZE) + PAYLOAD length + HMAC (12 bytes) </td></tr>
<tr><td valign=top><em>output</em>&nbsp;</td><td>
[out] Pointer to the output buffer where decrypted and  authenticated packet should be placed </td></tr>
<tr><td valign=top><em>outputlen</em>&nbsp;</td><td>
[in/out] Length of output buffer (in bytes). The  function returns the number of bytes placed in the output buffer. If output  buffer provided is too small, no operation is performed and the size of  output buffer required to perform the operation is placed in this parameter </td></tr>
<tr><td valign=top><em>compdigest</em>&nbsp;</td><td>
If this is non-zero, then the IPSEC packet is  authenticated first. If the authentication succeeds, then the packet is  decrypted. If this is 0, then the IPSEC packet is not authenticated. The  IPSEC packet is decrypted and HMAC is placed at the end of the decrypted  packet </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
AES_CBC_SHA_SUCCESS (0) AES_CBC_SHA_INVALID_ARGUMENT (-1) AES_CBC_SHA_INVALID_KEYLENGTH (-2) AES_CBC_SHA_BUFFER_TOO_SMALL (-3) </dl>    </td>
  </tr>
</table>
<a name="a3" doxytag="aes_cbc_sha2.c::AES_cbc_sha224_encrypt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AES_cbc_sha224_encrypt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha224_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha224_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>espheader</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iv</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>input</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>inputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>output</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>outputlen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES-CBC-SHA224 Encryption This function creates an IPSEC outbound packet using AES-CBC &amp; HMAC-SHA224 keys provided.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>aes_keylen</em>&nbsp;</td><td>
[in] AES CBC encryption key length </td></tr>
<tr><td valign=top><em>aes_key</em>&nbsp;</td><td>
[in] AES CBC encryption key </td></tr>
<tr><td valign=top><em>sha224_keylen</em>&nbsp;</td><td>
[in] HMAC-SHA224 key length </td></tr>
<tr><td valign=top><em>sha224_key</em>&nbsp;</td><td>
[in] HMAC-SHA224 key </td></tr>
<tr><td valign=top><em>espheader</em>&nbsp;</td><td>
[in] Pointer to the ESP header (must be of 8 bytes in  length). It is placed at the start of the output packet </td></tr>
<tr><td valign=top><em>iv</em>&nbsp;</td><td>
[in] Initialization vector (must be of AES_BLOCK_SIZE  in length). It is placed after ESP header in the output packet </td></tr>
<tr><td valign=top><em>input</em>&nbsp;</td><td>
[in] Pointer to the input payload (to be encrypted) </td></tr>
<tr><td valign=top><em>inputlen</em>&nbsp;</td><td>
[in] Length of input data (in bytes) pointed to by  input parameter. The inputlen should be a multiple of AES block size.  This function doesn't pad anything at the end of the input. </td></tr>
<tr><td valign=top><em>output</em>&nbsp;</td><td>
[out] Pointer to the output buffer where encrypted  and authenticated packet should be placed </td></tr>
<tr><td valign=top><em>outputlen</em>&nbsp;</td><td>
[in/out] Length of output buffer (in bytes). The  function returns the number of bytes placed in the output buffer. If  output buffer provided is too small, no operation is performed and the  size of output buffer required to perform the operation is placed in this  parameter </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
AES_CBC_SHA_SUCCESS (0) AES_CBC_SHA_INVALID_ARGUMENT (-1) AES_CBC_SHA_INVALID_KEYLENGTH (-2) AES_CBC_SHA_BUFFER_TOO_SMALL (-3) </dl>    </td>
  </tr>
</table>
<a name="a6" doxytag="aes_cbc_sha2.c::AES_cbc_sha256_decrypt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AES_cbc_sha256_decrypt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha256_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha256_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iv</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>input</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>inputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>output</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>outputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>compdigest</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES-CBC-SHA256 Decryption This function authenticates &amp; decrypts an inbound IPSEC packet using the AES-CBC and HMAC-SHA256 keys provided.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>aes_keylen</em>&nbsp;</td><td>
[in] AES CBC decryption key length </td></tr>
<tr><td valign=top><em>aes_key</em>&nbsp;</td><td>
[in] AES CBC decryption key </td></tr>
<tr><td valign=top><em>sha256_keylen</em>&nbsp;</td><td>
[in] HMAC-SHA256 key length </td></tr>
<tr><td valign=top><em>sha256_key</em>&nbsp;</td><td>
[in] HMAC-SHA256 key </td></tr>
<tr><td valign=top><em>iv</em>&nbsp;</td><td>
[in] Initialization vector (must be of AES_BLOCK_SIZE  in length). </td></tr>
<tr><td valign=top><em>input</em>&nbsp;</td><td>
[in] Pointer to the IPSEC packet (i.e, points to ESP  header) </td></tr>
<tr><td valign=top><em>inputlen</em>&nbsp;</td><td>
[in] Length of IPSEC packet pointed to by input.  It should include the  ESP header (8 bytes) + IV (AES_BLOCK_SIZE) + PAYLOAD length+ HMAC (12 bytes) </td></tr>
<tr><td valign=top><em>output</em>&nbsp;</td><td>
[out] Pointer to the output buffer where decrypted and  authenticated packet should be placed </td></tr>
<tr><td valign=top><em>outputlen</em>&nbsp;</td><td>
[in/out] Length of output buffer (in bytes). The  function returns the number of bytes placed in the output buffer. If output  buffer provided is too small, no operation is performed and the size of  output buffer required to perform the operation is placed in this parameter </td></tr>
<tr><td valign=top><em>compdigest</em>&nbsp;</td><td>
If this is non-zero, then the IPSEC packet is  authenticated first. If the authentication succeeds, then the packet is  decrypted. If this is 0, then the IPSEC packet is not authenticated. The  IPSEC packet is decrypted and HMAC is placed at the end of the decrypted  packet </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
AES_CBC_SHA_SUCCESS (0) AES_CBC_SHA_INVALID_ARGUMENT (-1) AES_CBC_SHA_INVALID_KEYLENGTH (-2) AES_CBC_SHA_BUFFER_TOO_SMALL (-3) </dl>    </td>
  </tr>
</table>
<a name="a5" doxytag="aes_cbc_sha2.c::AES_cbc_sha256_encrypt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AES_cbc_sha256_encrypt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha256_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha256_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>espheader</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iv</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>input</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>inputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>output</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>outputlen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES-CBC-SHA256 Encryption This function creates an IPSEC outbound packet using AES-CBC &amp; HMAC-SHA256 keys provided.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>aes_keylen</em>&nbsp;</td><td>
[in] AES CBC encryption key length </td></tr>
<tr><td valign=top><em>aes_key</em>&nbsp;</td><td>
[in] AES CBC encryption key </td></tr>
<tr><td valign=top><em>sha256_keylen</em>&nbsp;</td><td>
[in] HMAC-SHA256 key length </td></tr>
<tr><td valign=top><em>sha256_key</em>&nbsp;</td><td>
[in] HMAC-SHA256 key </td></tr>
<tr><td valign=top><em>espheader</em>&nbsp;</td><td>
[in] Pointer to the ESP header (must be of 8 bytes  in length). It is placed at the start of the output packet </td></tr>
<tr><td valign=top><em>iv</em>&nbsp;</td><td>
[in] Initialization vector (must be of AES_BLOCK_SIZE  in length). It is placed after ESP header in the output packet </td></tr>
<tr><td valign=top><em>input</em>&nbsp;</td><td>
[in] Pointer to the input payload (to be encrypted) </td></tr>
<tr><td valign=top><em>inputlen</em>&nbsp;</td><td>
[in] Length of input data (in bytes) pointed to by  input parameter. The inputlen should be a multiple of AES block size.  This function doesn't pad anything at the end of the input. </td></tr>
<tr><td valign=top><em>output</em>&nbsp;</td><td>
[out] Pointer to the output buffer where encrypted and  authenticated packet should be placed </td></tr>
<tr><td valign=top><em>outputlen</em>&nbsp;</td><td>
[in/out] Length of output buffer (in bytes). The  function returns the number of bytes placed in the output buffer. If  output buffer provided is too small, no operation is performed and the  size of output buffer required to perform the operation is placed in  this parameter </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
AES_CBC_SHA_SUCCESS (0) AES_CBC_SHA_INVALID_ARGUMENT (-1) AES_CBC_SHA_INVALID_KEYLENGTH (-2) AES_CBC_SHA_BUFFER_TOO_SMALL (-3) </dl>    </td>
  </tr>
</table>
<a name="a8" doxytag="aes_cbc_sha2.c::AES_cbc_sha384_decrypt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AES_cbc_sha384_decrypt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha384_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha384_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iv</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>input</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>inputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>output</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>outputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>compdigest</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES-CBC-SHA384 Decryption This function authenticates &amp; decrypts an inbound IPSEC packet using the AES-CBC and HMAC-SHA384 keys provided.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>aes_keylen</em>&nbsp;</td><td>
[in] AES CBC decryption key length </td></tr>
<tr><td valign=top><em>aes_key</em>&nbsp;</td><td>
[in] AES CBC decryption key </td></tr>
<tr><td valign=top><em>sha384_keylen</em>&nbsp;</td><td>
[in] HMAC-SHA384 key length </td></tr>
<tr><td valign=top><em>sha384_key</em>&nbsp;</td><td>
[in] HMAC-SHA384 key </td></tr>
<tr><td valign=top><em>iv</em>&nbsp;</td><td>
[in] Initialization vector (must be of AES_BLOCK_SIZE  in length). </td></tr>
<tr><td valign=top><em>input</em>&nbsp;</td><td>
[in] Pointer to the IPSEC packet (i.e, points to ESP  header) </td></tr>
<tr><td valign=top><em>inputlen</em>&nbsp;</td><td>
[in] Length of IPSEC packet pointed to by input. It  should include the  ESP header (8 bytes) + IV (AES_BLOCK_SIZE) + PAYLOAD length + HMAC (12 bytes) </td></tr>
<tr><td valign=top><em>output</em>&nbsp;</td><td>
[out] Pointer to the output buffer where decrypted and  authenticated packet should be placed </td></tr>
<tr><td valign=top><em>outputlen</em>&nbsp;</td><td>
[in/out] Length of output buffer (in bytes). The  function returns the number of bytes placed in the output buffer. If output  buffer provided is too small, no operation is performed and the size of output buffer required to perform the operation is placed in this parameter </td></tr>
<tr><td valign=top><em>compdigest</em>&nbsp;</td><td>
If this is non-zero, then the IPSEC packet is  authenticated first. If the authentication succeeds, then the packet is  decrypted. If this is 0, then the IPSEC packet is not authenticated. The  IPSEC packet is decrypted and HMAC is placed at the end of the decrypted  packet </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
AES_CBC_SHA_SUCCESS (0) AES_CBC_SHA_INVALID_ARGUMENT (-1) AES_CBC_SHA_INVALID_KEYLENGTH (-2) AES_CBC_SHA_BUFFER_TOO_SMALL (-3) </dl>    </td>
  </tr>
</table>
<a name="a7" doxytag="aes_cbc_sha2.c::AES_cbc_sha384_encrypt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AES_cbc_sha384_encrypt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha384_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha384_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>espheader</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iv</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>input</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>inputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>output</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>outputlen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES-CBC-SHA384 Encryption This function creates an IPSEC outbound packet using AES-CBC &amp; HMAC-SHA384 keys provided.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>aes_keylen</em>&nbsp;</td><td>
[in] AES CBC encryption key length </td></tr>
<tr><td valign=top><em>aes_key</em>&nbsp;</td><td>
[in] AES CBC encryption key </td></tr>
<tr><td valign=top><em>sha384_keylen</em>&nbsp;</td><td>
[in] HMAC-SHA384 key length </td></tr>
<tr><td valign=top><em>sha384_key</em>&nbsp;</td><td>
[in] HMAC-SHA384 key </td></tr>
<tr><td valign=top><em>espheader</em>&nbsp;</td><td>
[in] Pointer to the ESP header (must be of 8 bytes in  length). It is placed at the start of the output packet </td></tr>
<tr><td valign=top><em>iv</em>&nbsp;</td><td>
[in] Initialization vector (must be of AES_BLOCK_SIZE  in length). It is placed after ESP header in the output packet </td></tr>
<tr><td valign=top><em>input</em>&nbsp;</td><td>
[in] Pointer to the input payload (to be encrypted) </td></tr>
<tr><td valign=top><em>inputlen</em>&nbsp;</td><td>
[in] Length of input data (in bytes) pointed to by  input parameter. The inputlen should be a multiple of AES block size. This  function doesn't pad anything at the end of the input. </td></tr>
<tr><td valign=top><em>output</em>&nbsp;</td><td>
[out] Pointer to the output buffer where encrypted and  authenticated packet should be placed </td></tr>
<tr><td valign=top><em>outputlen</em>&nbsp;</td><td>
[in/out] Length of output buffer (in bytes). The  function returns the number of bytes placed in the output buffer. If output buffer provided is too small, no operation is performed and the size  of output buffer required to perform the operation is placed in this  parameter </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
AES_CBC_SHA_SUCCESS (0) AES_CBC_SHA_INVALID_ARGUMENT (-1) AES_CBC_SHA_INVALID_KEYLENGTH (-2) AES_CBC_SHA_BUFFER_TOO_SMALL (-3) </dl>    </td>
  </tr>
</table>
<a name="a10" doxytag="aes_cbc_sha2.c::AES_cbc_sha512_decrypt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AES_cbc_sha512_decrypt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha512_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha512_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iv</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>input</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>inputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>output</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>outputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>compdigest</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES-CBC-SHA512 Decryption This function authenticates &amp; decrypts an inbound IPSEC packet using the AES-CBC and HMAC-SHA512 keys provided.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>aes_keylen</em>&nbsp;</td><td>
[in] AES CBC decryption key length </td></tr>
<tr><td valign=top><em>aes_key</em>&nbsp;</td><td>
[in] AES CBC decryption key </td></tr>
<tr><td valign=top><em>sha512_keylen</em>&nbsp;</td><td>
[in] HMAC-SHA512 key length </td></tr>
<tr><td valign=top><em>sha512_key</em>&nbsp;</td><td>
[in] HMAC-SHA512 key </td></tr>
<tr><td valign=top><em>iv</em>&nbsp;</td><td>
[in] Initialization vector (must be of AES_BLOCK_SIZE  in length). </td></tr>
<tr><td valign=top><em>input</em>&nbsp;</td><td>
[in] Pointer to the IPSEC packet (i.e, points to ESP  header) </td></tr>
<tr><td valign=top><em>inputlen</em>&nbsp;</td><td>
[in] Length of IPSEC packet pointed to by input. It  should include the  ESP header (8 bytes) + IV (AES_BLOCK_SIZE) + PAYLOAD length + HMAC (12 bytes) </td></tr>
<tr><td valign=top><em>output</em>&nbsp;</td><td>
[out] Pointer to the output buffer where decrypted and i authenticated packet should be placed </td></tr>
<tr><td valign=top><em>outputlen</em>&nbsp;</td><td>
[in/out] Length of output buffer (in bytes). The  function returns the number of bytes placed in the output buffer. If output  buffer provided is too small, no operation is performed and the size of  output buffer required to perform the operation is placed in this parameter </td></tr>
<tr><td valign=top><em>compdigest</em>&nbsp;</td><td>
If this is non-zero, then the IPSEC packet is  authenticated first. If the authentication succeeds, then the packet is  decrypted. If this is 0, then the IPSEC packet is not authenticated. The  IPSEC packet is decrypted and HMAC is placed at the end of the decrypted  packet </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
AES_CBC_SHA_SUCCESS (0) AES_CBC_SHA_INVALID_ARGUMENT (-1) AES_CBC_SHA_INVALID_KEYLENGTH (-2) AES_CBC_SHA_BUFFER_TOO_SMALL (-3) </dl>    </td>
  </tr>
</table>
<a name="a9" doxytag="aes_cbc_sha2.c::AES_cbc_sha512_encrypt"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AES_cbc_sha512_encrypt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aes_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha512_keylen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sha512_key</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>espheader</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>iv</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>input</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>inputlen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>output</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint16_t *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>outputlen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES-CBC-SHA512 Encryption This function creates an IPSEC outbound packet using AES-CBC &amp; HMAC-SHA512 keys provided.
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>aes_keylen</em>&nbsp;</td><td>
[in] AES CBC encryption key length </td></tr>
<tr><td valign=top><em>aes_key</em>&nbsp;</td><td>
[in] AES CBC encryption key </td></tr>
<tr><td valign=top><em>sha512_keylen</em>&nbsp;</td><td>
[in] HMAC-SHA512 key length </td></tr>
<tr><td valign=top><em>sha512_key</em>&nbsp;</td><td>
[in] HMAC-SHA512 key </td></tr>
<tr><td valign=top><em>espheader</em>&nbsp;</td><td>
[in] Pointer to the ESP header (must be of 8 bytes in  length). It is placed at the start of the output packet </td></tr>
<tr><td valign=top><em>iv</em>&nbsp;</td><td>
[in] Initialization vector (must be of AES_BLOCK_SIZE  in length).It is placed after ESP header in the output packet </td></tr>
<tr><td valign=top><em>input</em>&nbsp;</td><td>
[in] Pointer to the input payload (to be encrypted) </td></tr>
<tr><td valign=top><em>inputlen</em>&nbsp;</td><td>
[in] Length of input data (in bytes) pointed to by  input parameter. The inputlen should be a multiple of AES block size.  This function doesn't pad anything at the end of the input. </td></tr>
<tr><td valign=top><em>output</em>&nbsp;</td><td>
[out] Pointer to the output buffer where encrypted and  authenticated packet should be placed </td></tr>
<tr><td valign=top><em>outputlen</em>&nbsp;</td><td>
[in/out] Length of output buffer (in bytes). The function returns the number of bytes placed in the output buffer. If output  buffer provided is too small, no operation is performed and the size of output buffer required to perform the operation is placed in this parameter </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
AES_CBC_SHA_SUCCESS (0) AES_CBC_SHA_INVALID_ARGUMENT (-1) AES_CBC_SHA_INVALID_KEYLENGTH (-2) AES_CBC_SHA_BUFFER_TOO_SMALL (-3) </dl>    </td>
  </tr>
</table>
<hr><address style="align: right;"><small>Generated on Mon Aug 14 19:59:39 2006 for Octeon Core Crypto API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
