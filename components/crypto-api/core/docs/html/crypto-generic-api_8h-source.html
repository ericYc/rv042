<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>crypto-generic-api.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>crypto-generic-api.h</h1><a href="crypto-generic-api_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">   Copyright (c) 2003-2005, Cavium Networks. All rights reserved.</span>
00003 <span class="comment"></span>
00004 <span class="comment">   This Software is the property of Cavium Networks. The Software and all </span>
00005 <span class="comment">   accompanying documentation are copyrighted. The Software made available here </span>
00006 <span class="comment">   constitutes the proprietary information of Cavium Networks. You agree to </span>
00007 <span class="comment">   take reasonable steps to prevent the disclosure, unauthorized use or </span>
00008 <span class="comment">   unauthorized distribution of the Software. You shall use this Software</span>
00009 <span class="comment">   solely with Cavium hardware.</span>
00010 <span class="comment"></span>
00011 <span class="comment">   Except as expressly permitted in a separate Software License Agreement</span>
00012 <span class="comment">   between You and Cavium Networks, you shall not modify, decompile,</span>
00013 <span class="comment">   disassemble, extract, or otherwise reverse engineer this Software. You shall</span>
00014 <span class="comment">   not make any copy of the Software or its accompanying documentation, except</span>
00015 <span class="comment">   for copying incident to the ordinary and intended use of the Software and</span>
00016 <span class="comment">   the Underlying Program and except for the making of a single archival copy.</span>
00017 <span class="comment"></span>
00018 <span class="comment">   This Software, including technical data, may be subject to U.S. export</span>
00019 <span class="comment">   control laws, including the U.S. Export Administration Act and its</span>
00020 <span class="comment">   associated regulations, and may be subject to export or import regulations</span>
00021 <span class="comment">   in other countries. You warrant that You will comply strictly in all</span>
00022 <span class="comment">   respects with all such regulations and acknowledge that you have the</span>
00023 <span class="comment">   responsibility to obtain licenses to export, re-export or import the</span>
00024 <span class="comment">   Software.</span>
00025 <span class="comment"></span>
00026 <span class="comment">   TO THE MAXIMUM EXTENT PERMITTED BY LAW, THE SOFTWARE IS PROVIDED "AS IS" AND</span>
00027 <span class="comment">   WITH ALL FAULTS AND CAVIUM MAKES NO PROMISES, REPRESENTATIONS OR WARRANTIES,</span>
00028 <span class="comment">   EITHER EXPRESS, IMPLIED, STATUTORY, OR OTHERWISE, WITH RESPECT TO THE</span>
00029 <span class="comment">   SOFTWARE, INCLUDING ITS CONDITION, ITS CONFORMITY TO ANY REPRESENTATION OR</span>
00030 <span class="comment">   DESCRIPTION, OR THE EXISTENCE OF ANY LATENT OR PATENT DEFECTS, AND CAVIUM</span>
00031 <span class="comment">   SPECIFICALLY DISCLAIMS ALL IMPLIED (IF ANY) WARRANTIES OF TITLE,</span>
00032 <span class="comment">   MERCHANTABILITY, NONINFRINGEMENT, FITNESS FOR A PARTICULAR PURPOSE, LACK OF</span>
00033 <span class="comment">   VIRUSES, ACCURACY OR COMPLETENESS, QUIET ENJOYMENT, QUIET POSSESSION OR</span>
00034 <span class="comment">   CORRESPONDENCE TO DESCRIPTION. THE ENTIRE RISK ARISING OUT OF USE OR</span>
00035 <span class="comment">   PERFORMANCE OF THE SOFTWARE LIES WITH YOU.</span>
00036 <span class="comment"> */</span>
00037 
00038 <span class="preprocessor">#ifndef __CRYPTO_GENERIC_API__</span>
00039 <span class="preprocessor"></span><span class="preprocessor">#define __CRYPTO_GENERIC_API__</span>
00040 <span class="preprocessor"></span>
00041 <span class="preprocessor">#include &lt;<a class="code" href="hmac_8h.html">openssl/hmac.h</a>&gt;</span>
00042 <span class="preprocessor">#include &lt;<a class="code" href="des_8h.html">openssl/des.h</a>&gt;</span>
00043 <span class="preprocessor">#include &lt;<a class="code" href="aes_8h.html">openssl/aes.h</a>&gt;</span>
00044 <span class="preprocessor">#include &lt;<a class="code" href="dh_8h.html">openssl/dh.h</a>&gt;</span>
00045 <span class="preprocessor">#include &lt;<a class="code" href="bn_8h.html">openssl/bn.h</a>&gt;</span>
00046 <span class="preprocessor">#include &lt;<a class="code" href="rsa_8h.html">openssl/rsa.h</a>&gt;</span>
00047 <span class="preprocessor">#include &lt;<a class="code" href="err_8h.html">openssl/err.h</a>&gt;</span>
00048 
<a name="l00049"></a><a class="code" href="crypto-generic-api_8h.html#a0">00049</a> <span class="preprocessor">#define HMACMD5         0</span>
<a name="l00050"></a><a class="code" href="crypto-generic-api_8h.html#a1">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define HMACSHA         1</span>
00051 <span class="preprocessor"></span>
<a name="l00052"></a><a class="code" href="crypto-generic-api_8h.html#a2">00052</a> <span class="preprocessor">#define SINGLEDES       0</span>
<a name="l00053"></a><a class="code" href="crypto-generic-api_8h.html#a3">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define TRIPLEDES       1</span>
<a name="l00054"></a><a class="code" href="crypto-generic-api_8h.html#a4">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define DES_BLOCK_SIZE  8</span>
00055 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="crypto-generic-api_8h.html#a5">00056</a> <span class="preprocessor">#define AES128_CBC      0</span>
<a name="l00057"></a><a class="code" href="crypto-generic-api_8h.html#a6">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define AES192_CBC      1</span>
<a name="l00058"></a><a class="code" href="crypto-generic-api_8h.html#a7">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define AES256_CBC      2</span>
<a name="l00059"></a><a class="code" href="crypto-generic-api_8h.html#a8">00059</a> <span class="preprocessor"></span><span class="preprocessor">#define AES_BLOCK_SIZE  16</span>
00060 <span class="preprocessor"></span>
00061 
00062 <span class="comment">/* Library Codes */</span>
<a name="l00063"></a><a class="code" href="crypto-generic-api_8h.html#a9">00063</a> <span class="preprocessor">#define CGAPI_ERR_LIB_RSA       100</span>
<a name="l00064"></a><a class="code" href="crypto-generic-api_8h.html#a10">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define CGAPI_ERR_LIB_DH        101</span>
<a name="l00065"></a><a class="code" href="crypto-generic-api_8h.html#a11">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define CGAPI_ERR_LIB_AES       102</span>
<a name="l00066"></a><a class="code" href="crypto-generic-api_8h.html#a12">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define CGAPI_ERR_LIB_DES       103</span>
<a name="l00067"></a><a class="code" href="crypto-generic-api_8h.html#a13">00067</a> <span class="preprocessor"></span><span class="preprocessor">#define CGAPI_ERR_LIB_BIGNUM    104</span>
<a name="l00068"></a><a class="code" href="crypto-generic-api_8h.html#a14">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define CGAPI_ERR_LIB_HMAC      105</span>
00069 <span class="preprocessor"></span>
00070 
00071 <span class="comment">/* Function Codes */</span>
<a name="l00072"></a><a class="code" href="crypto-generic-api_8h.html#a15">00072</a> <span class="preprocessor">#define RSA_F_CGAPI_RSA_GENERATE_KEY_PAIR    500</span>
<a name="l00073"></a><a class="code" href="crypto-generic-api_8h.html#a16">00073</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_CGAPI_RSA_PRIVATE_DECRYPT      501</span>
<a name="l00074"></a><a class="code" href="crypto-generic-api_8h.html#a17">00074</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_CGAPI_RSA_PRIVATE_ENCRYPT      502</span>
<a name="l00075"></a><a class="code" href="crypto-generic-api_8h.html#a18">00075</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_CGAPI_RSA_PUBLIC_DECRYPT       503</span>
<a name="l00076"></a><a class="code" href="crypto-generic-api_8h.html#a19">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_F_CGAPI_RSA_PUBLIC_ENCRYPT       504</span>
00077 <span class="preprocessor"></span>
<a name="l00078"></a><a class="code" href="crypto-generic-api_8h.html#a20">00078</a> <span class="preprocessor">#define DH_F_CGAPI_DH_GENERATE_KEY_PAIR      505</span>
<a name="l00079"></a><a class="code" href="crypto-generic-api_8h.html#a21">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define DH_F_CGAPI_DH_GENERATE_SHARED_SECRET 506</span>
00080 <span class="preprocessor"></span>
<a name="l00081"></a><a class="code" href="crypto-generic-api_8h.html#a22">00081</a> <span class="preprocessor">#define AES_F_CGAPI_ENCRYPT                  507</span>
<a name="l00082"></a><a class="code" href="crypto-generic-api_8h.html#a23">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define AES_F_CGAPI_DECRYPT                  508</span>
00083 <span class="preprocessor"></span>
<a name="l00084"></a><a class="code" href="crypto-generic-api_8h.html#a24">00084</a> <span class="preprocessor">#define DES_F_CGAPI_ENCRYPT                  509</span>
<a name="l00085"></a><a class="code" href="crypto-generic-api_8h.html#a25">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define DES_F_CGAPI_DECRYPT                  510</span>
00086 <span class="preprocessor"></span>
<a name="l00087"></a><a class="code" href="crypto-generic-api_8h.html#a26">00087</a> <span class="preprocessor">#define HMAC_F_CGAPI                         511</span>
00088 <span class="preprocessor"></span>
00089 
00090 <span class="comment">/* Reason Codes */</span>
<a name="l00091"></a><a class="code" href="crypto-generic-api_8h.html#a27">00091</a> <span class="preprocessor">#define RSA_R_CGAPI_BAD_GENERATOR            500</span>
<a name="l00092"></a><a class="code" href="crypto-generic-api_8h.html#a28">00092</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_CGAPI_BAD_PRIVATE_ENCRYPT      501</span>
<a name="l00093"></a><a class="code" href="crypto-generic-api_8h.html#a29">00093</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_CGAPI_BAD_PUBLIC_ENCRYPT       502</span>
<a name="l00094"></a><a class="code" href="crypto-generic-api_8h.html#a30">00094</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_CGAPI_BAD_PRIVATE_DECRYPT      503</span>
<a name="l00095"></a><a class="code" href="crypto-generic-api_8h.html#a31">00095</a> <span class="preprocessor"></span><span class="preprocessor">#define RSA_R_CGAPI_BAD_PUBLIC_DECRYPT       504</span>
00096 <span class="preprocessor"></span>
<a name="l00097"></a><a class="code" href="crypto-generic-api_8h.html#a32">00097</a> <span class="preprocessor">#define DH_R_CGAPI_BAD_GENERATOR             505</span>
<a name="l00098"></a><a class="code" href="crypto-generic-api_8h.html#a33">00098</a> <span class="preprocessor"></span><span class="preprocessor">#define DH_R_CGAPI_BAD_SHARED_KEY            506</span>
00099 <span class="preprocessor"></span>
<a name="l00100"></a><a class="code" href="crypto-generic-api_8h.html#a34">00100</a> <span class="preprocessor">#define DES_R_CGAPI_WRONG_KEY                507</span>
<a name="l00101"></a><a class="code" href="crypto-generic-api_8h.html#a35">00101</a> <span class="preprocessor"></span><span class="preprocessor">#define DES_R_CGAPI_WRONGDES                 508</span>
00102 <span class="preprocessor"></span>
<a name="l00103"></a><a class="code" href="crypto-generic-api_8h.html#a36">00103</a> <span class="preprocessor">#define AES_R_CGAPI_WRONG_KEY                509</span>
<a name="l00104"></a><a class="code" href="crypto-generic-api_8h.html#a37">00104</a> <span class="preprocessor"></span><span class="preprocessor">#define AES_R_CGAPI_WRONGAES                 510</span>
00105 <span class="preprocessor"></span>
<a name="l00106"></a><a class="code" href="crypto-generic-api_8h.html#a38">00106</a> <span class="preprocessor">#define HMAC_F_CGAPI_WRONG_HMAC              511</span>
00107 <span class="preprocessor"></span>
<a name="l00108"></a><a class="code" href="crypto-generic-api_8h.html#a39">00108</a> <span class="preprocessor">#define CGAPI_R_BAD_BIN2BN                   512</span>
<a name="l00109"></a><a class="code" href="crypto-generic-api_8h.html#a40">00109</a> <span class="preprocessor"></span><span class="preprocessor">#define CGAPI_R_BAD_BN2BIN                   513</span>
00110 <span class="preprocessor"></span>
<a name="l00111"></a><a class="code" href="crypto-generic-api_8h.html#a41">00111</a> <span class="preprocessor">#define CGAPI_R_MEMORY_ALLOC_FAIL            514</span>
<a name="l00112"></a><a class="code" href="crypto-generic-api_8h.html#a42">00112</a> <span class="preprocessor"></span><span class="preprocessor">#define CGAPI_R_INVALID_BLOCK_OF_INPUT_SIZE  515   </span><span class="comment">/* Input size must be multiple of block size for block ciphers */</span>
<a name="l00113"></a><a class="code" href="crypto-generic-api_8h.html#a43">00113</a> <span class="preprocessor">#define CGAPI_R_INSUFFICIENT_OUTBUF          516</span>
00114 <span class="preprocessor"></span>
00115 
00116 
<a name="l00117"></a><a class="code" href="structrsa__st__.html">00117</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structrsa__st__.html">rsa_st_</a> {
<a name="l00118"></a><a class="code" href="structrsa__st__.html#m0">00118</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structrsa__st__.html#m0">modulus_length</a>;   <span class="comment">/**&lt; Length in bits of the key's modulus */</span>
<a name="l00119"></a><a class="code" href="structrsa__st__.html#m1">00119</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__st__.html#m1">e_ptr</a>;    <span class="comment">/**&lt; pointer to the exponent to be used */</span>
<a name="l00120"></a><a class="code" href="structrsa__st__.html#m2">00120</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__st__.html#m2">n_ptr</a>;    <span class="comment">/**&lt; pointer to a buffer where newly created modulus will be written */</span>
<a name="l00121"></a><a class="code" href="structrsa__st__.html#m3">00121</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__st__.html#m3">p_ptr</a>;    <span class="comment">/**&lt; pointer to a buffer where the newly created RSA prime p will be written */</span>
<a name="l00122"></a><a class="code" href="structrsa__st__.html#m4">00122</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__st__.html#m4">q_ptr</a>;    <span class="comment">/**&lt; pointer to a buffer where the newly created RSA prime q will be written */</span>
<a name="l00123"></a><a class="code" href="structrsa__st__.html#m5">00123</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__st__.html#m5">d_ptr</a>;    <span class="comment">/**&lt; pointer to a buffer where the newly created private exponent d will be written */</span>
<a name="l00124"></a><a class="code" href="structrsa__st__.html#m6">00124</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__st__.html#m6">dp_ptr</a>;    <span class="comment">/**&lt; pointer to a buffer where the newly created RSA private exponent dp will be written */</span>
<a name="l00125"></a><a class="code" href="structrsa__st__.html#m7">00125</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__st__.html#m7">dq_ptr</a>;    <span class="comment">/**&lt; pointer to a buffer where the newly created RSA private exponent dq will be written */</span>
<a name="l00126"></a><a class="code" href="structrsa__st__.html#m8">00126</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structrsa__st__.html#m8">pinv</a>;    <span class="comment">/**&lt; pointer to a buffer where the newly created RSA coefficient pinv will be written */</span>
<a name="l00127"></a><a class="code" href="structrsa__st__.html#m9">00127</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structrsa__st__.html#m9">nlen</a>;    <span class="comment">/**&lt; length of the newly created modulus */</span>
<a name="l00128"></a><a class="code" href="structrsa__st__.html#m10">00128</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structrsa__st__.html#m10">plen</a>;    <span class="comment">/**&lt; length of the newly created RSA prime p */</span>
<a name="l00129"></a><a class="code" href="structrsa__st__.html#m11">00129</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structrsa__st__.html#m11">qlen</a>;    <span class="comment">/**&lt; length of the newly created RSA prime q */</span>
<a name="l00130"></a><a class="code" href="structrsa__st__.html#m12">00130</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structrsa__st__.html#m12">dlen</a>;    <span class="comment">/**&lt; length of the newly created private exponent d */</span>
<a name="l00131"></a><a class="code" href="structrsa__st__.html#m13">00131</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structrsa__st__.html#m13">dplen</a>;   <span class="comment">/**&lt; length of the newly created private exponent dp */</span>
<a name="l00132"></a><a class="code" href="structrsa__st__.html#m14">00132</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structrsa__st__.html#m14">dqlen</a>;   <span class="comment">/**&lt; length of the newly created private exponent dq */</span>
<a name="l00133"></a><a class="code" href="structrsa__st__.html#m15">00133</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structrsa__st__.html#m15">pinvlen</a>;   <span class="comment">/**&lt; length of the newly created RSA coefficient pinv */</span>
00134 } <a class="code" href="structrsa__st__.html">rsa_st_t</a>;
00135 
<a name="l00136"></a><a class="code" href="structbuffers.html">00136</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbuffers.html">buffers</a> {
<a name="l00137"></a><a class="code" href="structbuffers.html#m0">00137</a>   <span class="keywordtype">int</span> <a class="code" href="structbuffers.html#m0">size</a>;                <span class="comment">/**&lt; size of the data */</span>
<a name="l00138"></a><a class="code" href="structbuffers.html#m1">00138</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structbuffers.html#m1">data</a>;     <span class="comment">/**&lt; pointer to the input buffer */</span>
<a name="l00139"></a><a class="code" href="structbuffers.html#m2">00139</a>   <span class="keyword">struct </span><a class="code" href="structbuffers.html">buffers</a> *next;    <span class="comment">/**&lt; pointer to the next buffer in the linked list */</span>
00140 } <a class="code" href="structbuffers.html">buffers_t</a>;
00141 
00142 <span class="comment"></span>
00143 <span class="comment">/**</span>
00144 <span class="comment"> * This API performs the first step of a Deffie-Hellman key exchange by </span>
00145 <span class="comment"> * generating private and public DH values.</span>
00146 <span class="comment"> * </span>
00147 <span class="comment"> * Input arguments :</span>
00148 <span class="comment"> * @param modulus_length the length in bits of the modulus.</span>
00149 <span class="comment"> * @param modulus the pointer to a buffer which contains the modulus.</span>
00150 <span class="comment"> * @param base_length the length in bits of the base.</span>
00151 <span class="comment"> * @param base the pointer to a buffer which contains the base output.</span>
00152 <span class="comment"> *</span>
00153 <span class="comment"> * Output arguments :</span>
00154 <span class="comment"> * @param public_key the pointer to an pre-allocated buffer which will </span>
00155 <span class="comment"> * save the public key generated by this function. The size of the buffer </span>
00156 <span class="comment"> * is same as the modulus.</span>
00157 <span class="comment"> * @param private_key the pointer to an pre-allocated buffer which will </span>
00158 <span class="comment"> * save the private key generated by this function. The size of the buffer</span>
00159 <span class="comment"> * is same as the base.</span>
00160 <span class="comment"> *</span>
00161 <span class="comment"> * @return 0 on success and error code on failure.</span>
00162 <span class="comment">*/</span>
00163 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a8">dh_generate_key_pair</a> (<span class="keywordtype">int</span> modulus_length,
00164   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *modulus,
00165   <span class="keywordtype">int</span> base_length,
00166   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *base,
00167   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *public_key, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *private_key);
00168 
00169 <span class="comment"></span>
00170 <span class="comment">/**</span>
00171 <span class="comment"> * It computes the shared secret from the private DH value and the other </span>
00172 <span class="comment"> * party's public key value and stores it in shared_secret.</span>
00173 <span class="comment"> * </span>
00174 <span class="comment"> * Input arguments :</span>
00175 <span class="comment"> * @param modulus_length the length in bits of the modulus.</span>
00176 <span class="comment"> * @param modulus the pointer to a buffer which contains the modulus.</span>
00177 <span class="comment"> * @param peer_public_key the pointer to a buffer which contains the peer </span>
00178 <span class="comment"> * public key, whose size must match the size of the modulus</span>
00179 <span class="comment"> * @param my_private_key the pointer to a buffer which contains the </span>
00180 <span class="comment"> * private key whose size is same as the base.</span>
00181 <span class="comment"> *</span>
00182 <span class="comment"> * Output argument :</span>
00183 <span class="comment"> * @param shared_secret the pointer to a pre-allocate buffer which will </span>
00184 <span class="comment"> *  save the shared secret generated from this function. The size of the </span>
00185 <span class="comment"> *  ouput is same as modulus.</span>
00186 <span class="comment"> *</span>
00187 <span class="comment"> * @return 0 on success and error code on failure.</span>
00188 <span class="comment">*/</span>
00189 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a9">dh_generate_shared_secret</a> (<span class="keywordtype">int</span> modulus_length,
00190   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *modulus,
00191   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *peer_public_key,
00192   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *my_private_key, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *shared_secret);
00193 
00194 <span class="comment"></span>
00195 <span class="comment">/** </span>
00196 <span class="comment"> * It generates a key pair. Key sizes with modulus_length less than 1024 </span>
00197 <span class="comment"> * bits should be considered insecure.</span>
00198 <span class="comment"> * </span>
00199 <span class="comment"> * Input arguments :</span>
00200 <span class="comment"> * @param rsast.modulus_length pointer to a buffer where the newly created </span>
00201 <span class="comment"> * modulus will be written.</span>
00202 <span class="comment"> * @param rsast.e_ptr pointer to a buffer where the exponent to be used. </span>
00203 <span class="comment"> *</span>
00204 <span class="comment"> * Output arguments :</span>
00205 <span class="comment"> * @param rsast.n_ptr pointer to a buffer where the newly created modulus </span>
00206 <span class="comment"> * will be written.</span>
00207 <span class="comment"> * @param rsast.p_ptr pointer to a buffer where the newly created RSA prime </span>
00208 <span class="comment"> * p will be written.</span>
00209 <span class="comment"> * @param rsast.q_ptr pionter to a buffer where the newly created RSA prime </span>
00210 <span class="comment"> * q will be written.</span>
00211 <span class="comment"> * @param rsast.d_ptr pointer to a buffer where the newly created RSA private </span>
00212 <span class="comment"> * exponent d will be written.</span>
00213 <span class="comment"> * @param rsast.dp_ptr pointer to a buffer where the newly created RSA private </span>
00214 <span class="comment"> * exponent dp will be written.</span>
00215 <span class="comment"> * @param rsast.dq_ptr pointer to a buffer where the newly created RSA private </span>
00216 <span class="comment"> * dq will be written.</span>
00217 <span class="comment"> * @param rsast.pinv_ptr pointer to a buffer where the newly created RSA </span>
00218 <span class="comment"> * coefficient 'pinv' will be written.</span>
00219 <span class="comment"> * @param rsast.nlen length of the newly created modulus.</span>
00220 <span class="comment"> * @param rsast.plen length of the newly created RSA prime p.</span>
00221 <span class="comment"> * @param rsast.qlen length of the newly created RSA prime q.</span>
00222 <span class="comment"> * @param rsast.dlen length of the newly created private exponent d.</span>
00223 <span class="comment"> * @param rsast.dplen length of the newly created private exponent dp.</span>
00224 <span class="comment"> * @param rsast.dqlen length of the newly created RSA private exponent dq.</span>
00225 <span class="comment"> * @param rsast.pinvlen length of the newly created RSA coefficient pinv.</span>
00226 <span class="comment"> *</span>
00227 <span class="comment"> * @return 0 on success and error code on failure.</span>
00228 <span class="comment"> * </span>
00229 <span class="comment"> * Note : It is the responsibility of the application to allocate sufficient </span>
00230 <span class="comment"> * memory to above parameters before calling this API.</span>
00231 <span class="comment"> */</span>
00232 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a10">rsa_create_key_pair</a> (<a class="code" href="structrsa__st__.html">rsa_st_t</a> * rsast);
00233 
00234 <span class="comment"></span>
00235 <span class="comment">/**</span>
00236 <span class="comment"> * This encrypts the 'input_data_length' bytes at 'input_data' using the </span>
00237 <span class="comment"> * private key 'rsast' and stores the result in 'output_data'.</span>
00238 <span class="comment"> *</span>
00239 <span class="comment"> * Input arguments : </span>
00240 <span class="comment"> * @param rsast RSA parameters which have been generated, including the </span>
00241 <span class="comment"> * private key.</span>
00242 <span class="comment"> * @param input_data_length the number of bytes of input data.</span>
00243 <span class="comment"> * @param input_data the pointer to the buffer containing the data.</span>
00244 <span class="comment"> *</span>
00245 <span class="comment"> * Output arguments :</span>
00246 <span class="comment"> * @param output_data the pointer to the buffer containing the encrypted data.</span>
00247 <span class="comment"> * @param output_data_length pointer to the output data length.</span>
00248 <span class="comment"> *</span>
00249 <span class="comment"> * @return 0 on success and error code on failure.</span>
00250 <span class="comment"> */</span>
00251 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a11">rsa_encrypt_with_private_key</a> (<a class="code" href="structrsa__st__.html">rsa_st_t</a> * rsast,
00252   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> input_data_length,
00253   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input_data,
00254   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *output_data_length, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output_data);
00255 
00256 <span class="comment"></span>
00257 <span class="comment">/**</span>
00258 <span class="comment"> * This decrypts the 'input_data_length' bytes at 'input_data' using the </span>
00259 <span class="comment"> * private key 'rsast' and stores the result in 'output_data'.</span>
00260 <span class="comment"> *</span>
00261 <span class="comment"> * Input arguments : </span>
00262 <span class="comment"> * @param rsast RSA parameters which have been generated, including the </span>
00263 <span class="comment"> * private key.</span>
00264 <span class="comment"> * @param input_data_length the number of bytes of input data.</span>
00265 <span class="comment"> * @param input_data the pointer to the buffer containing the data.</span>
00266 <span class="comment"> *</span>
00267 <span class="comment"> * Output arguments :</span>
00268 <span class="comment"> * @param output_data the pointer to the buffer containing the decrypted data.</span>
00269 <span class="comment"> * @param output_data_length pointer to the output data length.</span>
00270 <span class="comment"> *</span>
00271 <span class="comment"> * @return 0 on success and error code on failure.</span>
00272 <span class="comment"> */</span>
00273 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a14">rsa_decrypt_with_private_key</a> (<a class="code" href="structrsa__st__.html">rsa_st_t</a> * rsast,
00274   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> input_data_length,
00275   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input_data,
00276   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *output_data_length, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output_data);
00277 
00278 <span class="comment"></span>
00279 <span class="comment">/**</span>
00280 <span class="comment"> * This API encrypts 'input_data_length' bytes at 'input_data' using </span>
00281 <span class="comment"> * public key 'rsa' and stores the result in 'ouput_data'.</span>
00282 <span class="comment"> * </span>
00283 <span class="comment"> * Input arguments :</span>
00284 <span class="comment"> * @param rsast RSA parameters which have been generated, including public key.</span>
00285 <span class="comment"> * @param input_data_length the length of the input buffer.</span>
00286 <span class="comment"> * @param input_data the pointer to the input buffer.</span>
00287 <span class="comment"> *</span>
00288 <span class="comment"> * Output arguments :</span>
00289 <span class="comment"> * @param output_data the pointer to the ouput buffer containing the </span>
00290 <span class="comment"> * encrypted data.</span>
00291 <span class="comment"> * @param output_data_length pointer to the length of the output data.</span>
00292 <span class="comment"> *</span>
00293 <span class="comment"> * @return 0 on success and error code on failure.</span>
00294 <span class="comment"> */</span>
00295 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a13">rsa_encrypt_with_public_key</a> (<a class="code" href="structrsa__st__.html">rsa_st_t</a> * rsast,
00296   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> input_data_length,
00297   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input_data,
00298   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *output_data_length, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output_data);
00299 
00300 <span class="comment"></span>
00301 <span class="comment">/**</span>
00302 <span class="comment"> * This API decrypts 'input_data_length' bytes at 'input_data' using </span>
00303 <span class="comment"> * public key 'rsa' and stores the result in 'ouput_data'.</span>
00304 <span class="comment"> * </span>
00305 <span class="comment"> * Input arguments :</span>
00306 <span class="comment"> * @param rsast RSA parameters which have been generated, including public key.</span>
00307 <span class="comment"> * @param input_data_length the length of the input buffer.</span>
00308 <span class="comment"> * @param input_data the pointer to the input buffer.</span>
00309 <span class="comment"> *</span>
00310 <span class="comment"> * Output arguments :</span>
00311 <span class="comment"> * @param output_data the pointer to the ouput buffer containing the </span>
00312 <span class="comment"> * decrypted data.</span>
00313 <span class="comment"> * @param output_data_length pointer to the length of the output data.</span>
00314 <span class="comment"> *</span>
00315 <span class="comment"> * @return 0 on success and error code on failure.</span>
00316 <span class="comment"> */</span>
00317 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a12">rsa_decrypt_with_public_key</a> (<a class="code" href="structrsa__st__.html">rsa_st_t</a> * rsast,
00318   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> input_data_length,
00319   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input_data,
00320   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *output_data_length, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output_data);
00321 
00322 <span class="comment"></span>
00323 <span class="comment">/**</span>
00324 <span class="comment"> * This API is used for message authentication, which is based on hash </span>
00325 <span class="comment"> * algorithm type.</span>
00326 <span class="comment"> * </span>
00327 <span class="comment"> * Input arguments : </span>
00328 <span class="comment"> * @param type type of the hashing value (HMACMC5 or HMACSHA1)</span>
00329 <span class="comment"> * @param key_length the length of the key string.</span>
00330 <span class="comment"> * @param key pointer to the hmac key string.</span>
00331 <span class="comment"> * @param inbuff pointer to the list of input buffers where each buffer is a </span>
00332 <span class="comment"> * struct of (size, data and next), where size is the size of data, </span>
00333 <span class="comment"> * 'data' is the pointer to the buffer and 'next' is the pointer to the </span>
00334 <span class="comment"> * next buffer.</span>
00335 <span class="comment"> * </span>
00336 <span class="comment"> * Output arguments :</span>
00337 <span class="comment"> * hash_result pointer to the bufffer containing the hash result. The size </span>
00338 <span class="comment"> * of the buffer must match the hash algorithm type.</span>
00339 <span class="comment"> *</span>
00340 <span class="comment"> * @return 0 on success and error code on failure.</span>
00341 <span class="comment"> */</span>
00342 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a15">hmac</a> (<span class="keywordtype">int</span> type, <span class="keywordtype">int</span> key_length, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key,
00343   <a class="code" href="structbuffers.html">buffers_t</a> * inbuff, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *hash_result);
00344 
00345 <span class="comment"></span>
00346 <span class="comment">/**</span>
00347 <span class="comment"> * This API encrypts the input data in 'inbuff' (struct containing size, </span>
00348 <span class="comment"> * data and next pointer) and stores the resultant encrypted data in </span>
00349 <span class="comment"> * 'outbuff' (struct containing size, data and next pointer). </span>
00350 <span class="comment"> *</span>
00351 <span class="comment"> * Input arguments :</span>
00352 <span class="comment"> * @param type DES algorithm type (SINGLEDES or TRIPLEDES)</span>
00353 <span class="comment"> * @param key pointer to the key string. Size of the key should match DES </span>
00354 <span class="comment"> * algorithm type.</span>
00355 <span class="comment"> * @param iv pointer to the IV string whose size must match the algorithm </span>
00356 <span class="comment"> * type. 'iv' will change after computation.</span>
00357 <span class="comment"> *</span>
00358 <span class="comment"> * Output arguments :</span>
00359 <span class="comment"> * @param outbuff pointer to the list of output buffers.</span>
00360 <span class="comment"> *</span>
00361 <span class="comment"> * @return 0 on success and error code on failure.</span>
00362 <span class="comment"> *</span>
00363 <span class="comment"> */</span>
00364 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a24">des_encrypt</a> (<span class="keywordtype">int</span> type, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *iv,
00365   <a class="code" href="structbuffers.html">buffers_t</a> * inbuff, <a class="code" href="structbuffers.html">buffers_t</a> * outbuff);
00366 
00367 <span class="comment"></span>
00368 <span class="comment">/**</span>
00369 <span class="comment"> * This API decrypts the encrypted data in 'inbuff' (struct containing size, </span>
00370 <span class="comment"> * data and next pointer) and stores the resultant decrypted data in </span>
00371 <span class="comment"> * 'outbuff' (struct containing size, data and next pointer). </span>
00372 <span class="comment"> *</span>
00373 <span class="comment"> * Input arguments :</span>
00374 <span class="comment"> * @param type DES algorithm type (SINGLEDES or TRIPLEDES)</span>
00375 <span class="comment"> * @param key pointer to the key string. Size of the key should match DES </span>
00376 <span class="comment"> * algorithm type.</span>
00377 <span class="comment"> * @param iv pointer to the IV string whose size must match the algorithm </span>
00378 <span class="comment"> * type. 'iv' will change after computation.</span>
00379 <span class="comment"> *</span>
00380 <span class="comment"> * Output arguments :</span>
00381 <span class="comment"> * @param outbuff pointer to the list of output buffers.</span>
00382 <span class="comment"> *</span>
00383 <span class="comment"> * @return 0 on success and error code on failure.</span>
00384 <span class="comment"> */</span>
00385 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a25">des_decrypt</a> (<span class="keywordtype">int</span> type, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *iv,
00386   <a class="code" href="structbuffers.html">buffers_t</a> * inbuff, <a class="code" href="structbuffers.html">buffers_t</a> * outbuff);
00387 
00388 <span class="comment"></span>
00389 <span class="comment">/**</span>
00390 <span class="comment"> * This API encrypts the input data in 'inbuff' (struct containing size, </span>
00391 <span class="comment"> * data and next pointer) and stores the resultant encrypted data in </span>
00392 <span class="comment"> * 'outbuff' (struct containing size, data and next pointer). </span>
00393 <span class="comment"> *</span>
00394 <span class="comment"> * Input arguments : </span>
00395 <span class="comment"> * @param type AES algorithm type (AES128_CBC, AES192_CBC, AES256_CBC)</span>
00396 <span class="comment"> * @param key pointer to the key string. Size of the key should match the DES</span>
00397 <span class="comment"> * algorithm type.</span>
00398 <span class="comment"> * @param iv pointer to the IV string whose size must match the algorithm i</span>
00399 <span class="comment"> * type. iv will change after computation.</span>
00400 <span class="comment"> * @param inbuff pointer to the list of input buffers which are the struct </span>
00401 <span class="comment"> * of (size, data and next), where size is the size of the data contained in</span>
00402 <span class="comment"> * the buffer; 'data' is the pointer to the buffer; and 'next' is the </span>
00403 <span class="comment"> * pointer to the next buffer.</span>
00404 <span class="comment"> *</span>
00405 <span class="comment"> * Output arguments : </span>
00406 <span class="comment"> * @param outbuff pointer to the list of output buffers (struct containing </span>
00407 <span class="comment"> * size, data and next pointer).</span>
00408 <span class="comment"> * </span>
00409 <span class="comment"> * @return 0 on success and error code on failure.</span>
00410 <span class="comment"> */</span>
00411 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a26">aes_encrypt</a> (<span class="keywordtype">int</span> type, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *iv,
00412   <a class="code" href="structbuffers.html">buffers_t</a> * inbuff, <a class="code" href="structbuffers.html">buffers_t</a> * outbuff);
00413 
00414 <span class="comment"></span>
00415 <span class="comment">/**</span>
00416 <span class="comment"> * This API decrypts the input data in 'inbuff' (struct containing size, </span>
00417 <span class="comment"> * data and next pointer) and stores the resultant decrypted data in </span>
00418 <span class="comment"> * 'outbuff' (struct containing size, data and next pointer). </span>
00419 <span class="comment"> *</span>
00420 <span class="comment"> * Input arguments : </span>
00421 <span class="comment"> * @param type AES algorithm type (AES128_CBC, AES192_CBC, AES256_CBC)</span>
00422 <span class="comment"> * @param key pointer to the key string. Size of the key should match the</span>
00423 <span class="comment"> * AES algorithm type.</span>
00424 <span class="comment"> * @param iv pointer to the IV string whose size must match the algorithm </span>
00425 <span class="comment"> * type. iv will change after computation.</span>
00426 <span class="comment"> * @param inbuff pointer to the list of input buffers which are the struct </span>
00427 <span class="comment"> * of (size, data and next), where size is the size of the data contained in</span>
00428 <span class="comment"> * the buffer; 'data' is the pointer to the buffer; and 'next' is the </span>
00429 <span class="comment"> * pointer to the next buffer.</span>
00430 <span class="comment"> *</span>
00431 <span class="comment"> * Output arguments : </span>
00432 <span class="comment"> * @param outbuff pointer to the list of output buffers (struct containing </span>
00433 <span class="comment"> * size, data and next pointer).</span>
00434 <span class="comment"> * </span>
00435 <span class="comment"> * @return 0 on success and error code on failure.</span>
00436 <span class="comment"> */</span>
00437 <span class="keywordtype">int</span> <a class="code" href="crypto-generic-api_8c.html#a27">aes_decrypt</a> (<span class="keywordtype">int</span> type, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *iv,
00438   <a class="code" href="structbuffers.html">buffers_t</a> * inbuff, <a class="code" href="structbuffers.html">buffers_t</a> * outbuff);
00439 
00440 <span class="comment"></span>
00441 <span class="comment">/**</span>
00442 <span class="comment"> * Note : It is responsibility of the application to allocate sufficient </span>
00443 <span class="comment"> * memory to input and output buffers for all the APIs. In case of </span>
00444 <span class="comment"> * input/output buffer being linked lists, it is the responsibity of the </span>
00445 <span class="comment"> * application to terminate it properly.</span>
00446 <span class="comment"> */</span>
00447 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Mon Aug 14 19:59:36 2006 for Octeon Core Crypto API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
