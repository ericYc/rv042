<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>asn1_mac.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>asn1_mac.h</h1><a href="asn1__mac_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* crypto/asn1/asn1_mac.h */</span>
00002 <span class="comment">/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)</span>
00003 <span class="comment"> * All rights reserved.</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> * This package is an SSL implementation written</span>
00006 <span class="comment"> * by Eric Young (eay@cryptsoft.com).</span>
00007 <span class="comment"> * The implementation was written so as to conform with Netscapes SSL.</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> * This library is free for commercial and non-commercial use as long as</span>
00010 <span class="comment"> * the following conditions are aheared to.  The following conditions</span>
00011 <span class="comment"> * apply to all code found in this distribution, be it the RC4, RSA,</span>
00012 <span class="comment"> * lhash, DES, etc., code; not just the SSL code.  The SSL documentation</span>
00013 <span class="comment"> * included with this distribution is covered by the same copyright terms</span>
00014 <span class="comment"> * except that the holder is Tim Hudson (tjh@cryptsoft.com).</span>
00015 <span class="comment"> * </span>
00016 <span class="comment"> * Copyright remains Eric Young's, and as such any Copyright notices in</span>
00017 <span class="comment"> * the code are not to be removed.</span>
00018 <span class="comment"> * If this package is used in a product, Eric Young should be given attribution</span>
00019 <span class="comment"> * as the author of the parts of the library used.</span>
00020 <span class="comment"> * This can be in the form of a textual message at program startup or</span>
00021 <span class="comment"> * in documentation (online or textual) provided with the package.</span>
00022 <span class="comment"> * </span>
00023 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
00024 <span class="comment"> * modification, are permitted provided that the following conditions</span>
00025 <span class="comment"> * are met:</span>
00026 <span class="comment"> * 1. Redistributions of source code must retain the copyright</span>
00027 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
00028 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
00029 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
00030 <span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
00031 <span class="comment"> * 3. All advertising materials mentioning features or use of this software</span>
00032 <span class="comment"> *    must display the following acknowledgement:</span>
00033 <span class="comment"> *    "This product includes cryptographic software written by</span>
00034 <span class="comment"> *     Eric Young (eay@cryptsoft.com)"</span>
00035 <span class="comment"> *    The word 'cryptographic' can be left out if the rouines from the library</span>
00036 <span class="comment"> *    being used are not cryptographic related :-).</span>
00037 <span class="comment"> * 4. If you include any Windows specific code (or a derivative thereof) from </span>
00038 <span class="comment"> *    the apps directory (application code) you must include an acknowledgement:</span>
00039 <span class="comment"> *    "This product includes software written by Tim Hudson (tjh@cryptsoft.com)"</span>
00040 <span class="comment"> * </span>
00041 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND</span>
00042 <span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00043 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
00044 <span class="comment"> * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE</span>
00045 <span class="comment"> * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
00046 <span class="comment"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span>
00047 <span class="comment"> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
00048 <span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span>
00049 <span class="comment"> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
00050 <span class="comment"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
00051 <span class="comment"> * SUCH DAMAGE.</span>
00052 <span class="comment"> * </span>
00053 <span class="comment"> * The licence and distribution terms for any publically available version or</span>
00054 <span class="comment"> * derivative of this code cannot be changed.  i.e. this code cannot simply be</span>
00055 <span class="comment"> * copied and put under another distribution licence</span>
00056 <span class="comment"> * [including the GNU Public Licence.]</span>
00057 <span class="comment"> */</span>
00058 
00059 <span class="preprocessor">#ifndef HEADER_ASN1_MAC_H</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#define HEADER_ASN1_MAC_H</span>
00061 <span class="preprocessor"></span>
00062 <span class="preprocessor">#include &lt;<a class="code" href="asn1_8h.html">openssl/asn1.h</a>&gt;</span>
00063 
00064 <span class="preprocessor">#ifdef  __cplusplus</span>
00065 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00066 <span class="preprocessor">#endif</span>
00067 <span class="preprocessor"></span>
00068 <span class="preprocessor">#ifndef ASN1_MAC_ERR_LIB</span>
<a name="l00069"></a><a class="code" href="asn1__mac_8h.html#a0">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_MAC_ERR_LIB    ERR_LIB_ASN1</span>
00070 <span class="preprocessor"></span><span class="preprocessor">#endif </span>
00071 <span class="preprocessor"></span>
<a name="l00072"></a><a class="code" href="asn1__mac_8h.html#a1">00072</a> <span class="preprocessor">#define ASN1_MAC_H_err(f,r,line) \</span>
00073 <span class="preprocessor">    ERR_PUT_error(ASN1_MAC_ERR_LIB,(f),(r),__FILE__,(line))</span>
00074 <span class="preprocessor"></span>
<a name="l00075"></a><a class="code" href="asn1__mac_8h.html#a2">00075</a> <span class="preprocessor">#define M_ASN1_D2I_vars(a,type,func) \</span>
00076 <span class="preprocessor">    ASN1_CTX c; \</span>
00077 <span class="preprocessor">    type ret=NULL; \</span>
00078 <span class="preprocessor">    \</span>
00079 <span class="preprocessor">    c.pp=(unsigned char **)pp; \</span>
00080 <span class="preprocessor">    c.q= *(unsigned char **)pp; \</span>
00081 <span class="preprocessor">    c.error=ERR_R_NESTED_ASN1_ERROR; \</span>
00082 <span class="preprocessor">    if ((a == NULL) || ((*a) == NULL)) \</span>
00083 <span class="preprocessor">        { if ((ret=(type)func()) == NULL) \</span>
00084 <span class="preprocessor">            { c.line=__LINE__; goto err; } } \</span>
00085 <span class="preprocessor">    else    ret=(*a);</span>
00086 <span class="preprocessor"></span>
<a name="l00087"></a><a class="code" href="asn1__mac_8h.html#a3">00087</a> <span class="preprocessor">#define M_ASN1_D2I_Init() \</span>
00088 <span class="preprocessor">    c.p= *(unsigned char **)pp; \</span>
00089 <span class="preprocessor">    c.max=(length == 0)?0:(c.p+length);</span>
00090 <span class="preprocessor"></span>
<a name="l00091"></a><a class="code" href="asn1__mac_8h.html#a4">00091</a> <span class="preprocessor">#define M_ASN1_D2I_Finish_2(a) \</span>
00092 <span class="preprocessor">    if (!asn1_Finish(&amp;c)) \</span>
00093 <span class="preprocessor">        { c.line=__LINE__; goto err; } \</span>
00094 <span class="preprocessor">    *(unsigned char **)pp=c.p; \</span>
00095 <span class="preprocessor">    if (a != NULL) (*a)=ret; \</span>
00096 <span class="preprocessor">    return(ret);</span>
00097 <span class="preprocessor"></span>
<a name="l00098"></a><a class="code" href="asn1__mac_8h.html#a5">00098</a> <span class="preprocessor">#define M_ASN1_D2I_Finish(a,func,e) \</span>
00099 <span class="preprocessor">    M_ASN1_D2I_Finish_2(a); \</span>
00100 <span class="preprocessor">err:\</span>
00101 <span class="preprocessor">    ASN1_MAC_H_err((e),c.error,c.line); \</span>
00102 <span class="preprocessor">    asn1_add_error(*(unsigned char **)pp,(int)(c.q- *pp)); \</span>
00103 <span class="preprocessor">    if ((ret != NULL) &amp;&amp; ((a == NULL) || (*a != ret))) func(ret); \</span>
00104 <span class="preprocessor">    return(NULL)</span>
00105 <span class="preprocessor"></span>
<a name="l00106"></a><a class="code" href="asn1__mac_8h.html#a6">00106</a> <span class="preprocessor">#define M_ASN1_D2I_start_sequence() \</span>
00107 <span class="preprocessor">    if (!asn1_GetSequence(&amp;c,&amp;length)) \</span>
00108 <span class="preprocessor">        { c.line=__LINE__; goto err; }</span>
00109 <span class="preprocessor"></span><span class="comment">/* Begin reading ASN1 without a surrounding sequence */</span>
<a name="l00110"></a><a class="code" href="asn1__mac_8h.html#a7">00110</a> <span class="preprocessor">#define M_ASN1_D2I_begin() \</span>
00111 <span class="preprocessor">    c.slen = length;</span>
00112 <span class="preprocessor"></span>
00113 <span class="comment">/* End reading ASN1 with no check on length */</span>
<a name="l00114"></a><a class="code" href="asn1__mac_8h.html#a8">00114</a> <span class="preprocessor">#define M_ASN1_D2I_Finish_nolen(a, func, e) \</span>
00115 <span class="preprocessor">    *pp=c.p; \</span>
00116 <span class="preprocessor">    if (a != NULL) (*a)=ret; \</span>
00117 <span class="preprocessor">    return(ret); \</span>
00118 <span class="preprocessor">err:\</span>
00119 <span class="preprocessor">    ASN1_MAC_H_err((e),c.error,c.line); \</span>
00120 <span class="preprocessor">    asn1_add_error(*pp,(int)(c.q- *pp)); \</span>
00121 <span class="preprocessor">    if ((ret != NULL) &amp;&amp; ((a == NULL) || (*a != ret))) func(ret); \</span>
00122 <span class="preprocessor">    return(NULL)</span>
00123 <span class="preprocessor"></span>
<a name="l00124"></a><a class="code" href="asn1__mac_8h.html#a9">00124</a> <span class="preprocessor">#define M_ASN1_D2I_end_sequence() \</span>
00125 <span class="preprocessor">    (((c.inf&amp;1) == 0)?(c.slen &lt;= 0): \</span>
00126 <span class="preprocessor">        (c.eos=ASN1_check_infinite_end(&amp;c.p,c.slen)))</span>
00127 <span class="preprocessor"></span>
00128 <span class="comment">/* Don't use this with d2i_ASN1_BOOLEAN() */</span>
<a name="l00129"></a><a class="code" href="asn1__mac_8h.html#a10">00129</a> <span class="preprocessor">#define M_ASN1_D2I_get(b,func) \</span>
00130 <span class="preprocessor">    c.q=c.p; \</span>
00131 <span class="preprocessor">    if (func(&amp;(b),&amp;c.p,c.slen) == NULL) \</span>
00132 <span class="preprocessor">        {c.line=__LINE__; goto err; } \</span>
00133 <span class="preprocessor">    c.slen-=(c.p-c.q);</span>
00134 <span class="preprocessor"></span>
00135 <span class="comment">/* use this instead () */</span>
<a name="l00136"></a><a class="code" href="asn1__mac_8h.html#a11">00136</a> <span class="preprocessor">#define M_ASN1_D2I_get_int(b,func) \</span>
00137 <span class="preprocessor">    c.q=c.p; \</span>
00138 <span class="preprocessor">    if (func(&amp;(b),&amp;c.p,c.slen) &lt; 0) \</span>
00139 <span class="preprocessor">        {c.line=__LINE__; goto err; } \</span>
00140 <span class="preprocessor">    c.slen-=(c.p-c.q);</span>
00141 <span class="preprocessor"></span>
<a name="l00142"></a><a class="code" href="asn1__mac_8h.html#a12">00142</a> <span class="preprocessor">#define M_ASN1_D2I_get_opt(b,func,type) \</span>
00143 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; ((M_ASN1_next &amp; (~V_ASN1_CONSTRUCTED)) \</span>
00144 <span class="preprocessor">        == (V_ASN1_UNIVERSAL|(type)))) \</span>
00145 <span class="preprocessor">        { \</span>
00146 <span class="preprocessor">        M_ASN1_D2I_get(b,func); \</span>
00147 <span class="preprocessor">        }</span>
00148 <span class="preprocessor"></span>
<a name="l00149"></a><a class="code" href="asn1__mac_8h.html#a13">00149</a> <span class="preprocessor">#define M_ASN1_D2I_get_imp(b,func, type) \</span>
00150 <span class="preprocessor">    M_ASN1_next=(_tmp&amp; V_ASN1_CONSTRUCTED)|type; \</span>
00151 <span class="preprocessor">    c.q=c.p; \</span>
00152 <span class="preprocessor">    if (func(&amp;(b),&amp;c.p,c.slen) == NULL) \</span>
00153 <span class="preprocessor">        {c.line=__LINE__; M_ASN1_next_prev = _tmp; goto err; } \</span>
00154 <span class="preprocessor">    c.slen-=(c.p-c.q);\</span>
00155 <span class="preprocessor">    M_ASN1_next_prev=_tmp;</span>
00156 <span class="preprocessor"></span>
<a name="l00157"></a><a class="code" href="asn1__mac_8h.html#a14">00157</a> <span class="preprocessor">#define M_ASN1_D2I_get_IMP_opt(b,func,tag,type) \</span>
00158 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; ((M_ASN1_next &amp; (~V_ASN1_CONSTRUCTED)) == \</span>
00159 <span class="preprocessor">        (V_ASN1_CONTEXT_SPECIFIC|(tag)))) \</span>
00160 <span class="preprocessor">        { \</span>
00161 <span class="preprocessor">        unsigned char _tmp = M_ASN1_next; \</span>
00162 <span class="preprocessor">        M_ASN1_D2I_get_imp(b,func, type);\</span>
00163 <span class="preprocessor">        }</span>
00164 <span class="preprocessor"></span>
<a name="l00165"></a><a class="code" href="asn1__mac_8h.html#a15">00165</a> <span class="preprocessor">#define M_ASN1_D2I_get_set(r,func,free_func) \</span>
00166 <span class="preprocessor">        M_ASN1_D2I_get_imp_set(r,func,free_func, \</span>
00167 <span class="preprocessor">            V_ASN1_SET,V_ASN1_UNIVERSAL);</span>
00168 <span class="preprocessor"></span>
<a name="l00169"></a><a class="code" href="asn1__mac_8h.html#a16">00169</a> <span class="preprocessor">#define M_ASN1_D2I_get_set_type(type,r,func,free_func) \</span>
00170 <span class="preprocessor">        M_ASN1_D2I_get_imp_set_type(type,r,func,free_func, \</span>
00171 <span class="preprocessor">            V_ASN1_SET,V_ASN1_UNIVERSAL);</span>
00172 <span class="preprocessor"></span>
<a name="l00173"></a><a class="code" href="asn1__mac_8h.html#a17">00173</a> <span class="preprocessor">#define M_ASN1_D2I_get_set_opt(r,func,free_func) \</span>
00174 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; (M_ASN1_next == (V_ASN1_UNIVERSAL| \</span>
00175 <span class="preprocessor">        V_ASN1_CONSTRUCTED|V_ASN1_SET)))\</span>
00176 <span class="preprocessor">        { M_ASN1_D2I_get_set(r,func,free_func); }</span>
00177 <span class="preprocessor"></span>
<a name="l00178"></a><a class="code" href="asn1__mac_8h.html#a18">00178</a> <span class="preprocessor">#define M_ASN1_D2I_get_set_opt_type(type,r,func,free_func) \</span>
00179 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; (M_ASN1_next == (V_ASN1_UNIVERSAL| \</span>
00180 <span class="preprocessor">        V_ASN1_CONSTRUCTED|V_ASN1_SET)))\</span>
00181 <span class="preprocessor">        { M_ASN1_D2I_get_set_type(type,r,func,free_func); }</span>
00182 <span class="preprocessor"></span>
<a name="l00183"></a><a class="code" href="asn1__mac_8h.html#a19">00183</a> <span class="preprocessor">#define M_ASN1_I2D_len_SET_opt(a,f) \</span>
00184 <span class="preprocessor">    if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00185 <span class="preprocessor">        M_ASN1_I2D_len_SET(a,f);</span>
00186 <span class="preprocessor"></span>
<a name="l00187"></a><a class="code" href="asn1__mac_8h.html#a20">00187</a> <span class="preprocessor">#define M_ASN1_I2D_put_SET_opt(a,f) \</span>
00188 <span class="preprocessor">    if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00189 <span class="preprocessor">        M_ASN1_I2D_put_SET(a,f);</span>
00190 <span class="preprocessor"></span>
00191 <span class="preprocessor">#define M_ASN1_I2D_put_SEQUENCE_opt(a,f) \</span>
00192 <span class="preprocessor">    if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00193 <span class="preprocessor">        M_ASN1_I2D_put_SEQUENCE(a,f);</span>
00194 <span class="preprocessor"></span>
<a name="l00195"></a><a class="code" href="asn1__mac_8h.html#a22">00195</a> <span class="preprocessor">#define M_ASN1_I2D_put_SEQUENCE_opt_type(type,a,f) \</span>
00196 <span class="preprocessor">    if ((a != NULL) &amp;&amp; (sk_##type##_num(a) != 0)) \</span>
00197 <span class="preprocessor">        M_ASN1_I2D_put_SEQUENCE_type(type,a,f);</span>
00198 <span class="preprocessor"></span>
<a name="l00199"></a><a class="code" href="asn1__mac_8h.html#a23">00199</a> <span class="preprocessor">#define M_ASN1_D2I_get_IMP_set_opt(b,func,free_func,tag) \</span>
00200 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; \</span>
00201 <span class="preprocessor">        (M_ASN1_next == \</span>
00202 <span class="preprocessor">        (V_ASN1_CONTEXT_SPECIFIC|V_ASN1_CONSTRUCTED|(tag))))\</span>
00203 <span class="preprocessor">        { \</span>
00204 <span class="preprocessor">        M_ASN1_D2I_get_imp_set(b,func,free_func,\</span>
00205 <span class="preprocessor">            tag,V_ASN1_CONTEXT_SPECIFIC); \</span>
00206 <span class="preprocessor">        }</span>
00207 <span class="preprocessor"></span>
<a name="l00208"></a><a class="code" href="asn1__mac_8h.html#a24">00208</a> <span class="preprocessor">#define M_ASN1_D2I_get_IMP_set_opt_type(type,b,func,free_func,tag) \</span>
00209 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; \</span>
00210 <span class="preprocessor">        (M_ASN1_next == \</span>
00211 <span class="preprocessor">        (V_ASN1_CONTEXT_SPECIFIC|V_ASN1_CONSTRUCTED|(tag))))\</span>
00212 <span class="preprocessor">        { \</span>
00213 <span class="preprocessor">        M_ASN1_D2I_get_imp_set_type(type,b,func,free_func,\</span>
00214 <span class="preprocessor">            tag,V_ASN1_CONTEXT_SPECIFIC); \</span>
00215 <span class="preprocessor">        }</span>
00216 <span class="preprocessor"></span>
<a name="l00217"></a><a class="code" href="asn1__mac_8h.html#a25">00217</a> <span class="preprocessor">#define M_ASN1_D2I_get_seq(r,func,free_func) \</span>
00218 <span class="preprocessor">        M_ASN1_D2I_get_imp_set(r,func,free_func,\</span>
00219 <span class="preprocessor">            V_ASN1_SEQUENCE,V_ASN1_UNIVERSAL);</span>
00220 <span class="preprocessor"></span>
<a name="l00221"></a><a class="code" href="asn1__mac_8h.html#a26">00221</a> <span class="preprocessor">#define M_ASN1_D2I_get_seq_type(type,r,func,free_func) \</span>
00222 <span class="preprocessor">        M_ASN1_D2I_get_imp_set_type(type,r,func,free_func,\</span>
00223 <span class="preprocessor">                        V_ASN1_SEQUENCE,V_ASN1_UNIVERSAL)</span>
00224 <span class="preprocessor"></span>
<a name="l00225"></a><a class="code" href="asn1__mac_8h.html#a27">00225</a> <span class="preprocessor">#define M_ASN1_D2I_get_seq_opt(r,func,free_func) \</span>
00226 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; (M_ASN1_next == (V_ASN1_UNIVERSAL| \</span>
00227 <span class="preprocessor">        V_ASN1_CONSTRUCTED|V_ASN1_SEQUENCE)))\</span>
00228 <span class="preprocessor">        { M_ASN1_D2I_get_seq(r,func,free_func); }</span>
00229 <span class="preprocessor"></span>
<a name="l00230"></a><a class="code" href="asn1__mac_8h.html#a28">00230</a> <span class="preprocessor">#define M_ASN1_D2I_get_seq_opt_type(type,r,func,free_func) \</span>
00231 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; (M_ASN1_next == (V_ASN1_UNIVERSAL| \</span>
00232 <span class="preprocessor">        V_ASN1_CONSTRUCTED|V_ASN1_SEQUENCE)))\</span>
00233 <span class="preprocessor">        { M_ASN1_D2I_get_seq_type(type,r,func,free_func); }</span>
00234 <span class="preprocessor"></span>
<a name="l00235"></a><a class="code" href="asn1__mac_8h.html#a29">00235</a> <span class="preprocessor">#define M_ASN1_D2I_get_IMP_set(r,func,free_func,x) \</span>
00236 <span class="preprocessor">        M_ASN1_D2I_get_imp_set(r,func,free_func,\</span>
00237 <span class="preprocessor">            x,V_ASN1_CONTEXT_SPECIFIC);</span>
00238 <span class="preprocessor"></span>
<a name="l00239"></a><a class="code" href="asn1__mac_8h.html#a30">00239</a> <span class="preprocessor">#define M_ASN1_D2I_get_IMP_set_type(type,r,func,free_func,x) \</span>
00240 <span class="preprocessor">        M_ASN1_D2I_get_imp_set_type(type,r,func,free_func,\</span>
00241 <span class="preprocessor">            x,V_ASN1_CONTEXT_SPECIFIC);</span>
00242 <span class="preprocessor"></span>
<a name="l00243"></a><a class="code" href="asn1__mac_8h.html#a31">00243</a> <span class="preprocessor">#define M_ASN1_D2I_get_imp_set(r,func,free_func,a,b) \</span>
00244 <span class="preprocessor">    c.q=c.p; \</span>
00245 <span class="preprocessor">    if (d2i_ASN1_SET(&amp;(r),&amp;c.p,c.slen,(char *(*)())func,\</span>
00246 <span class="preprocessor">        (void (*)())free_func,a,b) == NULL) \</span>
00247 <span class="preprocessor">        { c.line=__LINE__; goto err; } \</span>
00248 <span class="preprocessor">    c.slen-=(c.p-c.q);</span>
00249 <span class="preprocessor"></span>
<a name="l00250"></a><a class="code" href="asn1__mac_8h.html#a32">00250</a> <span class="preprocessor">#define M_ASN1_D2I_get_imp_set_type(type,r,func,free_func,a,b) \</span>
00251 <span class="preprocessor">    c.q=c.p; \</span>
00252 <span class="preprocessor">    if (d2i_ASN1_SET_OF_##type(&amp;(r),&amp;c.p,c.slen,func,\</span>
00253 <span class="preprocessor">                   free_func,a,b) == NULL) \</span>
00254 <span class="preprocessor">        { c.line=__LINE__; goto err; } \</span>
00255 <span class="preprocessor">    c.slen-=(c.p-c.q);</span>
00256 <span class="preprocessor"></span>
<a name="l00257"></a><a class="code" href="asn1__mac_8h.html#a33">00257</a> <span class="preprocessor">#define M_ASN1_D2I_get_set_strings(r,func,a,b) \</span>
00258 <span class="preprocessor">    c.q=c.p; \</span>
00259 <span class="preprocessor">    if (d2i_ASN1_STRING_SET(&amp;(r),&amp;c.p,c.slen,a,b) == NULL) \</span>
00260 <span class="preprocessor">        { c.line=__LINE__; goto err; } \</span>
00261 <span class="preprocessor">    c.slen-=(c.p-c.q);</span>
00262 <span class="preprocessor"></span>
<a name="l00263"></a><a class="code" href="asn1__mac_8h.html#a34">00263</a> <span class="preprocessor">#define M_ASN1_D2I_get_EXP_opt(r,func,tag) \</span>
00264 <span class="preprocessor">    if ((c.slen != 0L) &amp;&amp; (M_ASN1_next == \</span>
00265 <span class="preprocessor">        (V_ASN1_CONSTRUCTED|V_ASN1_CONTEXT_SPECIFIC|tag))) \</span>
00266 <span class="preprocessor">        { \</span>
00267 <span class="preprocessor">        int Tinf,Ttag,Tclass; \</span>
00268 <span class="preprocessor">        long Tlen; \</span>
00269 <span class="preprocessor">        \</span>
00270 <span class="preprocessor">        c.q=c.p; \</span>
00271 <span class="preprocessor">        Tinf=ASN1_get_object(&amp;c.p,&amp;Tlen,&amp;Ttag,&amp;Tclass,c.slen); \</span>
00272 <span class="preprocessor">        if (Tinf &amp; 0x80) \</span>
00273 <span class="preprocessor">            { c.error=ERR_R_BAD_ASN1_OBJECT_HEADER; \</span>
00274 <span class="preprocessor">            c.line=__LINE__; goto err; } \</span>
00275 <span class="preprocessor">        if (Tinf == (V_ASN1_CONSTRUCTED+1)) \</span>
00276 <span class="preprocessor">                    Tlen = c.slen - (c.p - c.q) - 2; \</span>
00277 <span class="preprocessor">        if (func(&amp;(r),&amp;c.p,Tlen) == NULL) \</span>
00278 <span class="preprocessor">            { c.line=__LINE__; goto err; } \</span>
00279 <span class="preprocessor">        if (Tinf == (V_ASN1_CONSTRUCTED+1)) { \</span>
00280 <span class="preprocessor">            Tlen = c.slen - (c.p - c.q); \</span>
00281 <span class="preprocessor">            if(!ASN1_check_infinite_end(&amp;c.p, Tlen)) \</span>
00282 <span class="preprocessor">                { c.error=ERR_R_MISSING_ASN1_EOS; \</span>
00283 <span class="preprocessor">                c.line=__LINE__; goto err; } \</span>
00284 <span class="preprocessor">        }\</span>
00285 <span class="preprocessor">        c.slen-=(c.p-c.q); \</span>
00286 <span class="preprocessor">        }</span>
00287 <span class="preprocessor"></span>
<a name="l00288"></a><a class="code" href="asn1__mac_8h.html#a35">00288</a> <span class="preprocessor">#define M_ASN1_D2I_get_EXP_set_opt(r,func,free_func,tag,b) \</span>
00289 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; (M_ASN1_next == \</span>
00290 <span class="preprocessor">        (V_ASN1_CONSTRUCTED|V_ASN1_CONTEXT_SPECIFIC|tag))) \</span>
00291 <span class="preprocessor">        { \</span>
00292 <span class="preprocessor">        int Tinf,Ttag,Tclass; \</span>
00293 <span class="preprocessor">        long Tlen; \</span>
00294 <span class="preprocessor">        \</span>
00295 <span class="preprocessor">        c.q=c.p; \</span>
00296 <span class="preprocessor">        Tinf=ASN1_get_object(&amp;c.p,&amp;Tlen,&amp;Ttag,&amp;Tclass,c.slen); \</span>
00297 <span class="preprocessor">        if (Tinf &amp; 0x80) \</span>
00298 <span class="preprocessor">            { c.error=ERR_R_BAD_ASN1_OBJECT_HEADER; \</span>
00299 <span class="preprocessor">            c.line=__LINE__; goto err; } \</span>
00300 <span class="preprocessor">        if (Tinf == (V_ASN1_CONSTRUCTED+1)) \</span>
00301 <span class="preprocessor">                    Tlen = c.slen - (c.p - c.q) - 2; \</span>
00302 <span class="preprocessor">        if (d2i_ASN1_SET(&amp;(r),&amp;c.p,Tlen,(char *(*)())func, \</span>
00303 <span class="preprocessor">            (void (*)())free_func, \</span>
00304 <span class="preprocessor">            b,V_ASN1_UNIVERSAL) == NULL) \</span>
00305 <span class="preprocessor">            { c.line=__LINE__; goto err; } \</span>
00306 <span class="preprocessor">        if (Tinf == (V_ASN1_CONSTRUCTED+1)) { \</span>
00307 <span class="preprocessor">            Tlen = c.slen - (c.p - c.q); \</span>
00308 <span class="preprocessor">            if(!ASN1_check_infinite_end(&amp;c.p, Tlen)) \</span>
00309 <span class="preprocessor">                { c.error=ERR_R_MISSING_ASN1_EOS; \</span>
00310 <span class="preprocessor">                c.line=__LINE__; goto err; } \</span>
00311 <span class="preprocessor">        }\</span>
00312 <span class="preprocessor">        c.slen-=(c.p-c.q); \</span>
00313 <span class="preprocessor">        }</span>
00314 <span class="preprocessor"></span>
<a name="l00315"></a><a class="code" href="asn1__mac_8h.html#a36">00315</a> <span class="preprocessor">#define M_ASN1_D2I_get_EXP_set_opt_type(type,r,func,free_func,tag,b) \</span>
00316 <span class="preprocessor">    if ((c.slen != 0) &amp;&amp; (M_ASN1_next == \</span>
00317 <span class="preprocessor">        (V_ASN1_CONSTRUCTED|V_ASN1_CONTEXT_SPECIFIC|tag))) \</span>
00318 <span class="preprocessor">        { \</span>
00319 <span class="preprocessor">        int Tinf,Ttag,Tclass; \</span>
00320 <span class="preprocessor">        long Tlen; \</span>
00321 <span class="preprocessor">        \</span>
00322 <span class="preprocessor">        c.q=c.p; \</span>
00323 <span class="preprocessor">        Tinf=ASN1_get_object(&amp;c.p,&amp;Tlen,&amp;Ttag,&amp;Tclass,c.slen); \</span>
00324 <span class="preprocessor">        if (Tinf &amp; 0x80) \</span>
00325 <span class="preprocessor">            { c.error=ERR_R_BAD_ASN1_OBJECT_HEADER; \</span>
00326 <span class="preprocessor">            c.line=__LINE__; goto err; } \</span>
00327 <span class="preprocessor">        if (Tinf == (V_ASN1_CONSTRUCTED+1)) \</span>
00328 <span class="preprocessor">                    Tlen = c.slen - (c.p - c.q) - 2; \</span>
00329 <span class="preprocessor">        if (d2i_ASN1_SET_OF_##type(&amp;(r),&amp;c.p,Tlen,func, \</span>
00330 <span class="preprocessor">            free_func,b,V_ASN1_UNIVERSAL) == NULL) \</span>
00331 <span class="preprocessor">            { c.line=__LINE__; goto err; } \</span>
00332 <span class="preprocessor">        if (Tinf == (V_ASN1_CONSTRUCTED+1)) { \</span>
00333 <span class="preprocessor">            Tlen = c.slen - (c.p - c.q); \</span>
00334 <span class="preprocessor">            if(!ASN1_check_infinite_end(&amp;c.p, Tlen)) \</span>
00335 <span class="preprocessor">                { c.error=ERR_R_MISSING_ASN1_EOS; \</span>
00336 <span class="preprocessor">                c.line=__LINE__; goto err; } \</span>
00337 <span class="preprocessor">        }\</span>
00338 <span class="preprocessor">        c.slen-=(c.p-c.q); \</span>
00339 <span class="preprocessor">        }</span>
00340 <span class="preprocessor"></span>
00341 <span class="comment">/* New macros */</span>
<a name="l00342"></a><a class="code" href="asn1__mac_8h.html#a37">00342</a> <span class="preprocessor">#define M_ASN1_New_Malloc(ret,type) \</span>
00343 <span class="preprocessor">    if ((ret=(type *)OPENSSL_malloc(sizeof(type))) == NULL) \</span>
00344 <span class="preprocessor">        { c.line=__LINE__; goto err2; }</span>
00345 <span class="preprocessor"></span>
<a name="l00346"></a><a class="code" href="asn1__mac_8h.html#a38">00346</a> <span class="preprocessor">#define M_ASN1_New(arg,func) \</span>
00347 <span class="preprocessor">    if (((arg)=func()) == NULL) return(NULL)</span>
00348 <span class="preprocessor"></span>
<a name="l00349"></a><a class="code" href="asn1__mac_8h.html#a39">00349</a> <span class="preprocessor">#define M_ASN1_New_Error(a) \</span>
00350 <span class="preprocessor"></span><span class="comment">/*  err:    ASN1_MAC_H_err((a),ERR_R_NESTED_ASN1_ERROR,c.line); \</span>
00351 <span class="comment">        return(NULL);*/</span> \
00352     err2:   ASN1_MAC_H_err((a),ERR_R_MALLOC_FAILURE,c.line); \
00353         return(NULL)
00354 
00355 
<a name="l00356"></a><a class="code" href="asn1__mac_8h.html#a40">00356</a> <span class="preprocessor">#define M_ASN1_next     (*c.p)</span>
<a name="l00357"></a><a class="code" href="asn1__mac_8h.html#a41">00357</a> <span class="preprocessor"></span><span class="preprocessor">#define M_ASN1_next_prev    (*c.q)</span>
00358 <span class="preprocessor"></span>
00359 <span class="comment">/*************************************************/</span>
00360 
<a name="l00361"></a><a class="code" href="asn1__mac_8h.html#a42">00361</a> <span class="preprocessor">#define M_ASN1_I2D_vars(a)  int r=0,ret=0; \</span>
00362 <span class="preprocessor">                unsigned char *p; \</span>
00363 <span class="preprocessor">                if (a == NULL) return(0)</span>
00364 <span class="preprocessor"></span>
00365 <span class="comment">/* Length Macros */</span>
<a name="l00366"></a><a class="code" href="asn1__mac_8h.html#a43">00366</a> <span class="preprocessor">#define M_ASN1_I2D_len(a,f) ret+=f(a,NULL)</span>
<a name="l00367"></a><a class="code" href="asn1__mac_8h.html#a44">00367</a> <span class="preprocessor"></span><span class="preprocessor">#define M_ASN1_I2D_len_IMP_opt(a,f) if (a != NULL) M_ASN1_I2D_len(a,f)</span>
00368 <span class="preprocessor"></span>
<a name="l00369"></a><a class="code" href="asn1__mac_8h.html#a45">00369</a> <span class="preprocessor">#define M_ASN1_I2D_len_SET(a,f) \</span>
00370 <span class="preprocessor">        ret+=i2d_ASN1_SET(a,NULL,f,V_ASN1_SET,V_ASN1_UNIVERSAL,IS_SET);</span>
00371 <span class="preprocessor"></span>
<a name="l00372"></a><a class="code" href="asn1__mac_8h.html#a46">00372</a> <span class="preprocessor">#define M_ASN1_I2D_len_SET_type(type,a,f) \</span>
00373 <span class="preprocessor">        ret+=i2d_ASN1_SET_OF_##type(a,NULL,f,V_ASN1_SET, \</span>
00374 <span class="preprocessor">                        V_ASN1_UNIVERSAL,IS_SET);</span>
00375 <span class="preprocessor"></span>
<a name="l00376"></a><a class="code" href="asn1__mac_8h.html#a47">00376</a> <span class="preprocessor">#define M_ASN1_I2D_len_SEQUENCE(a,f) \</span>
00377 <span class="preprocessor">        ret+=i2d_ASN1_SET(a,NULL,f,V_ASN1_SEQUENCE,V_ASN1_UNIVERSAL, \</span>
00378 <span class="preprocessor">                  IS_SEQUENCE);</span>
00379 <span class="preprocessor"></span>
<a name="l00380"></a><a class="code" href="asn1__mac_8h.html#a48">00380</a> <span class="preprocessor">#define M_ASN1_I2D_len_SEQUENCE_type(type,a,f) \</span>
00381 <span class="preprocessor">        ret+=i2d_ASN1_SET_OF_##type(a,NULL,f,V_ASN1_SEQUENCE, \</span>
00382 <span class="preprocessor">                        V_ASN1_UNIVERSAL,IS_SEQUENCE)</span>
00383 <span class="preprocessor"></span>
<a name="l00384"></a><a class="code" href="asn1__mac_8h.html#a49">00384</a> <span class="preprocessor">#define M_ASN1_I2D_len_SEQUENCE_opt(a,f) \</span>
00385 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00386 <span class="preprocessor">            M_ASN1_I2D_len_SEQUENCE(a,f);</span>
00387 <span class="preprocessor"></span>
<a name="l00388"></a><a class="code" href="asn1__mac_8h.html#a50">00388</a> <span class="preprocessor">#define M_ASN1_I2D_len_SEQUENCE_opt_type(type,a,f) \</span>
00389 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_##type##_num(a) != 0)) \</span>
00390 <span class="preprocessor">            M_ASN1_I2D_len_SEQUENCE_type(type,a,f);</span>
00391 <span class="preprocessor"></span>
<a name="l00392"></a><a class="code" href="asn1__mac_8h.html#a51">00392</a> <span class="preprocessor">#define M_ASN1_I2D_len_IMP_SET(a,f,x) \</span>
00393 <span class="preprocessor">        ret+=i2d_ASN1_SET(a,NULL,f,x,V_ASN1_CONTEXT_SPECIFIC,IS_SET);</span>
00394 <span class="preprocessor"></span>
<a name="l00395"></a><a class="code" href="asn1__mac_8h.html#a52">00395</a> <span class="preprocessor">#define M_ASN1_I2D_len_IMP_SET_type(type,a,f,x) \</span>
00396 <span class="preprocessor">        ret+=i2d_ASN1_SET_OF_##type(a,NULL,f,x, \</span>
00397 <span class="preprocessor">                        V_ASN1_CONTEXT_SPECIFIC,IS_SET);</span>
00398 <span class="preprocessor"></span>
<a name="l00399"></a><a class="code" href="asn1__mac_8h.html#a53">00399</a> <span class="preprocessor">#define M_ASN1_I2D_len_IMP_SET_opt(a,f,x) \</span>
00400 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00401 <span class="preprocessor">            ret+=i2d_ASN1_SET(a,NULL,f,x,V_ASN1_CONTEXT_SPECIFIC, \</span>
00402 <span class="preprocessor">                      IS_SET);</span>
00403 <span class="preprocessor"></span>
<a name="l00404"></a><a class="code" href="asn1__mac_8h.html#a54">00404</a> <span class="preprocessor">#define M_ASN1_I2D_len_IMP_SET_opt_type(type,a,f,x) \</span>
00405 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_##type##_num(a) != 0)) \</span>
00406 <span class="preprocessor">            ret+=i2d_ASN1_SET_OF_##type(a,NULL,f,x, \</span>
00407 <span class="preprocessor">                           V_ASN1_CONTEXT_SPECIFIC,IS_SET);</span>
00408 <span class="preprocessor"></span>
<a name="l00409"></a><a class="code" href="asn1__mac_8h.html#a55">00409</a> <span class="preprocessor">#define M_ASN1_I2D_len_IMP_SEQUENCE(a,f,x) \</span>
00410 <span class="preprocessor">        ret+=i2d_ASN1_SET(a,NULL,f,x,V_ASN1_CONTEXT_SPECIFIC, \</span>
00411 <span class="preprocessor">                  IS_SEQUENCE);</span>
00412 <span class="preprocessor"></span>
<a name="l00413"></a><a class="code" href="asn1__mac_8h.html#a56">00413</a> <span class="preprocessor">#define M_ASN1_I2D_len_IMP_SEQUENCE_opt(a,f,x) \</span>
00414 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00415 <span class="preprocessor">            ret+=i2d_ASN1_SET(a,NULL,f,x,V_ASN1_CONTEXT_SPECIFIC, \</span>
00416 <span class="preprocessor">                      IS_SEQUENCE);</span>
00417 <span class="preprocessor"></span>
<a name="l00418"></a><a class="code" href="asn1__mac_8h.html#a57">00418</a> <span class="preprocessor">#define M_ASN1_I2D_len_IMP_SEQUENCE_opt_type(type,a,f,x) \</span>
00419 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_##type##_num(a) != 0)) \</span>
00420 <span class="preprocessor">            ret+=i2d_ASN1_SET_OF_##type(a,NULL,f,x, \</span>
00421 <span class="preprocessor">                            V_ASN1_CONTEXT_SPECIFIC, \</span>
00422 <span class="preprocessor">                            IS_SEQUENCE);</span>
00423 <span class="preprocessor"></span>
<a name="l00424"></a><a class="code" href="asn1__mac_8h.html#a58">00424</a> <span class="preprocessor">#define M_ASN1_I2D_len_EXP_opt(a,f,mtag,v) \</span>
00425 <span class="preprocessor">        if (a != NULL)\</span>
00426 <span class="preprocessor">            { \</span>
00427 <span class="preprocessor">            v=f(a,NULL); \</span>
00428 <span class="preprocessor">            ret+=ASN1_object_size(1,v,mtag); \</span>
00429 <span class="preprocessor">            }</span>
00430 <span class="preprocessor"></span>
<a name="l00431"></a><a class="code" href="asn1__mac_8h.html#a59">00431</a> <span class="preprocessor">#define M_ASN1_I2D_len_EXP_SET_opt(a,f,mtag,tag,v) \</span>
00432 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0))\</span>
00433 <span class="preprocessor">            { \</span>
00434 <span class="preprocessor">            v=i2d_ASN1_SET(a,NULL,f,tag,V_ASN1_UNIVERSAL,IS_SET); \</span>
00435 <span class="preprocessor">            ret+=ASN1_object_size(1,v,mtag); \</span>
00436 <span class="preprocessor">            }</span>
00437 <span class="preprocessor"></span>
<a name="l00438"></a><a class="code" href="asn1__mac_8h.html#a60">00438</a> <span class="preprocessor">#define M_ASN1_I2D_len_EXP_SEQUENCE_opt(a,f,mtag,tag,v) \</span>
00439 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0))\</span>
00440 <span class="preprocessor">            { \</span>
00441 <span class="preprocessor">            v=i2d_ASN1_SET(a,NULL,f,tag,V_ASN1_UNIVERSAL, \</span>
00442 <span class="preprocessor">                       IS_SEQUENCE); \</span>
00443 <span class="preprocessor">            ret+=ASN1_object_size(1,v,mtag); \</span>
00444 <span class="preprocessor">            }</span>
00445 <span class="preprocessor"></span>
<a name="l00446"></a><a class="code" href="asn1__mac_8h.html#a61">00446</a> <span class="preprocessor">#define M_ASN1_I2D_len_EXP_SEQUENCE_opt_type(type,a,f,mtag,tag,v) \</span>
00447 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_##type##_num(a) != 0))\</span>
00448 <span class="preprocessor">            { \</span>
00449 <span class="preprocessor">            v=i2d_ASN1_SET_OF_##type(a,NULL,f,tag, \</span>
00450 <span class="preprocessor">                         V_ASN1_UNIVERSAL, \</span>
00451 <span class="preprocessor">                         IS_SEQUENCE); \</span>
00452 <span class="preprocessor">            ret+=ASN1_object_size(1,v,mtag); \</span>
00453 <span class="preprocessor">            }</span>
00454 <span class="preprocessor"></span>
00455 <span class="comment">/* Put Macros */</span>
<a name="l00456"></a><a class="code" href="asn1__mac_8h.html#a62">00456</a> <span class="preprocessor">#define M_ASN1_I2D_put(a,f) f(a,&amp;p)</span>
00457 <span class="preprocessor"></span>
<a name="l00458"></a><a class="code" href="asn1__mac_8h.html#a63">00458</a> <span class="preprocessor">#define M_ASN1_I2D_put_IMP_opt(a,f,t)   \</span>
00459 <span class="preprocessor">        if (a != NULL) \</span>
00460 <span class="preprocessor">            { \</span>
00461 <span class="preprocessor">            unsigned char *q=p; \</span>
00462 <span class="preprocessor">            f(a,&amp;p); \</span>
00463 <span class="preprocessor">            *q=(V_ASN1_CONTEXT_SPECIFIC|t|(*q&amp;V_ASN1_CONSTRUCTED));\</span>
00464 <span class="preprocessor">            }</span>
00465 <span class="preprocessor"></span>
<a name="l00466"></a><a class="code" href="asn1__mac_8h.html#a64">00466</a> <span class="preprocessor">#define M_ASN1_I2D_put_SET(a,f) i2d_ASN1_SET(a,&amp;p,f,V_ASN1_SET,\</span>
00467 <span class="preprocessor">            V_ASN1_UNIVERSAL,IS_SET)</span>
<a name="l00468"></a><a class="code" href="asn1__mac_8h.html#a65">00468</a> <span class="preprocessor"></span><span class="preprocessor">#define M_ASN1_I2D_put_SET_type(type,a,f) \</span>
00469 <span class="preprocessor">     i2d_ASN1_SET_OF_##type(a,&amp;p,f,V_ASN1_SET,V_ASN1_UNIVERSAL,IS_SET)</span>
<a name="l00470"></a><a class="code" href="asn1__mac_8h.html#a66">00470</a> <span class="preprocessor"></span><span class="preprocessor">#define M_ASN1_I2D_put_IMP_SET(a,f,x) i2d_ASN1_SET(a,&amp;p,f,x,\</span>
00471 <span class="preprocessor">            V_ASN1_CONTEXT_SPECIFIC,IS_SET)</span>
<a name="l00472"></a><a class="code" href="asn1__mac_8h.html#a67">00472</a> <span class="preprocessor"></span><span class="preprocessor">#define M_ASN1_I2D_put_IMP_SET_type(type,a,f,x) \</span>
00473 <span class="preprocessor">     i2d_ASN1_SET_OF_##type(a,&amp;p,f,x,V_ASN1_CONTEXT_SPECIFIC,IS_SET)</span>
<a name="l00474"></a><a class="code" href="asn1__mac_8h.html#a68">00474</a> <span class="preprocessor"></span><span class="preprocessor">#define M_ASN1_I2D_put_IMP_SEQUENCE(a,f,x) i2d_ASN1_SET(a,&amp;p,f,x,\</span>
00475 <span class="preprocessor">            V_ASN1_CONTEXT_SPECIFIC,IS_SEQUENCE)</span>
00476 <span class="preprocessor"></span>
<a name="l00477"></a><a class="code" href="asn1__mac_8h.html#a69">00477</a> <span class="preprocessor">#define M_ASN1_I2D_put_SEQUENCE(a,f) i2d_ASN1_SET(a,&amp;p,f,V_ASN1_SEQUENCE,\</span>
00478 <span class="preprocessor">                         V_ASN1_UNIVERSAL,IS_SEQUENCE)</span>
00479 <span class="preprocessor"></span>
<a name="l00480"></a><a class="code" href="asn1__mac_8h.html#a70">00480</a> <span class="preprocessor">#define M_ASN1_I2D_put_SEQUENCE_type(type,a,f) \</span>
00481 <span class="preprocessor">     i2d_ASN1_SET_OF_##type(a,&amp;p,f,V_ASN1_SEQUENCE,V_ASN1_UNIVERSAL, \</span>
00482 <span class="preprocessor">                IS_SEQUENCE)</span>
00483 <span class="preprocessor"></span>
<a name="l00484"></a><a class="code" href="asn1__mac_8h.html#a71">00484</a> <span class="preprocessor">#define M_ASN1_I2D_put_SEQUENCE_opt(a,f) \</span>
00485 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00486 <span class="preprocessor">            M_ASN1_I2D_put_SEQUENCE(a,f);</span>
00487 <span class="preprocessor"></span>
<a name="l00488"></a><a class="code" href="asn1__mac_8h.html#a72">00488</a> <span class="preprocessor">#define M_ASN1_I2D_put_IMP_SET_opt(a,f,x) \</span>
00489 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00490 <span class="preprocessor">            { i2d_ASN1_SET(a,&amp;p,f,x,V_ASN1_CONTEXT_SPECIFIC, \</span>
00491 <span class="preprocessor">                       IS_SET); }</span>
00492 <span class="preprocessor"></span>
<a name="l00493"></a><a class="code" href="asn1__mac_8h.html#a73">00493</a> <span class="preprocessor">#define M_ASN1_I2D_put_IMP_SET_opt_type(type,a,f,x) \</span>
00494 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_##type##_num(a) != 0)) \</span>
00495 <span class="preprocessor">            { i2d_ASN1_SET_OF_##type(a,&amp;p,f,x, \</span>
00496 <span class="preprocessor">                         V_ASN1_CONTEXT_SPECIFIC, \</span>
00497 <span class="preprocessor">                         IS_SET); }</span>
00498 <span class="preprocessor"></span>
<a name="l00499"></a><a class="code" href="asn1__mac_8h.html#a74">00499</a> <span class="preprocessor">#define M_ASN1_I2D_put_IMP_SEQUENCE_opt(a,f,x) \</span>
00500 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00501 <span class="preprocessor">            { i2d_ASN1_SET(a,&amp;p,f,x,V_ASN1_CONTEXT_SPECIFIC, \</span>
00502 <span class="preprocessor">                       IS_SEQUENCE); }</span>
00503 <span class="preprocessor"></span>
<a name="l00504"></a><a class="code" href="asn1__mac_8h.html#a75">00504</a> <span class="preprocessor">#define M_ASN1_I2D_put_IMP_SEQUENCE_opt_type(type,a,f,x) \</span>
00505 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_##type##_num(a) != 0)) \</span>
00506 <span class="preprocessor">            { i2d_ASN1_SET_OF_##type(a,&amp;p,f,x, \</span>
00507 <span class="preprocessor">                         V_ASN1_CONTEXT_SPECIFIC, \</span>
00508 <span class="preprocessor">                         IS_SEQUENCE); }</span>
00509 <span class="preprocessor"></span>
<a name="l00510"></a><a class="code" href="asn1__mac_8h.html#a76">00510</a> <span class="preprocessor">#define M_ASN1_I2D_put_EXP_opt(a,f,tag,v) \</span>
00511 <span class="preprocessor">        if (a != NULL) \</span>
00512 <span class="preprocessor">            { \</span>
00513 <span class="preprocessor">            ASN1_put_object(&amp;p,1,v,tag,V_ASN1_CONTEXT_SPECIFIC); \</span>
00514 <span class="preprocessor">            f(a,&amp;p); \</span>
00515 <span class="preprocessor">            }</span>
00516 <span class="preprocessor"></span>
<a name="l00517"></a><a class="code" href="asn1__mac_8h.html#a77">00517</a> <span class="preprocessor">#define M_ASN1_I2D_put_EXP_SET_opt(a,f,mtag,tag,v) \</span>
00518 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00519 <span class="preprocessor">            { \</span>
00520 <span class="preprocessor">            ASN1_put_object(&amp;p,1,v,mtag,V_ASN1_CONTEXT_SPECIFIC); \</span>
00521 <span class="preprocessor">            i2d_ASN1_SET(a,&amp;p,f,tag,V_ASN1_UNIVERSAL,IS_SET); \</span>
00522 <span class="preprocessor">            }</span>
00523 <span class="preprocessor"></span>
<a name="l00524"></a><a class="code" href="asn1__mac_8h.html#a78">00524</a> <span class="preprocessor">#define M_ASN1_I2D_put_EXP_SEQUENCE_opt(a,f,mtag,tag,v) \</span>
00525 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_num(a) != 0)) \</span>
00526 <span class="preprocessor">            { \</span>
00527 <span class="preprocessor">            ASN1_put_object(&amp;p,1,v,mtag,V_ASN1_CONTEXT_SPECIFIC); \</span>
00528 <span class="preprocessor">            i2d_ASN1_SET(a,&amp;p,f,tag,V_ASN1_UNIVERSAL,IS_SEQUENCE); \</span>
00529 <span class="preprocessor">            }</span>
00530 <span class="preprocessor"></span>
<a name="l00531"></a><a class="code" href="asn1__mac_8h.html#a79">00531</a> <span class="preprocessor">#define M_ASN1_I2D_put_EXP_SEQUENCE_opt_type(type,a,f,mtag,tag,v) \</span>
00532 <span class="preprocessor">        if ((a != NULL) &amp;&amp; (sk_##type##_num(a) != 0)) \</span>
00533 <span class="preprocessor">            { \</span>
00534 <span class="preprocessor">            ASN1_put_object(&amp;p,1,v,mtag,V_ASN1_CONTEXT_SPECIFIC); \</span>
00535 <span class="preprocessor">            i2d_ASN1_SET_OF_##type(a,&amp;p,f,tag,V_ASN1_UNIVERSAL, \</span>
00536 <span class="preprocessor">                           IS_SEQUENCE); \</span>
00537 <span class="preprocessor">            }</span>
00538 <span class="preprocessor"></span>
<a name="l00539"></a><a class="code" href="asn1__mac_8h.html#a80">00539</a> <span class="preprocessor">#define M_ASN1_I2D_seq_total() \</span>
00540 <span class="preprocessor">        r=ASN1_object_size(1,ret,V_ASN1_SEQUENCE); \</span>
00541 <span class="preprocessor">        if (pp == NULL) return(r); \</span>
00542 <span class="preprocessor">        p= *pp; \</span>
00543 <span class="preprocessor">        ASN1_put_object(&amp;p,1,ret,V_ASN1_SEQUENCE,V_ASN1_UNIVERSAL)</span>
00544 <span class="preprocessor"></span>
<a name="l00545"></a><a class="code" href="asn1__mac_8h.html#a81">00545</a> <span class="preprocessor">#define M_ASN1_I2D_INF_seq_start(tag,ctx) \</span>
00546 <span class="preprocessor">        *(p++)=(V_ASN1_CONSTRUCTED|(tag)|(ctx)); \</span>
00547 <span class="preprocessor">        *(p++)=0x80</span>
00548 <span class="preprocessor"></span>
<a name="l00549"></a><a class="code" href="asn1__mac_8h.html#a82">00549</a> <span class="preprocessor">#define M_ASN1_I2D_INF_seq_end() *(p++)=0x00; *(p++)=0x00</span>
00550 <span class="preprocessor"></span>
<a name="l00551"></a><a class="code" href="asn1__mac_8h.html#a83">00551</a> <span class="preprocessor">#define M_ASN1_I2D_finish() *pp=p; \</span>
00552 <span class="preprocessor">                return(r);</span>
00553 <span class="preprocessor"></span>
00554 <span class="keywordtype">int</span> <a class="code" href="asn1__lib_8c.html#a8">asn1_GetSequence</a>(<a class="code" href="structasn1__ctx__st.html">ASN1_CTX</a> *c, <span class="keywordtype">long</span> *length);
00555 <span class="keywordtype">void</span> <a class="code" href="asn1__lib_8c.html#a15">asn1_add_error</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *address,<span class="keywordtype">int</span> offset);
00556 <span class="preprocessor">#ifdef  __cplusplus</span>
00557 <span class="preprocessor"></span>}
00558 <span class="preprocessor">#endif</span>
00559 <span class="preprocessor"></span>
00560 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Mon Aug 14 19:59:35 2006 for Octeon Core Crypto API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
